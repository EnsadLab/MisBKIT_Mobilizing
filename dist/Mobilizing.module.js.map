{"version":3,"file":"Mobilizing.module.js","sources":["../src/js/Mobilizing/helpers/Misc.js","../src/js/Mobilizing/audio/AudioBuffer.js","../src/js/Mobilizing/Base.js","../src/js/Mobilizing/helpers/EventEmitter.js","../src/js/Mobilizing/Component.js","../src/js/Mobilizing/audio/AudioSource.js","../src/js/Mobilizing/core/Color.js","../src/js/Mobilizing/core/Euler.js","../src/js/Mobilizing/core/Matrix3.js","../src/js/Mobilizing/core/Matrix4.js","../src/js/Mobilizing/core/Quaternion.js","../src/js/Mobilizing/core/Rect.js","../src/js/Mobilizing/core/Vector2.js","../src/js/Mobilizing/core/Vector3.js","../src/js/Mobilizing/helpers/Math.js","../src/js/Mobilizing/helpers/Debug.js","../src/js/Mobilizing/time/Time.js","../src/js/Mobilizing/helpers/Animation.js","../src/js/Mobilizing/scene/Material.js","../src/js/Mobilizing/scene/Camera.js","../src/js/Mobilizing/scene/Light.js","../src/js/Mobilizing/texture/Texture.js","../src/js/Mobilizing/shape/Label.js","../src/js/Mobilizing/scene/Transform.js","../src/js/Mobilizing/shape/Mesh.js","../src/js/Mobilizing/helpers/Csg.js","../src/js/Mobilizing/helpers/Device.js","../src/js/Mobilizing/helpers/BatteryStatus.js","../src/js/Mobilizing/input/Keyboard.js","../src/js/Mobilizing/helpers/DOM.js","../src/js/Mobilizing/input/Mouse.js","../src/js/Mobilizing/input/Touch.js","../src/js/Mobilizing/input/Motion.js","../src/js/Mobilizing/input/Orientation.js","../src/js/Mobilizing/input/GPS.js","../src/js/Mobilizing/helpers/MeshFX.js","../src/js/Mobilizing/helpers/Midi.js","../src/js/Mobilizing/helpers/Profiler.js","../src/js/Mobilizing/net/Ajax.js","../src/js/Mobilizing/helpers/OBJ.js","../src/js/Mobilizing/helpers/Loader.js","../src/js/Mobilizing/ComponentProxy.js","../src/js/Mobilizing/Context.js","../src/js/Mobilizing/helpers/Runner.js","../src/js/Mobilizing/helpers/Pointer.js","../src/js/Mobilizing/net/PubSub.js","../src/js/Mobilizing/physics/PhysicsEngine.js","../src/js/Mobilizing/renderer/Engine3D.js","../src/js/Mobilizing/renderer/Renderer3D.js","../src/js/Mobilizing/renderer/RendererAudio.js","../src/js/Mobilizing/scene/Font.js","../src/js/Mobilizing/scene/LODGroup.js","../src/js/Mobilizing/text/TextUtils.js","../src/js/Mobilizing/text/RichText.js","../src/js/Mobilizing/texture/CanvasTexture.js","../src/js/Mobilizing/texture/DOMNodeTexture.js","../src/js/Mobilizing/texture/ImageSequenceTexture.js","../src/js/Mobilizing/texture/RenderTexture.js","../src/js/Mobilizing/texture/VideoTexture.js","../src/js/Mobilizing/time/Timer.js","../src/js/Mobilizing/time/NTP.js","../src/js/Mobilizing/ui/Clickable.js","../src/js/Mobilizing/ui/Button.js","../src/js/Mobilizing/ui/ButtonGroup.js","../src/js/Mobilizing/ui/TextField.js","../src/js/Mobilizing/context/EasyContext.js","../src/js/Mobilizing.js"],"sourcesContent":["\n/**\n * Method to retreive a value from an object if available, or a default value\n * Used in class constructors\n *\n * @method getOrDefault\n * @param {Object} object The object to retreive the value from if available\n * @param {String} key The object's key from which the value should be looked up\n * @param {Mixed} defaultValue The default value to return if the object does not contain the given key, or if the value accociated with the key is undefined\n * @return {Mixed} The retreived a value or the default one\n */\nfunction getOrDefault(object, key, defaultValue) {\n    return ((object !== undefined) && (key in object)) ? object[key] : defaultValue;\n}\n\n/**\n * Method to retreive a value from an object if available, or the return value of a function with optional arguments\n * Used in class constructors\n *\n * @method getOrExec\n * @param {Object} object The object to retreive the value from if available\n * @param {String} key The object's key from which the value should be looked up\n * @param {Function} fn The function to call if no value was found\n * @param {Mixed} [...args] Optional arguments to send with the function\n * @return {Mixed} The retreived a value or the function's return one\n*/\nfunction getOrExec(object, key, fn, ...args) {\n    return ((object !== undefined) && (key in object)) ? object[key] : fn(...args);\n}\n\n/**\n * Method to retreive a value from an object if available, or instantiate a class with optional arguments\n * Used in class constructors\n *\n * @method getOrCreate\n * @param {Object} object The object to retreive the value from if available\n * @param {String} key The object's key from which the value should be looked up\n * @param {Class} cls The class to instantiate if no value was found\n * @param {Mixed} [...args] Optional arguments to send to the class's constructor\n * @return {Mixed} The retreived a value or the new class instance\n*/\nfunction getOrCreate(object, key, cls, ...args) {\n    return ((object !== undefined) && (key in object)) ? object[key] : new cls(...args);\n}\n\n/**\n * Method to force a class to have only one instance\n *\n * @method singletonize\n * @param {class} def The definition of the class\n */\nfunction singletonize(def){\n\n    let instance;\n\n    return function(...args){\n\n        if(instance === undefined){\n            instance = new def(...args);\n        }\n        return instance;\n    }\n}\n\n/**\n * Method to convert a string to Base64. Used internally to convert loaded raw data to img. Wrote by  phil@philten.com - http://www.philten.com\n * @private\n * @method encode64\n * @param {String} inputStr\n * @author phil@philten.com - http://www.philten.com\n * Date: 2010/12/15\n * version: 1.0\n * url french: http://www.philten.com/fr-xmlhttprequest-image\n * url english: http://www.philten.com/us-xmlhttprequest-image\n */\nfunction encode64(inputStr)\n{\n    var b64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n    var outputStr = \"\";\n    var i = 0;\n\n    while (i<inputStr.length)\n    {\n        //all three \"& 0xff\" added below are there to fix a known bug\n        //with bytes returned by xhr.responseText\n        var byte1 = inputStr.charCodeAt(i++) & 0xff;\n        var byte2 = inputStr.charCodeAt(i++) & 0xff;\n        var byte3 = inputStr.charCodeAt(i++) & 0xff;\n\n        var enc1 = byte1 >> 2;\n        var enc2 = ((byte1 & 3) << 4) | (byte2 >> 4);\n\n        var enc3, enc4;\n        if (isNaN(byte2))\n        {\n            enc3 = enc4 = 64;\n        }\n        else\n        {\n            enc3 = ((byte2 & 15) << 2) | (byte3 >> 6);\n            if (isNaN(byte3))\n            {\n                enc4 = 64;\n            }\n            else\n            {\n                enc4 = byte3 & 63;\n            }\n        }\n\n        outputStr +=  b64.charAt(enc1) + b64.charAt(enc2) + b64.charAt(enc3) + b64.charAt(enc4);\n    }\n\n    return outputStr;\n}\n\n/**\n * Converts a DOMString to an ArrayBuffer (raw data binary).\n * \n * @method stringToArrayBuffer\n * @param {DOMString} str a string returned by a XMLHTTPRequest (responseText)\n * @return {ArrayBuffer} the resulting ArrayBuffer\n */\nfunction stringToArrayBuffer(str){\n    //var s = this.encode_utf8(str);\n    //var buf = new ArrayBuffer(s.length);\n    var buffer = new ArrayBuffer(str.length);\n    var bufView = new Uint8Array(buffer);\n    //for (var i=0, strLen=str.length; i<strLen; i++) {\n    for (var i=0, strLen=str.length; i<strLen; i++) {\n        //bufView[i] = s.charCodeAt(i);\n        bufView[i] = str.charCodeAt(i);\n    }\n    return buffer;\n}\n\n/**\n * Extract the MimeType from the URL string of image files. Used internally for texture loading\n * @private\n * @method getMimeType\n * @param {String} url\n * @param {String} mimeType from the url\n */\nfunction getMimeType(url){\n\n    var mimeType = null;\n\n    var extension = (function(url){\n\n        if (url.lastIndexOf(\".\") > 0) {\n            return url.substr(url.lastIndexOf(\".\")).toLowerCase();\n        }\n\n    })(url);\n\n    if( extension === \".jpg\" || extension === \".jpeg\"){\n        mimeType = \"jpeg\";\n    }else if( extension === \".tiff\" || extension === \".tif\"){\n        mimeType = \"tiff\";\n    }else if(extension === \".png\"){\n        mimeType = \"png\";\n    }else if(extension === \".gif\"){\n        mimeType = \"gif\";\n    }\n\n    console.log(\"extension \" + extension, \"mimeType \" + mimeType);\n\n    return mimeType;\n}\n\n// module exports\nexport { getOrDefault, getOrExec, getOrCreate, singletonize };","import {getOrDefault} from \"../helpers/Misc\";\n\nclass AudioBuffer\n{\n    /**\n     AudioBuffer Class. Encapsulates the concept of buffer of Audio data. You can load, depending on the platform, various audio file formats, like WAV, MP3 or OGG. See the Web Audio API documentation. requires the Web Audio API.\n\n     @class AudioBuffer\n     @constructor\n     @param {Object} params the parameters object\n     @param {RendererAudio} params.renderer The audio renderer\n     @param {ArrayBuffer} params.arrayBuffer the raw arraybuffer, already loaded, to give to the audio context\n     @param {Function} params.decodedCallback the callback function to call when Audio Context has decoded the sound file's raw  arrayBuffer\n     @example \n     */\n    constructor(params)\n    {\n        this.renderer = getOrDefault(params, \"renderer\", undefined);\n        this.arrayBuffer = getOrDefault(params, \"arrayBuffer\", undefined);\n        this.decodedCallback = getOrDefault(params, \"decodedCallback\", undefined);\n        \n        if(this.arrayBuffer)\n        {\n            this.renderer.audioContext.decodeAudioData(this.arrayBuffer,\n                                                       function(buffer){\n                this.buffer = buffer;\n                this.decodedCallback();\n\n            }.bind(this));\n        }\n    }\n\n    /**\n    * Return the underlying WebAudio audio buffer\n    * @method getInternalAudioBuffer\n    * @return {Buffer} webAudio buffer\n    */\n    getInternalAudioBuffer()\n    {\n        return this.buffer;\n    }\n}\n\n// module exports\nexport { AudioBuffer };","import {getOrDefault} from './helpers/Misc';\n\nclass Base {\n\n    /**\n     * A base class\n     * Used for all classes that need access to a Mobilizing context\n     *\n     * @class Base\n     * @constructor\n     * @param {Object} params Config parameters\n     * @param {Context} params.context The Mobilizing Context\n    */    \n    constructor(params){\n        /**\n        * A reference to the Mobilizing context\n        *\n        * @property {Context} _context\n        * @private\n        */\n        this._context = getOrDefault(params, \"context\", null);\n        \n        this._name = \"unnamed\"; //object name\n        this._id = Date.now() + \"_\" + Math.floor(Math.random()*1000000); //FIXME : generate unique id\n    }\n\n    /**\n    * Set the Mobilizing context\n    *\n    * @method setContext\n    * @param {Context} context The Mobilizing Context\n    */\n    setContext(context){\n        this._context = context;\n    }\n\n    /**\n    * Get the Mobilizing context\n    *\n    * @method getContext\n    * @return {Context} The Mobilizing context\n    */\n    getContext(){\n        return this._context;\n    }\n    \n    /**\n     * Set the Object name\n     *\n     * @method setName\n     * @param {string} name The Object name\n     */\n    setName(name){\n        this._name = name;\n    }\n    \n    /**\n     * Get the Object name\n     *\n     * @method getContext\n     * @return {string} The Object name\n     */\n    getName(){\n        return this._name;\n    }\n    \n    /**\n     * Get the Object unique ID\n     *\n     * @method getID\n     * @return {int} The Object ID\n     */\n    getID(){\n        return this._id;\n    }\n    \n}\n\n// module exports\nexport { Base };\n","import {getOrDefault} from './Misc';\n\nclass EventEmitter\n{\n    /**\n    * EventEmitter is a helper class to handle event emission\n    *\n    * @class EventEmitter\n    * @constructor\n    * @param {Object} params The parameters object\n    * @param {Mixed} [params.scope] The scope to use for callbacks, should usually be set to the class instance using the EventEmitter. Defaults to the EventEmitter instance if not specified\n    */\n    constructor(params)\n    {\n        this._scope = getOrDefault(params, \"scope\", this);\n        \n        this.listeners = {};\n    }\n\n    /**\n    * Add an event listener\n    *\n    * @method on\n    * @param {String} type The event type to listen to\n    * @param {Function} callback The callback to call when the event is captured\n     * @chainable\n    */\n    on(type, callback)\n    {\n        if (typeof this.listeners[type] === \"undefined\")\n        {\n            this.listeners[type] = [];\n        }\n\n        this.listeners[type].push(callback);\n\n        return this;\n    }\n\n    /**\n     * Remove an event listener\n     *\n     * @method off\n     * @param {String} type The event type to stop listen to\n     * @param {Function} [callback] The callback function associated with the listener. If not specified, all listeners will be removed\n     * @chainable\n     */\n    off(type, callback)\n    {\n        var listeners;\n\n        if(this.listeners[type] instanceof Array)\n        {\n            if(typeof callback === 'undefined')\n            {\n                this.listeners[type] = {};\n            }\n            else\n            {\n                listeners = this.listeners[type];\n                for (var i=0, len=listeners.length; i < len; i++)\n                {\n                    if (listeners[i] === callback){\n                        listeners.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Trigger an event\n     *\n     * @method trigger\n     * @param {String} type The event type\n     * @param {Mixed} [...data] Data to send along with the event\n     * @chainable\n     */\n    trigger(type, ...data)\n    {\n        var listeners;\n\n        if(this.listeners[type] instanceof Array)\n        {\n            listeners = this.listeners[type];\n\n            listeners.forEach((listener) => {\n                listener.call(this._scope, ...data);\n            });\n        }\n\n        return this;\n    }\n}\n\n// module exports\nexport { EventEmitter };\n","import {Base} from './Base';\nimport {EventEmitter} from './helpers/EventEmitter';\n\nclass Component extends Base{\n\n    /**\n     * The generic componment class\n     * Used for all Mobilizing components such as input helpers, renderers, etc\n     *\n     * @class Component\n     * @extends Base\n     * @constructor\n     * @param {Object} params Config parameters\n     * @param {Context} params.context The Mobilizing Context\n    */    \n    constructor(params)\n    {    \n        super(params);\n\n        /**\n        * Whether the component is active or not\n        *\n        * @property {Boolean} _active\n        * @private\n        */\n        this._active = false;\n\n        /**\n        * Whether the component's setup has been called\n        *\n        * @property {Boolean} _setupDone\n        * @private\n        */\n        this._setupDone = false;\n\n        /**\n        * An event emmiter used to send custom events\n        *\n        * @property {EventEmitter} events\n        */\n        this.events = new EventEmitter({\"scope\": this});\n\n        /*\n         * Array of all the children component attached to this component.\n         * Used to conceive component chains for easy management\n         * @private\n         * @property {Array} nexts\n         */\n        this._nexts = [];\n    }\n\n    /**\n    * Calls the setup if it has not already been called\n    * This method should not be called \n    * This is where all the initialization (such as adding event listeners)should be done\n    * It is called automatically by an internal Mobilizing mechanism and should thus not be called directly\n    *\n    * @method runSetup\n    */\n    /*\n    runSetup()\n    {\n        if(!this._setupDone){\n            this._setupDone = true;\n\n            this.setup();\n        }   \n    }\n     */\n\n    /**\n    * Set's up the component\n    * This empty method is usually overriden to perform setup actions for the component\n    * This is where all the initialization (such as adding event listeners)should be done\n    * It is called automatically by an internal Mobilizing mechanism and should thus not be called directly\n    *\n    * @method setup\n    */\n    setup()\n    {\n        if(!this._setupDone)\n        {\n            this._setupDone = true;\n        }\n    }\n\n    /**\n    * preLoad the component\n    * This empty method is usually overriden to perform setup actions for the component.\n    * The preLoad is designed to be called before any other method, even setup.\n    * In the case of user scripts, it is used to preload all needed datas before the setup (pictures, font, etc.)\n    * It is called automatically by an internal Mobilizing mechanism and should thus not be called directly\n    * \n    * @method preLoad\n    */\n    preLoad()\n    {\n    }\n\n    /**\n    * Activate the component\n    * A call to this method calls the setup method if it has not been run yet\n    *\n    * @method on\n    */\n    on()\n    {\n        this._active = true;\n    }\n\n    /**\n    * Deactivate the component\n    *\n    * @method off\n    */\n    off()\n    {\n        this._active = false;\n    }\n\n    /**\n     * @method byPass\n     * TODO!\n     */\n    byPass()\n    {\n        //how to bypass ?\n    }\n    \n    /**\n    * Get the activation status of the component\n    *\n    * @method getStatus\n    * @return {Boolean} True if active, false otherwise\n    */\n    getStatus()\n    {\n        return this._active;\n    }\n\n    /**\n    * Run code before the update of all components is run\n    * This empty method is usually overriden to perform pre-update actions for the component\n    * It is called once per component by an internal Mobilizing mechanism\n    *\n    * @method preUpdate\n    */\n    preUpdate()\n    {\n    }\n\n    /**\n    * Update the component\n    * This empty method is usually overriden to perform update actions for the component\n    * It is called periodically by an internal Mobilizing mechanism\n    *\n    * @method update\n    */\n    update()\n    {\n    }\n\n    /**\n    * Run code after the update of all components is run\n    * This empty method is usually overriden to perform post-update actions for the component\n    * It is called periodically by an internal Mobilizing mechanism\n    *\n    * @method postUpdate\n    */\n    postUpdate()\n    {\n    }\n\n    /**\n    * Adds a component to this chained component array\n    * \n    * @method chain\n    * @param {Component} component the component to chain\n    */\n    chain(component)\n    {\n        this._nexts.push(component);\n    }\n\n    /**\n    * Returns the array of attached children components\n    * \n    * @method getChainedComponents\n    * @return {Array} children arrays\n    */\n    getChainedComponents()\n    {\n        return this._nexts;\n    }\n}\n\n// module exports\nexport { Component };\n","import {Component} from \"../Component\";\nimport {getOrDefault} from \"../helpers/Misc\";\n\nclass AudioSource extends Component\n{\n    /**\n     * \n     * AudioSource Class. Encapsulates the concept of Audio source, a sound-emitting entity with a given position in space. requires the Web Audio API.\n     *  \n     * @class AudioSource\n     * @constructor\n     * @extends Component\n     * @param {Object} params the parameters object\n     * @param {RendererAudio} params.renderer The AudioRenderer \n    */\n    constructor(params)\n    {\n        super(params);\n        \n        this.renderer = getOrDefault(params,\"renderer\", undefined);\n        this.panner;\n\n        if (this.renderer.audioContext !== undefined)\n        {\n            this.panner = this.renderer.audioContext.createPanner();\n            this.panner.panningModel = 'HRTF';\n            this.panner.distanceModel = 'exponential';\n            this.panner.refDistance = 10;\n            this.panner.maxDistance = 10000;\n            this.panner.rolloffFactor = 1;\n            this.panner.coneInnerAngle = 360;\n            this.panner.coneOuterAngle = 0;\n            this.panner.coneOuterGain = 0;\n        }\n        this.is3D = false;\n        this.loop = false;\n    }\n\n    /**\n    * Sets the reference distance for sound attenuation through space\n    * @method setRefDistance\n    * @param {Number} val\n    */\n    setRefDistance(val)\n    {\n        this.panner.refDistance = val;\n    }\n\n    /**\n    * Sets the maximum distance for sound propagation in space\n    * @method setMaxDistance\n    * @param {Number} val\n    */\n    setMaxDistance(val)\n    {\n        this.panner.maxDistance = val;\n    }\n\n    /**\n     set the current AudioSource buffer\n     @method setBuffer\n     @param {Object} buffer the AudioBuffer we want the source to play.\n     */\n    setBuffer(buffer)\n    {\n        this.buffer = buffer;\n    }\n\n    /**\n    * set 3D propagation\n    * @method set3D\n    * @param {Boolean} enabled\n    */\n    set3D(enabled)\n    {\n        this.is3D = enabled;\n    }\n\n    /**\n     set the current Transform that represents the AudioSource position in space.\n     @method setTransform\n     @param {Object} transform the Transform.\n     */\n    setTransform(transform)\n    {\n        this.transform = transform;\n    }\n\n    /**\n    * set this source loop\n    * @method setLoop\n    * @param {Boolean} enabled\n    */\n    setLoop(val)\n    {\n        this.loop = val;\n    }\n\n    /**\n    * Updates the source's position in space if given from a transform\n    * @method update\n    */\n    update()\n    {\n        if (this.transform !== undefined)\n        {\n            var pos = this.transform.getLocalPosition();\n            this.panner.setPosition(pos.x, pos.y, pos.z);\n\n            //sound.panner.setVelocity(dx/dt, dy/dt, dz/dt);\n            //sound.panner.coneInnerAngle = innerAngleInDegrees;\n            //sound.panner.coneOuterAngle = outerAngleInDegrees;\n            //sound.panner.coneOuterGain = outerGainFactor;\n            //listener :\n            //ctx.listener.setPosition(p.x, p.y, p.z);\n            //ctx.listener.setOrientation(vec.x, vec.y, vec.z, up.x, up.y, up.z);\n\n            /*\n             var oscillator = audioCtx.createOscillator();\n             var gainNode = audioCtx.createGain();\n             oscillator.connect(gainNode);\n             gainNode.connect(audioCtx.destination);\n             oscillator.type = 'sine'; // sine wave — other values are 'square', 'sawtooth', 'triangle' and 'custom'\n             oscillator.frequency.value = 440; // value in hertz\n             oscillator.start(0);\n             */\n        }\n    }\n    \n    on()\n    {\n        super.on();\n        this.play();\n    }\n    \n    off()\n    {\n        super.off();\n        this.stop();\n    }\n\n    /**\n     plays the AudioSource\n     @method play\n     */\n    play()\n    {\n        if (this.renderer.audioContext !== undefined)\n        {\n            if (this.source !== undefined)\n            {\n                this.stop();\n            }\n            this.source = this.renderer.audioContext.createBufferSource();\n\n            if (this.is3D)\n            {\n                this.source.connect(this.panner);\n                this.panner.connect(this.renderer.audioContext.destination);\n            }\n            else\n            {\n                this.source.connect(this.renderer.audioContext.destination);\n            }\n            this.source.buffer = this.buffer.buffer;\n        }\n        if (this.source !== undefined)\n        {\n            this.playing = true;\n\n            if(this.loop){\n                this.source.loop = true;\n            }\n\n            this.source.start(0);\n        }\n    }\n\n    /**\n     pauses the AudioSource.\n     @method pause\n     */\n    pause()\n    {\n        if (this.source !== undefined)\n        {\n            this.playing = false;\n        }\n    }\n\n    /**\n     stops the AudioSource.\n     @method stop\n     */\n    stop()\n    {\n        if (this.source !== undefined)\n        {\n            this.source.stop(0);\n            this.source = undefined;\n            this.playing = false;\n        }\n    }\n}\n\n// module exports\nexport { AudioSource };","import * as THREE from 'three';\n\n/**\n * Represents a RGB color to be used in materials applied on Meshes.\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Color\n * @class Color\n */\nclass Color extends THREE.Color\n{\n/**\n     Creates a color based on [0;1] float RGB values\n     @method Create\n     @static\n     @param {Number} r The red component [0;1].\n     @param {Number} g The green component [0;1].\n     @param {Number} b The blue component [0;1].\n     */\n    static Create(r,g,b)\n    {\n        return new Color(r,g,b);\n    }\n\n/**\n     Creates a random color\n     @method random\n     @static\n     @return {Color} the created random color\n     */\n    static random()\n    {\n        return new Color(Math.random(), Math.random(), Math.random());\n    }\n\n\n    /**\n    * Sets the rgb components of this color to the [0;1] based given value\n    * @private\n    * @method setTo\n    * @chainable\n    * @param {Float} val float number\n    * @return {Color} this color with the given value\n    */\n    setTo(val)\n    {\n        this.r = val;\n        this.g = val;\n        this.b = val;\n\n        return this;\n    }\n\n\n    /**\n     Creates a color based on [0;255] RGB values\n     @method setRGB32\n     @param {Number} r The red component [0;255].\n     @param {Number} g The green component [0;255].\n     @param {Number} b The blue component [0;255].\n     */\n    setRGB32(r,g,b)\n    {\n        this.r = r/255;\n        this.g = g/255;\n        this.b = b/255;\n    }\n\n    /**\n     Build a HTML color string with the given alpha.\n     @method makeRGBAStringWithAlpha\n     @param {Number} a The alpha component [0;255].\n     @return {String} a string representation of the color with alpha\n     */\n    makeRGBAStringWithAlpha(a)\n    {\n        var string = \"rgba(\"+ Math.floor(this.r*255) +\",\"+ Math.floor(this.g*255) +\",\"+ Math.floor(this.b*255) +\",\"+ a +\")\";\n\n        return string;\n    }\n\n    /*\n    hex()\n    {\n        return this.color.getHexString();\n\n         var r = this.color.r*255;\n         var g = this.color.g*255;\n         var b = this.color.b*255;\n\n         return \"#\" + r.toString(16) + g.toString(16) + b.toString(16);\n\n\n    }\n    */\n\n    /**\n    * Copies given color.\n    * @method copy\n    * @return Color\n    * @param color {Color}\n    */\n    copy(color)\n    {\n        super.copy();\n    }\n\n/**\n Copies given color making conversion from gamma to linear space.\n@method copyGammaToLinear\n@return Color\n@param color {Color}\n*/\n\n/**\n Copies given color making conversion from linear to gamma space.\n@method copyLinearToGamma\n@return Color\n@param color {Color}\n*/\n\n/**\n@method convertGammaToLinear\n@return Color\n*/\n\n/**\n@method convertLinearToGamma\n@return Color\n*/\n\n/**\n Sets this color from RGB values.\n@method setRGB\n@return Color\n@param r {Float}\n@param g {Float}\n@param b {Float}\n*/\n\n/**\n@method getHex\n@return Integer\n*/\n\n/**\n@method getHexString\n@return String\n*/\n\n/**\n Sets this color from a hexadecimal value.\n@method setHex\n@return Color\n@param hex {Integer}\n*/\n\n/**\n Sets this color from a CSS-style string. For example, \"rgb(250, 0,0)\", \"rgb(100%, 0%, 0%)\", \"hsl(0, 100%, 50%)\", \"#ff0000\", \"#f00\", or \"red\". Transluent colors such as \"rgba(255, 0, 0, 0.5)\" and \"hsla(0, 100%, 50%, 0.5)\" are also accepted, but the alpha-channel coordinate will be discarded.\n@method setStyle\n@return Color\n@param style {String}\n*/\n\n/**\n@method getStyle\n@return String\n*/\n\n/**\n Sets color from hsl\n@method setHSL\n@return Color\n@param h {Float}\n@param s {Float}\n@param l {Float}\n*/\n\n/**\n@method offsetHSL\n@return Color\n@param h {Float}\n@param s {Float}\n@param l {Float}\n*/\n\n/**\n@method add\n@return Color\n@param color {Color}\n*/\n\n/**\n@method addColors\n@return Color\n@param color1 {Color}\n@param color2 {Color}\n*/\n\n/**\n@method addScalar\n@return Color\n@param s {Number}\n*/\n\n/**\n@method multiply\n@return Color\n@param color {Color}\n*/\n\n/**\n@method multiplyScalar\n@return Color\n@param s {Number}\n*/\n\n/**\n Linear interpolation of this colors rgb values and the rgb values of the first argument. The alpha argument can be thought of as the percent between the two colors, where 0 is this color and 1 is the first argument.\n@method lerp\n@return Color\n@param color {Color}\n*/\n\n/**\n Returns an array [r,g,b\n@method toArray\n@return Array\n@param array {Array}\n*/\n\n/**\n@method equals\n@return Color\n@param c {Color}\n*/\n\n/**\n@method clone\n@return Color\n*/\n\n\n}\n\n/**\n* Color.green, a green Color Object\n* @property green {Color}\n* @static\n*/\nColor.green = new Color(0.0, 1.0, 0.0);\n/**\n* Color.blue, a blue Color Object\n* @property blue {Color}\n* @static\n*/\nColor.blue = new Color(0.0, 0.0, 1.0);\n/**\n* Color.red, a red Color Object\n* @property red {Color}\n* @static\n*/\nColor.red = new Color(1.0, 0.0, 0.0);\n/**\n* Color.white, a white Color Object\n* @property white {Color}\n* @static\n*/\nColor.white = new Color(1.0, 1.0, 1.0);\n/**\n* Color.darkGray, a darkGray Color Object\n* @property darkGray {Color}\n* @static\n*/\nColor.darkGray = new Color(0.3, 0.3, 0.3);\n/**\n* Color.gray, a gray Color Object\n* @property gray {Color}\n* @static\n*/\nColor.gray = new Color(0.5, 0.5, 0.5);\n/**\n* Color.lightGray, a lightGray Color Object\n* @property lightGray {Color}\n* @static\n*/\nColor.lightGray = new Color(0.8, 0.8, 0.8);\n/**\n* Color.black, a black Color Object\n* @property black {Color}\n* @static\n*/\nColor.black = new Color(0.0, 0.0, 0.0);\n\n/**\n * Color.cyan, a cyan Color Object\n * @property cyan {Color}\n * @static\n */\nColor.cyan = new Color(0, 1, 1);\n\n/**\n * Color.magenta, a magenta Color Object\n * @property magenta {Color}\n * @static\n */\nColor.magenta = new Color(1, 0, 1);\n\n/**\n * Color.yellow, a yellow Color Object\n * @property yellow {Color}\n * @static\n */\nColor.yellow = new Color(1, 1, 0);\n\n\n/**\n * Color.lightRed, a lightRed Color Object\n * @property lightRed {Color}\n * @static\n */\nColor.lightRed = new Color(1, 0.5, 0.5);\n\n/**\n * Color.lightGreen, a lightGreen Color Object\n * @property lightGreen {Color}\n * @static\n */\nColor.lightGreen = new Color(0.5, 1, 0.5);\n\n/**\n * Color.lightBlue, a lightBlue Color Object\n * @property lightBlue {Color}\n * @static\n */\nColor.lightBlue = new Color(0.5, 0.5, 1);\n\nColor.mobilizing = new Color(60/255, 30/255, 1);\nColor.mobilizingDark = new Color(36/255, 18/255, 153/255);\nColor.mobilizingLight = new Color(208/255, 202/255, 247/255);\nColor.mobilizingAlternate = new Color(255/255, 158/255, 116/255);\n\n/**\n* Color.transparent, a transparent Color Object\n* @property transparent {Color}\n* @static\n*/\nColor.transparent = new Color(new Color().makeRGBAStringWithAlpha(0));\n\n//module exports\nexport { Color };\n","import * as THREE from 'three';\n\n/**\n * Euler class (deprecated ?)\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Euler\n * @class Euler\n */\n\nclass Euler extends THREE.Euler\n{\n}\n\n// module exports\nexport { Euler };\n","import * as THREE from 'three';\n\n/**\n * Matrix3 class\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Matrix3\n * @class Matrix3\n**/\n\nclass Matrix3 extends THREE.Matrix3\n{\n}\n\n/**\n@method transpose\n@return Matrix3\n*/\n\n/**\n Transposes this matrix into the supplied array, and returns itself unchanged.\n@method transposeIntoArray\n@return Matrix3\n@param array {Array}\n*/\n\n/**\n@method determinant\n@return Float\n*/\n\n/**\n Sets the 3x3 matrix values to the given row-major sequence of values.\n@method set\n@return Matrix3\n@param n11 {Float}\n@param n12 {Float}\n@param n13 {Float}\n@param n21 {Float}\n@param n22 {Float}\n@param n23 {Float}\n@param n31 {Float}\n@param n32 {Float}\n@param n33 {Float}\n*/\n\n/**\n Multiplies every component of the matrix by the scalar value *s*.\n@method multiplyScalar\n@return Matrix3\n@param s {Float}\n*/\n\n/**\n Multiplies (applies) this matrix to every vector3 in the array.\n@method applyToVector3Array\n@return Array\n@param array {Array}\n*/\n\n/**\n Sets this matrix as the normal matrix (upper left 3x3)of the passed Matrix4 matrix4. The normal matrix is the inverse transpose of the matrix *m*.\n@method getNormalMatrix\n@return Matrix3\n@param m {Matrix4}\n*/\n\n/**\n Set this matrix to the inverse of the passed matrix.\n@method getInverse\n@return Matrix3\n@param m {Matrix4}\n@param throwOnDegenerate {Boolean}\n*/\n\n/**\n Copies the values of matrix *m* into this matrix.\n@method copy\n@return Matrix3\n@param m {Matrix3}\n*/\n\n/**\n@method clone\n@return Matrix3\n*/\n\n// module exports\nexport { Matrix3 };\n","import * as THREE from 'three';\n\n/**\n * Matrix4 class\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Matrix4\n * @class Matrix4\n**/\n\nclass Matrix4 extends THREE.Matrix4\n{\n}\n\n\n/**\n@method set\n@return Matrix4\n@param n11 {Float}\n@param n12 {Float}\n@param n13 {Float}\n@param n14 {Float}\n@param n21 {Float}\n@param n22 {Float}\n@param n23 {Float}\n@param n24 {Float}\n@param n31 {Float}\n@param n32 {Float}\n@param n33 {Float}\n@param n34 {Float}\n@param n41 {Float}\n@param n42 {Float}\n@param n43 {Float}\n@param n44 {Float}\n*/\n\n/**\n@method identity\n@return Matrix4\n*/\n\n/**\n@method copy\n@return Matrix4\n@param m {Matrix4}\n*/\n\n/**\n@method copyPosition\n@return Matrix4\n@param m {Matrix4}\n*/\n\n/**\n@method makeBasis\n@return Matrix4\n@param xAxis {Vector3}\n@param yAxis {Vector3}\n@param zAxis {Vector3}\n*/\n\n/**\n@method extractBasis\n@return Matrix4\n@param xAxis {Vector3}\n@param yAxis {Vector3}\n@param zAxis {Vector3}\n*/\n\n/**\n@method extractRotation\n@return Matrix4\n@param m {Matrix4}\n*/\n\n/**\n@method lookAt\n@return Matrix4\n@param eye {Vector3}\n@param center {Vector3}\n@param up {Vector3}\n*/\n\n/**\n@method multiply\n@return Matrix4\n@param m {Matrix4}\n*/\n\n/**\n@method multiplyMatrices\n@return Matrix4\n@param a {Matrix4}\n@param b {Matrix4}\n*/\n\n/**\n@method multiplyToArray\n@return Matrix4\n@param a {Matrix4}\n@param b {Matrix4}\n@param r {Array}\n*/\n\n/**\n@method multiplyScalar\n@return Matrix4\n@param s {Float}\n*/\n\n/**\n@method determinant\n@return Float\n*/\n\n/**\n@method transpose\n@return Matrix4\n*/\n\n/**\n@method flattenToArrayOffset\n@return Array\n@param flat {Array}\n@param offset {Integer}\n*/\n\n/**\n@method setPosition\n@return Matrix4\n@param v {Vector3}\n*/\n\n/**\n@method getInverse\n@return Matrix4\n@param m {Matrix4}\n*/\n\n/**\n Sets the rotation submatrix of this matrix to the rotation specified by Euler angles, the rest of the matrix is identity. Default order is *\"XYZ\"*.\n@method makeRotationFromEuler\n@return Matrix4\n@param euler {Euler}\n*/\n\n/**\n@method makeRotationFromQuaternion\n@return Matrix4\n@param q {Quaternion}\n*/\n\n/**\n@method scale\n@return Matrix4\n@param v {Vector3}\n*/\n\n/**\n@method compose\n@return Matrix4\n@param translation {Vector3}\n@param quaternion {Quaternion}\n@param scale {Vector3}\n*/\n\n/**\n@method decompose\n@return Array\n@param translation {Vector3}\n@param quaternion {Quaternion}\n@param scale {Vector3}\n*/\n\n/**\n@method makeTranslation\n@return Matrix4\n@param x {Float}\n@param y {Float}\n@param z {Float}\n*/\n\n/**\n Sets this matrix as rotation transform around x axis by *theta* radians.\n@method makeRotationX\n@return Matrix4\n@param theta {Float}\n*/\n\n/**\n Sets this matrix as rotation transform around y axis by *theta* radians.\n@method makeRotationY\n@return Matrix4\n@param theta {Float}\n*/\n\n/**\n Sets this matrix as rotation transform around z axis by *theta* radians.\n@method makeRotationZ\n@return Matrix4\n@param theta {Float}\n*/\n\n/**\n Sets this matrix as rotation transform around *axis* by *angle* radians. Based on [link:http://www.gamedev.net/reference/articles/article1199.asp.\n@method makeRotationAxis\n@return Matrix4\n@param axis {Vector3}\n@param theta {Float}\n*/\n\n/**\n@method makeScale\n@return Matrix4\n@param x {Float}\n@param y {Float}\n@param z {Float}\n*/\n\n/**\n@method makeFrustum\n@return Matrix4\n@param left {Float}\n@param right {Float}\n@param bottom {Float}\n@param top {Float}\n@param near {Float}\n@param far {Float}\n*/\n\n/**\n@method makePerspective\n@return Matrix4\n@param fov {Float}\n@param aspect {Float}\n@param near {Float}\n@param far {Float}\n*/\n\n/**\n@method makeOrthographic\n@return Matrix4\n@param left {Float}\n@param right {Float}\n@param top {Float}\n@param bottom {Float}\n@param near {Float}\n@param far {Float}\n*/\n\n/**\n@method clone\n@return Matrix4\n*/\n\n/**\n Multiplies (applies) this matrix to every vector3 in the array.\n@method applyToVector3Array\n@return Array\n@param a {Array}\n*/\n\n// module exports\nexport { Matrix4 };","import * as THREE from 'three';\n\n/**\n * Represents a Quaternion, a way to describe a spatial rotation that is less susceptible to gimbal lock.\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Quaternion\n * @class Quaternion\n */\n\nclass Quaternion extends THREE.Quaternion\n{\n}\n\n/**\n@method set\n@return Quaternion\n@param x {Float}\n@param y {Float}\n@param z {Float}\n@param w {Float}\n*/\n\n/**\n@method copy\n@return Quaternion\n@param q {Quaternion}\n*/\n\n/**\n@method setFromEuler\n@return Quaternion\n@param euler {Euler}\n*/\n\n/**\n@method setFromAxisAngle\n@return Quaternion\n@param axis {Vector3}\n@param angle {Float}\n*/\n\n/**\n@method setFromRotationMatrix\n@return Quaternion\n@param m {Matrix4}\n*/\n\n/**\n@method setFromUnitVectors\n@return Quaternion\n@param vFrom {Vector3}\n@param vTo {Vector3}\n*/\n\n/**\n@method inverse\n@return Quaternion\n*/\n\n/**\n@method length\n@return Float\n*/\n\n/**\n@method normalize\n@return Quaternion\n*/\n\n/**\n@method multiply\n@return Quaternion\n@param b {Quaternion}\n*/\n\n/**\n@method multiplyQuaternions\n@return Quaternion\n@param a {Quaternion}\n@param b {Quaternion}\n*/\n\n/**\n@method multiplyVector3\n@return Quaternion\n@param vector {Vector3}\n@param dest {Vector3}\n*/\n\n/**\n@method clone\n@return Quaternion\n*/\n\n/**\n Returns the numerical elements of this quaternion in an array of format (x, y, z, w).\n@method toArray\n@return Array\n@param array {Array}\n*/\n\n/**\n Compares each component of *v* to each component of this quaternion to determine if they represent the same rotation.\n@method equals\n@return Boolean\n@param v {Quaternion}\n*/\n\n/**\n@method lengthSq\n@return Float\n*/\n\n/**\n Sets this quaternion's component values from an array.\n@method fromArray\n@return Quaternion\n@param array {Array}\n*/\n\n/**\n@method conjugate\n@return Quaternion\n*/\n\n/**\n Handles the spherical linear interpolation between quaternions. *t* represents the amount of rotation between this quaternion (where *t* is 0) and quaternionB (where *t* is 1). This quaternion is set to the result. Also see the static version of the *slerp* below.\n@method slerp\n@return Quaternion\n@param quaternionB {Quaternion}\n@param t {float}\n*/\n\n// module exports\nexport { Quaternion };","class Rect\n{\n    /**\n    * Rect hold a simple rectangle representation with x & y coordinates and width & height.\n    *\n    * @class Rect\n    * @constructor\n    * @param {float} x\n    * @param {float} y\n    * @param {float} width\n    * @param {float} height\n    */\n    constructor(x,y, width,height)\n    {\n        this.x      = x;\n        this.y      = y;\n        this.width  = width;\n        this.height = height;\n    }\n\n    /**\n    * Return an array representation\n    * @method toArray\n    * @return {Array} [x, y, width, height]\n    */\n    toArray()\n    {\n        return [\n            this.x,\n            this.y,\n            this.width,\n            this.height\n        ];\n    }\n\n    /**\n    * Sets the rect's value based on an array formatted like [x, y, width, height]\n    * @method fromArray\n    * @param {Array} array [x, y, width, height]\n    */\n    fromArray(array)\n    {\n        this.x = array[0];\n        this.y = array[1];\n        this.width = array[2];\n        this.height = array[3];\n    }\n\n}\n\n// module exports\nexport { Rect };","import * as THREE from 'three';\n\n/**\n * Represents a 2 dimensionnal Euclidean Vector, to be used as 2D positions, 2D directions or 2D Euler angles (rotation).\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Vector2\n * @class Vector2\n */\nclass Vector2 extends THREE.Vector2\n{\n\n    rotate90CW() {\n        let memX = this.x;\n        let memY = this.y;\n        this.x = memY;\n        this.y = -memX;\n    }\n\n    rotate90CCW() {\n        let memX = this.x;\n        let memY = this.y;\n        this.x = -memY;\n        this.y = memX;\n    }\n\n}\n\n/**\n* Vector2.one returns <i>new Mobilizing.Vector2(1, 1)</i>\n* @property one\n* @static\n*/\nVector2.one = new Vector2(1, 1);\n\n/**\n* Vector2.zero returns <i>new Mobilizing.Vector2(0, 0)</i>\n* @property zero\n* @static\n*/\nVector2.zero = new Vector2(0, 0);\n\n/**\n@method set\n@return Vector2\n@param x {Float}\n@param y {Float}\n*/\n\n/**\n@method copy\n@return Vector2\n@param v {Vector2}\n*/\n\n/**\n@method add\n@return Vector2\n@param v {Vector2}\n*/\n\n/**\n@method addVectors\n@return Vector2\n@param a {Vector2}\n@param b {Vector2}\n*/\n\n/**\n@method addScaledVector\n@return Vector2\n@param v {Vector2}\n@param s {Float}\n*/\n\n/**\n@method sub\n@return Vector2\n@param v {Vector2}\n*/\n\n/**\n@method subVectors\n@return Vector2\n@param a {Vector2}\n@param b {Vector2}\n*/\n\n/**\n@method multiplyScalar\n@return Vector2\n@param s {Float}\n*/\n\n/**\n@method divideScalar\n@return Vector2\n@param s {Float}\n*/\n\n/**\n@method negate\n@return Vector2\n*/\n\n/**\n@method dot\n@return Float\n@param v {Vector2}\n*/\n\n/**\n@method lengthSq\n@return Float\n*/\n\n/**\n@method length\n@return Float\n*/\n\n/**\n@method lengthManhattan\n@return Float\n*/\n\n/**\n@method normalize\n@return Vector2\n*/\n\n/**\n@method angle\n@return Float\n*/\n\n/**\n@method distanceTo\n@return Float\n@param v {Vector2}\n*/\n\n/**\n@method distanceToSquared\n@return Float\n@param v {Vector2}\n*/\n\n/**\n@method setLength\n@return Vector2\n@param l {Float}\n*/\n\n/**\n@method equals\n@return Boolean\n@param v {Vector2}\n*/\n\n/**\n@method clone\n@return Vector2\n*/\n\n/**\n If this vector's x or y value is greater than the max vector's x or y value, it is replaced by the corresponding value. If this vector's x or y value is less than the min vector's x or y value, it is replaced by the corresponding value.\n@method clamp\n@return Vector2\n@param min {Vector2}\n@param max {Vector2}\n*/\n\n/**\n If this vector's x or y values are greater than the max value, they are replaced by the max value. If this vector's x or y values are less than the min value, they are replaced by the min value.\n@method clampScalar\n@return Vector2\n@param min {Float}\n@param max {Float}\n*/\n\n/**\n@method floor\n@return Vector2\n*/\n\n/**\n@method ceil\n@return Vector2\n*/\n\n/**\n@method round\n@return Vector2\n*/\n\n/**\n@method roundToZero\n@return Vector2\n*/\n\n/**\n Linear interpolation between this vector and v, where alpha is the percent along the line.\n@method lerp\n@return Vector2\n@param v {Vector2}\n@param alpha {Float}\n*/\n\n/**\n Sets this vector to be the vector linearly interpolated between *v1* and *v2* with *alpha* factor.\n@method lerpVectors\n@return Vector2\n@param v1 {Vector2}\n@param v2 {Vector2}\n@param alpha {Float}\n*/\n\n/**\n if index equals 0 method replaces this.x with value. if index equals 1 method replaces this.y with value.\n@method setComponent\n@return undefined\n@param index {Integer}\n@param value {Float}\n*/\n\n/**\n Add the scalar value s to this vector's x and y values.\n@method addScalar\n@return Vector2\n@param s {Float}\n*/\n\n/**\n if index equals 0 returns the x value. if index equals 1 returns the y value.\n@method getComponent\n@return Float\n@param index {Integer}\n*/\n\n/**\n Sets this vector's x value to be array[0 and y value to be array[1].\n@method fromArray\n@return Vector2\n@param array {Array}\n*/\n\n/**\n Returns an array [x, y]\n@method toArray\n@return Array\n@param array {Array}\n*/\n\n/**\n If this vector's x or y value is greater than v's x or y value, replace that value with the corresponding min value.\n@method min\n@return Vector2\n@param v {Vector2}\n*/\n\n/**\n If this vector's x or y value is less than v's x or y value, replace that value with the corresponding max value.\n@method max\n@return Vector2\n@param v {Vector2}\n*/\n\n/**\n replace this vector's x value with x.\n@method setX\n@return Vector2\n@param x {Float}\n*/\n\n\n// module exports\nexport { Vector2 };","import * as THREE from 'three';\n\n/**\n * Represents a 3 dimensionnal Euclidean Vector, to be used as positions, directions or Euler angles (rotation).\n *\n * This class extends the one from Three.js, API available here : http://threejs.org/docs/#Reference/Math/Vector3\n * @class Vector3\n */\n\nclass Vector3 extends THREE.Vector3\n{\n}\n\n/**\n* Vector3.one returns <i>new Mobilizing.Vector2(1, 1, 1)</i>\n* @property one\n* @static\n*/\nVector3.one  = new Vector3(1, 1, 1);\n\n/**\n* Vector3.one returns <i>new Mobilizing.Vector2(0, 0, 0)</i>\n* @property zero\n* @static\n*/\nVector3.zero = new Vector3(0, 0, 0);\n\n/**\n@method set\n@return Vector3\n@param x {Float}\n@param y {Float}\n@param z {Float}\n*/\n\n/**\n@method setX\n@return Vector3\n@param x {Float}\n*/\n\n/**\n@method setY\n@return Vector3\n@param y {Float}\n*/\n\n/**\n@method setZ\n@return Vector3\n@param z {Float}\n*/\n\n/**\n@method copy\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n@method add\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n@method addVectors\n@return Vector3\n@param a {Vector3}\n@param b {Vector3}\n*/\n\n/**\n@method addScaledVector\n@return Vector3\n@param v {Vector3}\n@param s {Float}\n*/\n\n/**\n@method sub\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n@method subVectors\n@return Vector3\n@param a {Vector3}\n@param b {Vector3}\n*/\n\n/**\n@method multiplyScalar\n@return Vector3\n@param s {Float}\n*/\n\n/**\n@method divideScalar\n@return Vector3\n@param s {Float}\n*/\n\n/**\n@method negate\n@return Vector3\n*/\n\n/**\n@method dot\n@return Float\n@param v {Vector3}\n*/\n\n/**\n@method lengthSq\n@return Float\n*/\n\n/**\n@method length\n@return Float\n*/\n\n/**\n@method lengthManhattan\n@return Float\n*/\n\n/**\n@method normalize\n@return Vector3\n*/\n\n/**\n@method distanceTo\n@return Float\n@param v {Vector3}\n*/\n\n/**\n@method distanceToSquared\n@return Float\n@param v {Vector3}\n*/\n\n/**\n@method setLength\n@return Vector3\n@param l {Float}\n*/\n\n/**\n@method cross\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n@method crossVectors\n@return Vector3\n@param a {Vector3}\n@param b {Vector3}\n*/\n\n/**\n@method setFromMatrixPosition\n@return Vector3\n@param m {Matrix4}\n*/\n\n/**\n@method setFromMatrixScale\n@return Vector3\n@param m {Matrix4}\n*/\n\n/**\n@method equals\n@return Boolean\n@param v {Vector3}\n*/\n\n/**\n@method clone\n@return Vector3\n*/\n\n/**\n If this vector's x, y or z value is greater than the max vector's x, y or z value, it is replaced by the corresponding value. If this vector's x, y or z value is less than the min vector's x, y or z value, it is replaced by the corresponding value.\n@method clamp\n@return Vector3\n@param min {Vector3}\n@param max {Vector3}\n*/\n\n/**\n If this vector's x, y or z values are greater than the max value, they are replaced by the max value. If this vector's x, y or z values are less than the min value, they are replaced by the min value.\n@method clampScalar\n@return Vector3\n@param min {Float}\n@param max {Float}\n*/\n\n/**\n@method floor\n@return Vector3\n*/\n\n/**\n@method ceil\n@return Vector3\n*/\n\n/**\n@method round\n@return Vector3\n*/\n\n/**\n@method roundToZero\n@return Vector3\n*/\n\n/**\n Multiplies this vector times a 3 x 3 matrix.\n@method applyMatrix3\n@return Vector3\n@param m {Matrix3}\n*/\n\n/**\n Multiplies this vector by 4 x 3 subset of a Matrix4.\n@method applyMatrix4\n@return Vector3\n@param m {Matrix3}\n*/\n\n/**\n Projects this vector onto a plane by subtracting this vector projected onto the plane's normal from this vector.\n@method projectOnPlane\n@return Vector3\n@param planeNormal {Vector3}\n*/\n\n/**\n Projects this vector onto another vector.\n@method projectOnVector\n@return Vector3\n*/\n\n/**\n Adds a s to this vector.\n@method addScalar\n@return Vector3\n*/\n\n/**\n Divides this vector by vector v.\n@method divide\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n If this vector's x, y, or z value is greater than vector v's x, y, or z value, that value is replaced by the corresponding vector v value.\n@method min\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n If this vector's x, y, or z value is less than vector v's x, y, or z value, that value is replaced by the corresponding vector v value.\n@method max\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n If index equals 0 the method sets this vector's x value to value If index equals 1 the method sets this vector's y value to value If index equals 2 the method sets this vector's z value to value\n@method setComponent\n@return Vector3\n@param index {Integer}\n@param value {Float}\n*/\n\n/**\n Transforms the direction of this vector by a matrix (a 3 x 3 subset of a Matrix4) and then normalizes the result.\n@method transformDirection\n@return Vector3\n@param m {Matrix4}\n*/\n\n/**\n Sets this vector equal to the result of multiplying vector a by vector b.\n@method multiplyVectors\n@return Vector3\n@param a {Vector3}\n@param b {Vector3}\n*/\n\n/**\n Returns the value of the vector component x, y, or z by an index. Index 0: x Index 1: y Index 2: z\n@method getComponent\n@return Float\n@param index {Integer}\n*/\n\n/**\n Applies a rotation specified by an axis and an angle to this vector.\n@method applyAxisAngle\n@return Vector3\n@param axis {Vector3}\n@param angle {Float}\n*/\n\n/**\n Linear Interpolation between this vector and vector v, where alpha is the percent along the line.\n@method lerp\n@return Vector3\n@param v {Vector3}\n@param alpha {Float}\n*/\n\n/**\n Sets this vector to be the vector linearly interpolated between *v1* and *v2* with *alpha* factor.\n@method lerpVectors\n@return Vector3\n@param v1 {Vector3}\n@param v2 {Vector3}\n@param alpha {Float}\n*/\n\n/**\n Returns the angle between this vector and vector v in radians.\n@method angleTo\n@return Float\n@param v {Vector3}\n*/\n\n/**\n Sets this vector's x, y, and z equal to the column of the matrix specified by the index.\n@method setFromMatrixColumn\n@return Vector3\n@param index {Integer}\n@param matrix {Matrix4}\n*/\n\n/**\n Reflect incident vector off of plane orthogonal to normal. normal is assumed to have unit length.\n@method reflect\n@return Vector3\n@param normal {Vector3}\n*/\n\n/**\n Sets the vector's components based on an array formatted like [x, y, z\n@method fromArray\n@return Vector3\n@param array {Array}\n*/\n\n/**\n Multipies this vector by vector v.\n@method multiply\n@return Vector3\n@param v {Vector3}\n*/\n\n/**\n Multiplies this vector and m, and divides by perspective.\n@method applyProjection\n@return Vector3\n@param m {Matrix4}\n*/\n\n/**\n Assigns this vector's x value to array[0. Assigns this vector's y value to array[1]. Assigns this vector's z value to array[2]. Returns the created array.\n@method toArray\n@return Array\n@param array {Array}\n*/\n\n/**\n Applies euler transform to this vector by converting the Euler obect to a [page:Quaternion] and applying.\n@method applyEuler\n@return Vector3\n@param euler {Euler}\n*/\n\n/**\n Applies a Quaternion transform to this vector.\n@method applyQuaternion\n@return Vector3\n@param quaternion {Quaternion}\n*/\n\n/**\n Projects the vector with the camera.\n@method project\n@return Vector3\n@param camera {Camera}\n*/\n\n// module exports\nexport { Vector3 };","/**\n * Math class gives easy access to some basics calculations that are frequently used in interactive computer graphics\n *\n * @class Math\n * @example\n *     Mobilizing.Math.map(10, 0,20, -10,10);\n */\n\nclass _Math\n{\n\n    /**\n     * Generates a random number between 2 float values\n     * @method randomFromTo\n     * @static\n     * @param {float} from\n     * @param {float} to\n     */\n    static randomFromTo(from, to) {\n        return Math.random() * (to - from) + from;\n    }\n\n    /**\n     * Maps a number between 2 sets of float values\n     * @method map\n     * @static\n     * @param {float} value the value to map\n     * @param {float} low1 the 1st origin value\n     * @param {float} high1 the 2nd destination value\n     * @param {float} low2 the 1st destination value\n     * @param {float} high2\n     */\n    static map(value, low1, high1, low2, high2) {\n        return low2 + (high2 - low2) * (value - low1) / (high1 - low1);\n    }\n\n    /**\n     * Converts degrees to radians\n     * @static\n     * @method degToRad\n     * @param {float} val\n     */\n    static degToRad(val){\n        var degreeToRadiansFactor = Math.PI / 180;\n        return val * degreeToRadiansFactor;\n    }\n\n    /**\n     * Converts radians to degrees\n     * @static\n     * @method radToDeg\n     * @param {float} val\n     */\n    static radToDeg(val){\n        var radianToDegreesFactor = 180 / Math.PI ;\n        return val * radianToDegreesFactor;\n    }\n\n    /**\n     * Calculates the distance between two 2D points\n     * @static\n     * @method dist\n     * @param {float} x1\n     * @param {float} y1\n     * @param {float} x2\n     * @param {float} y2\n     */\n    static dist(x1,y1, x2,y2){\n        return Math.sqrt( ((x2-x1)*(x2-x1)) + ((y2-y1)*(y2-y1)) );\n    }\n\n    /**\n     * Lerps a value to the destination value with the given amount\n     * @static\n     * @method lerp\n     * @param {float} value\n     * @param {float} dest\n     * @param {float} amount\n     */\n    static lerp(value,dest,amount){\n        return (value + (dest-value)*amount);\n    }\n\n    /**\n     * Clamp a value between a minimum and a maximum\n     * @static\n     * @method clamp\n     * @param {Number} value\n     * @param {Number} min\n     * @param {Number} max\n     */\n    static clamp(value, min, max){\n        return (Math.min(max, Math.max(min, value)));\n    }\n\n    /**\n     * Finds if a point is inside an array of vertices\n     * @static\n     * @method pointIsInside\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Vector2 Array} points vertices {x,y}\n     */\n    static pointIsInside(x,y, points)\n    {\n        let i, j = points.length - 1;\n        let oddNodes = false;\n\n        for ( i=0; i < points.length; i++ )\n        {\n            if (points[i].y < y && points[j].y >= y ||\n                points[j].y < y && points[i].y >= y)\n            {\n                if (points[i].x + (y - points[i].y) / (points[j].y - points[i].y) * (points[j].x - points[i].x) < x)\n                {\n                    oddNodes = !oddNodes;\n                }\n            }\n            j=i;\n        }\n\n        return oddNodes;\n    }\n\n    static intersectionPoint(line1, line2)\n    {\n        let a1 = line1[1].x - line1[0].x;\n        let b1 = line2[0].x - line2[1].x;\n        let c1 = line2[0].x - line1[0].x;\n\n        let a2 = line1[1].y - line1[0].y;\n        let b2 = line2[0].y - line2[1].y;\n        let c2 = line2[0].y - line1[0].y;\n\n        \n        let t;\n        //treat special case : points are on the same lines!\n        if(b1*c2 === 0 && b2*c1 === 0 && a2*b1  === 0 && a1*b2  === 0)\n        {\n            t = 0;\n        }\n        else\n        {\n            t = (b1*c2 - b2*c1) / (a2*b1 - a1*b2); \n        }\n\n\n        return {\n            x: line1[0].x + t * (line1[1].x - line1[0].x),\n            y: line1[0].y + t * (line1[1].y - line1[0].y)\n        };\n    }\n\n}\n\n// module exports\nexport { _Math };\n","/**\n* Log a message into the console or redirect it to the provided label if Mobilizing.debug === true\n* @static\n* @method Log\n* @param {String} message\n* @param {String} type\n* @param {Label} label\n*/\n\nvar _debugEnabled = window.location.search.search(\"[?&]debug(=([^&#]*)|&|#|$)\") > -1;\n\nclass Debug\n{\n\n    constructor(label){\n        this.label = label;\n    }\n\n    log(){\n        if( this.doLog() ){\n            console.log.apply(console, arguments);\n        }\n    }\n\n    warn(){\n        if( this.doLog() ){\n            console.warn.apply(console, arguments);\n        }\n    }\n\n    info(){\n        if( this.doLog() ){\n            console.info.apply(console, arguments);\n        }\n    }\n\n    error(){\n        if( this.doLog() ){\n            console.error.apply(console, arguments);\n        }\n    }\n\n    doLog(){\n        return this.label || _debugEnabled;\n    }\n\n}\n\nvar debug = new Debug();\n\n// module exports\nexport { Debug, debug };","import {_Math} from '../helpers/Math';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {getOrDefault} from '../helpers/Misc';\n\nclass Time extends Component\n{\n    /**\n    * The Time class provides methods to control time related operations. One instance of this Component is created internnaly by the Context. It makes it possible to access and to use a global time in Components that require it (i.e Touch, Animation, etc.). In users script, this global Time can be accessed via the context.\n    * \n    * @example\n    *    //TODO\n    *\n    * @class Time\n    * @constructor\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this._startTime = getOrDefault(params, \"startTime\", new Date().getTime());\n        this._timeScale = getOrDefault(params, \"scale\",1);\n\n        this._currentTime = new Date().getTime();\n        this._deltaTime = 0;\n    }\n\n    /*setup()\n    {\n        super.setup();\n    }*/\n\n    /**\n    * Start the Time\n    * @method on\n    */\n    on()\n    {\n        super.on();\n        this.reset();\n    }\n\n    /**\n    * Pause the Time\n    * @method off\n    */\n    /*off()\n    {\n        super.off();\n    }*/\n\n    /**\n    * resets this time instance\n    * \n    * @method reset\n    */\n    reset()\n    {\n        this._startTime = new Date().getTime();\n    }\n\n    /**\n    * updates this time instance\n    * \n    * @method update\n    */\n    update()\n    {\n        if(this.getStatus())//the component must be on, else we \"stop\" the time\n        {\n            let lastTime = this._currentTime;\n            this._currentTime = new Date().getTime();\n            this._deltaTime = (this._currentTime - lastTime)/1000 * this._timeScale;\n        }\n    }\n\n    /**\n    * absolute Delta\n    * \n    * @method getAbsoluteDelta\n    * @return {Number} absolute Delta\n    */\n    getAbsoluteDelta()\n    {\n        return this._currentTime - this._startTime;\n    }\n    /**\n    * Set the current timeScale, useful to slower time down\n    * \n    * @method setTimeScale\n    * @param {Number} scale\n    */\n    setTimeScale(scale)\n    {\n        this._timeScale = scale;\n    }\n\n    /**\n    * Get the current timeScale\n    * \n    * @method getTimeScale\n    * @return {Number} scale\n    */\n    getTimeScale()\n    {\n        return this._timeScale;\n    }\n\n    /**\n    * Get the current timeDelta (difference of time between 2 frames) at the current timeScale\n    * \n    * @method getDelta\n    * @return {Number} the current timeDelta at the current timeScale\n    */\n    getDelta()\n    {\n        return this._deltaTime;\n    }\n\n    /**\n    * Gets the current Time object's time\n    * \n    * @method getTime\n    * @return {Number} the current time\n    */\n    getTime()\n    {\n        return this._currentTime;\n    }\n\n}\n\n// module exports\nexport { Time };\n","import {_Math} from './Math';\nimport {Time} from '../time/Time';\nimport {Component} from '../Component';\nimport {getOrDefault} from '../helpers/Misc';\nimport {debug} from './Debug';\n\n/**\n * Fired when the animation starts\n * @event start\n * @param {Object} target The target object\n */\nconst EVT_START = 'start';\n\n/**\n * Fired each time the animation is updated\n * @event update\n * @param {Object} target The target object\n */\nconst EVT_UPDATE = 'update';\n\n/**\n * Fired when each time the animation is repeated once it reached the end if repeat is greater than 1\n * @event restart\n * @param {Object} target The target object\n * @param {Number} direction The current direction\n */\nconst EVT_RESTART = 'restart';\n\n/**\n * Fired when the animation is stopped\n * @event stop\n * @param {Object} target The target object\n */\nconst EVT_STOP = 'stop';\n\n/**\n * Fired when the animation is resumed\n * @event resume\n * @param {Object} target The target object\n */\nconst EVT_RESUME = 'resume';\n\n/**\n * Fired when the animation reaches the end and no repetition is pending\n * @event finish\n * @param {Object} target The target object\n */\nconst EVT_FINISH = 'finish';\n\n\nclass Animation extends Component\n{\n    /**\n    * The Animation class provides a simple way to tween object properties\n    * \n    * @example\n    *    //TODO\n    *\n    * @class Animation\n    * @constructor\n    * @param {Object} params The parameters object\n    * @param {Object} params.target The object whose propoerties are to be animated\n    * @param {Object} [params.from] An object indicating the start values of the properties to animate, defaults to the values of the target\n    * @param {Object} params.to An object indicating the finish values of the properties to animate\n    * @param {Number} params.duration The animation duration in milliseconds\n    * @param {Function} [params.easing=Animation.Easing.linear] An easing function to use\n    * @param {Number} [params.repeat=0] The number of times the animation should be repeated, set to Infinity to repeat indefinately\n    * @param {Boolean} [params.yoyo=false] If set to true and repeat is greater than 1, the animation will play in reverse once it reached the end\n    * @param {Number} [params.delay=0] The number of milliseconds to wait for before starting the animation\n    * @param {Time} [params.time] The Time instance to use for this Animation Component\n    * @param {Function} [params.onStart] A callback to be called when the animation starts\n    * @param {Function} [params.onUpdate] A callback to be called each time the animation is updated\n    * @param {Function} [params.onRestart] A callback to be called each time the animation is repeated once it reached the end if repeat is greater than 1\n    * @param {Function} [params.onStop] A callback to be called when the animation is stopped\n    * @param {Function} [params.onResume] A callback to be called when the animation is resumed\n    * @param {Function} [params.onFinish] A callback to be called when the animation reaches the end and no repetition is pending\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this._target = params.target;\n        this._from = getOrDefault(params, \"from\", null);\n        this._to = params.to;\n        this._duration = params.duration;\n        this._easing = getOrDefault(params, \"easing\", Animation.Easing.linear);\n        this._repeat = getOrDefault(params, \"repeat\", 0);\n        this._yoyo = getOrDefault(params, \"yoyo\", false);\n        this._delay = getOrDefault(params, \"delay\", 0);\n        this._time = new Time();\n\n        this._timesPlayed = 0;\n        this._direction = 1;\n\n        let onStart = getOrDefault(params, \"onStart\", null);\n        let onUpdate = getOrDefault(params, \"onUpdate\", null);\n        let onRestart = getOrDefault(params, \"onRestart\", null);\n        let onStop = getOrDefault(params, \"onStop\", null);\n        let onResume = getOrDefault(params, \"onResume\", null);\n        let onFinish = getOrDefault(params, \"onFinish\", null);\n\n        // bind custom callbacks to events\n        if(onStart){\n            this.events.on(EVT_START, onStart);\n        }        \n        if(onUpdate){\n            this.events.on(EVT_UPDATE, onUpdate);\n        }        \n        if(onRestart){\n            this.events.on(EVT_RESTART, onRestart);\n        }        \n        if(onStop){\n            this.events.on(EVT_STOP, onStop);\n        }        \n        if(onResume){\n            this.events.on(EVT_RESUME, onResume);\n        }        \n        if(onFinish){\n            this.events.on(EVT_FINISH, onFinish);\n        }\n\n    }\n\n    /**\n    * Setup\n    * \n    * @method setup\n    */\n    setup()\n    {\n        let context = this.getContext();\n\n        context.addComponent(this._time);\n        this._time.setup();\n        this._time.on();\n\n        this._isPlaying = false;\n\n    }\n\n    /**\n    * Play the animation\n    *\n    * @method play\n    */\n    play()\n    {        \n        this._isPlaying = true;\n        this._time.reset();\n\n        if(!this._from){            \n            // fill in the start values from the target\n            this._from = {};\n            for(let prop in this._to){\n                this._from[prop] = this._target[prop];\n            }\n        }\n\n        this.events.trigger(EVT_START, this._target);\n    }\n\n    /**\n    * Stop the animation\n    *\n    * @method stop\n    */\n    stop()\n    {        \n        this._isPlaying = false;\n\n        this.events.trigger(EVT_STOP, this._target);\n    }\n\n    /**\n    * Resume the animation\n    *\n    * @method resume\n    */\n    resume()\n    {\n\n    }\n\n    /**\n    * Rewind the animation back to its starting values\n    *\n    * @method rewind\n    */\n    rewind()\n    {\n        this.update(0);\n    }\n\n    /**\n    * Update the properties according to the elapsed time\n    * \n    * @method update\n    */\n    update(time)\n    {\n        if(!this._isPlaying){\n            return;\n        }\n\n        let t = (time !== undefined ? time : (this._time.getAbsoluteDelta())) / this._duration;\n\n        if(t >= 1){\n            for(let prop in this._from){\n                this._target[prop] = this._to[prop];\n            }\n\n            if(this._timesPlayed++ < this._repeat){\n                if(this._yoyo){\n                    this._direction *= -1;\n                }\n                this._time.reset();\n\n                this.events.trigger(EVT_RESTART, this._target, this._direction);\n            }\n            else{\n                this._isPlaying = false;\n                this.events.trigger(EVT_FINISH, this._target);\n            }\n        }\n        else{\n            for(let prop in this._from){\n                if(this._direction < 1){\n                    this._target[prop] = _Math.map(this._easing(t), 0, 1, this._to[prop], this._from[prop]);\n                }\n                else{\n                    this._target[prop] = _Math.map(this._easing(t), 0, 1, this._from[prop], this._to[prop]);\n                }\n            }\n\n            this.events.trigger(EVT_UPDATE, this._target);\n        }\n    }\n\n    /**\n    * Chain another animation once this one is finished\n    * \n    * @method chain\n    */\n    chain(animation)\n    {\n        this.events.on(EVT_FINISH, function(){\n            animation.play();\n        });\n    }\n\n};\n\n// credit: https://gist.github.com/gre/1650294\nAnimation.Easing = {\n    \"linear\": function(t){\n        return t;\n    },\n    \"easeInQuad\": function(t){\n        return Math.pow(t, 2);\n    },\n    \"easeOutQuad\": function(t){\n        return 1 - Math.abs(Math.pow(t-1, 2));\n    },\n    \"easeInOutQuad\": function(t){\n        if (t < 0.5) {\n            return Animation.Easing.easeInQuad(t*2) / 2;\n        }\n        return Animation.Easing.easeOutQuad(t*2 - 1) / 2 + 0.5;\n    },\n    \"easeInCubic\": function(t){\n        return Math.pow(t, 3);\n    },\n    \"easeOutCubic\": function(t){\n        return 1 - Math.abs(Math.pow(t-1, 3));\n    },\n    \"easeInOutCubic\": function(t){\n        if (t < 0.5) {\n            return Animation.Easing.easeInCubic(t*2) / 2;\n        }\n        return Animation.Easing.easeOutCubic(t*2 - 1) / 2 + 0.5;\n    },\n    \"easeInQuart\": function(t){\n        return Math.pow(t, 4);\n    },\n    \"easeOutQuart\": function(t){\n        return 1 - Math.abs(Math.pow(t-1, 4));\n    },\n    \"easeInOutQuart\": function(t){\n        if (t < 0.5) {\n            return Animation.Easing.easeInQuart(t*2) / 2;\n        }\n        return Animation.Easing.easeOutQuart(t*2 - 1) / 2 + 0.5;\n    },\n    \"easeInQuint\": function(t){\n        return Math.pow(t, 5);\n    },\n    \"easeOutQuint\": function(t){\n        return 1 - Math.abs(Math.pow(t-1, 5));\n    },\n    \"easeInOutQuint\": function(t){\n        if (t < 0.5) {\n            return Animation.Easing.easeInQuint(t*2) / 2;\n        }\n        return Animation.Easing.easeOutQuint(t*2 - 1) / 2 + 0.5;\n    },\n    \"easeInSin\": function (t){\n        return 1 + Math.sin(Math.PI / 2 * t - Math.PI / 2);\n    },\n    \"easeOutSin\": function (t){\n        return Math.sin(Math.PI / 2 * t);\n    },\n    \"easeInOutSin\": function (t){\n        return (1 + Math.sin(Math.PI * t - Math.PI / 2)) / 2;\n    },\n    \"easeInElastic\": function (t){\n        return (.04 - .04 / t) * Math.sin(25 * t) + 1;\n    },\n    \"easeOutElastic\": function (t){\n        return .04 * t / (--t) * Math.sin(25 * t);\n    },\n    \"easeInOutElastic\": function (t){\n        if((t -= .5) < 0) {\n            return (.01 + .01 / t) * Math.sin(50 * t);\n        } else {\n            return (.02 - .01 / t) * Math.sin(50 * t) + 1;\n        }\n    },\n    \"easeInBounce\": function (t){\n        return 1 - Animation.Easing.easeOutBounce(1 - t);\n    },\n    \"easeOutBounce\": function (t){\n        if(t < (1 / 2.75)) {\n            return 7.5625 * t * t;\n        } else if (t < (2 / 2.75)) {\n            return 7.5625 * (t -= (1.5 / 2.75)) * t + 0.75;\n        } else if (t < (2.5 / 2.75)) {\n            return 7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375;\n        } else {\n            return 7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375;\n        }\n    },\n    \"easeInOutBounce\": function (t){\n        if(t < 0.5) {\n            return Animation.Easing.easeInBounce(t * 2) * 0.5;\n        }\n        return Animation.Easing.easeOutBounce(t * 2 - 1) * 0.5 + 0.5;\n    }\n\n};\n\n// module exports\nexport { Animation };\n","import {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\n\nclass Material\n{\n    /**\n     * A material will give color and some effect to the surface of the 3D object.\n     * Mobilizing.js is heavily based on the one of Three.js http://threejs.org/docs/#Reference/Materials/Material and its variations\n     *\n     * @class Material\n     * @constructor\n     * @param {Object} params an object containing all the possible parameters for this class. Use it like in the following example. Possible parameters are lisited below.\n     * @example\n     *     //this is how to use a parameters object in order to instanciate a Mobilizing.js object\n     *     var mobilizingObject = new Mobilizing.Class({paramName1: value, paramName2: value});\n     *\n     * @param {String} [params.type=\"basic\"] the type of the matrial, one of \"basic\", \"projectionmapping\", \"phong\", \"line\", \"sprite\"\n     */\n    constructor(params)\n    {\n        params.type = getOrDefault(params, \"type\", \"default\");\n\n        this.texture = undefined;\n\n        switch(params.type)\n        {\n            case \"basic\":\n\n                this._material = new THREE.MeshBasicMaterial( {color: 0xffffff, wireframe: false /*,overdraw: true*/ } );\n                break;\n\n            case \"custom\":\n\n                this._material = new THREE.ShaderMaterial({fragmentShader : params.fragmentShader,\n                                                           vertexShader : params.vertexShader,\n                                                           uniforms : params.uniforms});\n                //this._material.lights = true; //pass the lights uniforms\n                break;\n\n            case \"projectionmapping\":\n\n                var shader = THREE.ShaderLib[\"cube\"];\n                var uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n                shader.vertexShader = shader.vertexShader.replace(\"vWorldPosition = transformDirection( position, modelMatrix );\",\n                                                                  \"vWorldPosition = (modelMatrix * vec4( position, 0.0 )).xyz;\");\n\n                shader.fragmentShader = shader.fragmentShader.replace(\"gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\n                                                                      \"vec3 viewDir = vWorldPosition-viewPosition;  gl_FragColor = textureCube( tCube, normalize(viewDir));\");\n\n                shader.fragmentShader = shader.fragmentShader.replace(\"uniform samplerCube tCube;\",\n                                                                      \"uniform samplerCube tCube; uniform vec3 viewPosition;\");\n\n                uniforms['viewPosition'] =  {type: 'v3', value: new THREE.Vector3(0,0,0)};\n\n                this._material = new THREE.ShaderMaterial({fragmentShader : shader.fragmentShader,\n                                                           vertexShader : shader.vertexShader,\n                                                           uniforms : uniforms});\n\n                break;\n\n            case \"lambert\": //vertex lit\n\n                this._material = new THREE.MeshLambertMaterial( {color: 0xffffff, wireframe: false, shading: THREE.FlatShading } );\n                //this._material = new THREE.MeshLambertMaterial( { color: 0xffffff, combine: THREE.MixOperation});\n                break;\n\n            case \"default\":\n            case \"phong\":\n                this._material = new THREE.MeshPhongMaterial( {color: 0xffffff} );\n                this._material.shading = THREE.SmoothShading;\n                break;\n\n            case \"line\":\n\n                this._material = new THREE.LineBasicMaterial( {color: 0xffffff} );\n                break;\n\n            case \"sprite\":\n\n                this._material = new THREE.SpriteMaterial( {color: 0xffffff} );\n                break;\n\n            default:\n\n                this._material = new THREE.MeshBasicMaterial( { color: 0xffffff, wireframe: false } );\n        }\n\n        this._material.side = THREE.DoubleSide;\n        //this._material.transparent = true;\n        this.type = params.type;\n        //this._material.alphaTest = 0.1;\n    }\n\n    /**\n     * set the texture\n     *\n     * @method setTexture\n     * @param {Texture} texture\n     */\n    setTexture(texture)\n    {\n        this.texture = texture;\n\n        if (this.texture._texture !== undefined)\n        {\n            //console.log(\"attach texture to material\");\n            this._material.map = this.texture._texture;\n            //this._material.needsUpdate = true;\n        }\n        else if (texture.cube !== undefined)\n        {\n            if (this.type === \"projectionmapping\")\n            {\n                this._material.uniforms['tCube'].value = texture.cube;   // textureCube has been init before\n            }\n            else\n            {\n                this._material.envMap = texture.cube;\n            }\n        }\n    }\n\n    /**\n    * Gets the current texture\n    *\n    * @method getTexture\n    * @return {Texture}\n    */\n    getTexture()\n    {\n        return this.texture;\n    }\n\n    /**\n     * @method setUniform\n     * @param {String} name the name of the uniform to set\n     * @param {Object} value the value of the uniform to set\n     */\n    setUniform(name, value)\n    {\n        this._material.uniforms[name].value = value;\n    }\n\n    /**\n    * @method setTransparent\n    * @param {Boolean} trans\n    */\n    setTransparent(trans)\n    {\n        this._material.transparent = trans;\n    }\n\n    /**\n    * @method getTransparent\n    * @return {Boolean}\n    */\n    getTransparent()\n    {\n        return this._material.transparent;\n    }\n\n    /**\n    * @method setColor\n    * @param {Color} color\n    */\n    setColor(color)\n    {\n        //debug.log(\"material type\", this._material);\n        this._material.color = color;\n    }\n\n    /**\n    * @method getColor\n    * @return {Color}\n    */\n    getColor()\n    {\n        return this._material.color;\n    }\n\n    /**\n    * @method setWireframe\n    * @param {Boolean} wireframe\n    */\n    setWireframe(wireframe)\n    {\n        this._material.wireframe = wireframe;\n    }\n\n    /**\n    * @method getWireframe\n    * @return {Boolean}\n    */\n    getWireframe()\n    {\n        return this._material.wireframe;\n    }\n\n    /**\n    * @method setOpacity\n    * @param {float} op\n    */\n    setOpacity(op)\n    {\n        this._material.opacity = op;\n    }\n\n    /**\n    * @method getOpacity\n    * @return {float}\n    */\n    getOpacity()\n    {\n        return this._material.opacity;\n    }\n\n    /**\n    * @method setDoubleSided\n    * @param {Boolean} sided\n    */\n    setDoubleSided(sided)\n    {\n        this._material.side = sided ? THREE.DoubleSide : THREE.FrontSide;\n    }\n\n    /**\n    * @method getDoubleSided\n    * @return {Boolean}\n    */\n    getDoubleSided()\n    {\n        if(this._material.side === THREE.DoubleSide)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    /**\n    * @method setAlphaTest\n    * @param {Boolean} val\n    */\n    setAlphaTest(val)\n    {\n        this._material.alphaTest = val;\n    }\n\n    /**\n    * @method getAlphaTest\n    * @return {Boolean}\n    */\n    getAlphaTest()\n    {\n        return this._material.alphaTest;\n    }\n\n    setDepthWrite(bool)\n    {\n        this._material.depthWrite = bool;\n    }\n\n    setDepthTest(bool)\n    {\n        this._material.depthTest = bool;\n    }\n\n    /**\n    * @method setLineWidth\n    * @param {Number} val\n    */\n    setLineWidth(val)\n    {\n        this._material.linewidth = val;\n    }\n\n    /**\n    * @method getLineWidth\n    * @return {Number}\n    */\n    getLineWidth()\n    {\n        return this._material.linewidth;\n    }\n\n    /**\n     * @method setShininess\n     * @param {Number} color\n     */\n    setShininess(val)\n    {\n        //debug.log(\"material type\", this._material);\n        this._material.shininess = val;\n    }\n\n    /**\n     * @method getShininess\n     * @return {Number}\n     */\n    getShininess()\n    {\n        return this._material.shininess;\n    }\n\n    /**\n     * @method setEmissiveColor\n     * @param {Color} color\n     */\n    setEmissiveColor(color)\n    {\n        //debug.log(\"material type\", this._material);\n        this._material.emissive = color;\n    }\n\n    /**\n     * @method getEmissiveColor\n     * @return {Color}\n     */\n    getEmissiveColor()\n    {\n        return this._material.emissive;\n    }\n\n    /**\n     * @method setShading\n     * @param {String} shading one of \"smooth\", \"flat\"\n     */\n    setShading(shading)\n    {\n        this._material.shading = (shading === \"smooth\") ? THREE.SmoothShading : THREE.FlatShading;\n        this._material.needsUpdate = true;\n    }\n    /**\n     * @method setSpecularColor\n     * @param {Color} color\n     */\n    setSpecularColor(color)\n    {\n        this._material.specular = color;\n    }\n\n    /**\n     * @method getSpecularColor\n     * @return {Color}\n     */\n    getSpecularColor()\n    {\n        return this._material.specular;\n    }\n\n    //cf http://blog.cjgammon.com/threejs-custom-shader-material\n    //cf https://threejs.org/docs/index.html#Reference/Materials/ShaderMaterial\n\n    /**\n     * @method setProperty\n     * @param {String} name\n     * @param {Object} value (depending on the property)\n     */\n    setProperty(name, val)\n    {\n        this._material.uniforms[name].value = val;\n    }\n\n    /**\n     * @method setProperty\n     * @param {String} name\n     * @return {Object} value (depending on the property)\n     */\n    getProperty(name)\n    {\n        return this._material.uniforms[name].value;\n    }\n\n    setBlending(blending)\n    {\n        this._material.blending = blending;\n    }\n\n    /**\n     * @method erase\n     */\n    erase()\n    {\n        if(this._material.map)\n        {\n            this._material.map.dispose();\n        }\n        this._material.dispose();\n    }\n\n}\n\n// module exports\nexport { Material };\n","import {Transform} from './Transform';\nimport {getOrDefault, getOrCreate} from '../helpers/Misc';\nimport {Vector3} from '../core/Vector3';\nimport {Rect} from '../core/Rect';\nimport {_Math} from '../helpers/Math';\nimport {debug} from '../helpers/Debug';\n\nclass Camera\n{\n    /**\n     * Camera class. Must be created by the user so that the current scene can be seen.\n     * If no camera is added to the scene, rendering is not done (nothing is seen, so nothing is rendered).\n     *\n     * A Camera contains a transform object to be moved and rotated in space.\n     * Viewport can be defined by the user to create multicam rendering.\n     *\n     * @class Camera\n     * @constructor\n     * @param {Object} params an object containing all the possible parameters for this class. Use it like in the following example. Possible parameters are lisited below.\n     * @example\n     *     //this is how to use a parameters object in order to instanciate a Mobilizing.js object\n     *     var mobilizingObject = new Mobilizing.Class({paramName1: value, paramName2: value});\n     *\n     * @param {Context} [params.context] mobilizing context to use\n     * @param {String} [params.type=\"perspective\"] One of \"perspective\", \"ortho\" or \"cube\"\n     * @param {Number} [params.fov] vertical field of view\n     * @param {Number} [params.cubeResolution=1024] if the type is \"cube\", defines the size of the cubemap, must be a power of 2\n     * @param {Number} [params.near=1] near plane\n     * @param {Number} [params.far=5000] far plane\n     * @param {Rect} [params.viewport=Rect(0,0,1,1)] the Rect defining the viewport in normalize % (0 ~ 1), that is the portion of the rendering canvas to be used as a rendering surface for this camera\n     * @param {Context} [params.layer] the layer in which to render the camera, that is the scene it is\n     * @param {Vector3} [params.position] the position where to create the camera in space\n     * @default Vector(0,0,0)\n     * @param {Number} [params.verticalshift=0] vertical lens shift in %\n     * @param {Number} [params.horizontalshift=0] horizontal lens shift in %\n     * @param {Boolean} [params.autorender=true] Should the camera automatically renders itself or not\n     * @param {Boolean} [params.autoclear=true] Should the camera automatically clears itself or not\n     * @param {Boolean} [params.autoupdatematrix=true] Should the camera transformation matrix automatically updates itself or not\n    */\n\n    constructor(params)\n    {\n        this.context = getOrDefault(params, \"context\", null);\n        this.type = getOrDefault(params, \"type\", \"perspective\");\n        this.fov = getOrDefault(params, \"fov\", 35);\n\n        this.cubeResolution = getOrDefault(params, \"cubeResolution\", 1024);\n\n        this.near = getOrDefault(params, \"near\", 0.1);\n        this.far = getOrDefault(params, \"far\", 5000);\n\n        let position = getOrDefault(params, \"position\", undefined);\n\n        if(this.type === \"perspective\")\n        {\n            if(this.context)\n            {\n                let canvasSize = this.context.getCanvasSize();\n                debug.log(\"camera canvasSize\",canvasSize);\n                this._camera = new THREE.PerspectiveCamera(\n                    this.fov,\n                    (canvasSize.width)/(canvasSize.height),\n                    this.near, this.far );\n            }\n            else\n            {\n                this._camera = new THREE.PerspectiveCamera(\n                    this.fov,\n                    (window.innerWidth)/(window.innerHeight),\n                    this.near, this.far );\n            }\n            debug.log(\"made perspective cam\");\n        }\n        else if(this.type === \"ortho\")\n        {\n            if(this.context)\n            {\n                let canvasSize = this.context.getCanvasSize();\n                this._camera = new THREE.OrthographicCamera(\n                    canvasSize.width/-2,\n                    canvasSize.width/2,\n                    canvasSize.height/2,\n                    canvasSize.height/-2,\n                    this.near, this.far\n                );\n            }\n            else\n            {\n                this._camera = new THREE.OrthographicCamera(\n                    window.innerWidth/-2,\n                    window.innerWidth/2,\n                    window.innerHeight/2,\n                    window.innerHeight/-2,\n                    this.near, this.far\n                );\n            }\n            this._camera.position.z = 400; //default\n            debug.log(\"made ortho cam\");\n        }\n        else if (this.type === \"cube\")\n        {\n            this._camera = new THREE.CubeCamera(0.5, 1000, this.cubeResolution);\n            debug.log(\"made cube cam\");\n        }\n\n        this.transform = new Transform(this/*._camera*/);\n\n        if (position !== undefined)\n        {\n            this.transform.setLocalPosition(position);\n        }\n\n        this.viewport           = getOrCreate(params, \"viewport\", Rect, 0, 0, 1, 1);\n        this.layer              = getOrDefault(params, \"layer\", \"default\");\n        this.verticalshift      = getOrDefault(params, \"verticalshift\", 0);\n        this.horizontalshift    = getOrDefault(params, \"horizontalshift\", 0);\n        this.autorender         = getOrDefault(params, \"autorender\", true);\n        this.autoclear          = getOrDefault(params, \"autoclear\", true);\n        this.autoupdatematrix   = getOrDefault(params, \"autoupdatematrix\", false);\n\n        /**\n         @property dirty\n         @type Boolean flag to know if something has changed\n         @default true\n         */\n        this.dirty = false;\n    }\n\n    /**\n     Set the RenderTexture to render on. By default, the camera renders on the Context canvas.\n\n     @method setRenderTexture\n     @param {RenderTexture} renderTexture Mobilizing.RenderTexture object\n     */\n    setRenderTexture(renderTexture)\n    {\n        this.renderTexture = renderTexture;\n    }\n\n    /**\n     * set the vertical field of view in degrees\n     *\n     * @method setFOV\n     * @param fov {Number} default to 35 degree\n     */\n    setFOV(fov)\n    {\n        this.fov = fov;\n        if(this.type === \"perspective\")\n        {\n            this._camera.fov = this.fov;\n            this.updateProjectionMatrix();\n        }\n    }\n\n    /**\n     * get the vertical field of view in degrees\n     *\n     * @method getFOV returns the value\n     * @return {Number} Field Of View value\n     */\n    getFOV()\n    {\n        return this.fov;\n    }\n\n    /**\n     Set the clear color, which is the color used to paint the backgroud.\n     Note: this is camera independant, each cam on the scene can have a different\n     clear color, or a different background color.\n\n     @method setClearColor\n     @param {Color} Color Mobilizing.Color object\n     */\n    setClearColor(color)\n    {\n        this.clearColor = color;\n    }\n\n    /**\n     Gets the clear color, which is the color used to paint the backgroud.\n     Note: this is camera independant, each cam on the scene can have a different\n     clear color, or a different background color.\n\n     @method getClearColor\n     @return {Color} Color object associated to this clearColor\n     */\n    getClearColor()\n    {\n        return this.clearColor;\n    }\n\n    /**\n     Set the autorender flag, which means that the camera will render itself automatically.\n     @method setAutorender\n     @param {Bool} b flag true/false\n     */\n    setAutorender(b)\n    {\n        this.autorender = b;\n    }\n\n    /**\n    Makes the cam \"looks at\" the argements coordinates. Handy way to orient the cam\n    or to make it follow an object in space.\n\n    @method lookAt\n    @param {Object} Vector3 the coordinates to look at.\n    */\n    lookAt(vec)\n    {\n        //this.camera.up = new Vector3(0,1,0);\n        this._camera.lookAt(vec);\n        //this.camera.updateProjectionMatrix();\n    }\n\n    /**\n    Sets the aspect ratio of the camera view\n\n    @method setAspect\n    @param {Number} the ratio (ex. 4/3)\n    */\n    setAspect(ratio)\n    {\n        this._camera.aspect = ratio;\n        this.updateProjectionMatrix();\n    }\n\n    /**\n     Sets the vertical shift ratio of the camera view\n\n     @method setVerticalShift\n     @param {Number} the ratio (1 -> 100%)\n     */\n    setVerticalShift(ratio)\n    {\n        this.verticalshift = ratio;\n        this.updateProjectionMatrix();\n    }\n\n    /**\n     Sets the horizontal shift ratio of the camera view\n\n     @method setVerticalShift\n     @param {Number} the ratio (1 -> 100%)\n     */\n    setHorizontalShift(ratio)\n    {\n        this.horizontalshift = ratio;\n        this.updateProjectionMatrix();\n    }\n\n\n    updateProjectionMatrix()\n    {\n        //FIXME : this call does an updateProjectionMatrix internally :\n        var w = 1;\n        var h = 1/this._camera.aspect;\n\n        if (this.type !== \"cube\")\n        {\n            if (this.type !== \"ortho\")\n            {\n                this._camera.setViewOffset( w, h, w*this.horizontalshift, h*this.verticalshift, w, h );\n            }\n\n            if (this.autoupdatematrix)\n            {\n                this._camera.updateProjectionMatrix();\n            }\n        }\n\n    }\n\n    /**\n    gets the aspect ratio of the camera view\n\n    @method getAspect\n    @return {Number} cam aspect value\n    */\n    getAspect()\n    {\n        return this._camera.aspect;\n    }\n\n    set aspect(ratio)\n    {\n        this.setAspect(ratio);\n    }\n    get aspect()\n    {\n        this.getAspect();\n    }\n\n    /**\n    Method to recompute the frame of ortho cam. Is used internally for window resizing.\n\n    @method setOrthoPlanes\n    @param {Number} left\n    @param {Number} right\n    @param {Number} top\n    @param {Number} bottom\n    */\n    setOrthoPlanes(left, right, top, bottom)\n    {\n        if(this.type === \"ortho\")\n        {\n            this._camera.left = left;\n            this._camera.right = right;\n            this._camera.top = top;\n            this._camera.bottom = bottom;\n        }\n        else\n        {\n            console.warn(\"setOrthoBounds() can't be used on perspective cams!\");\n        }\n    }\n\n    /**\n    Zoom is for ortho cam and mimics the Z translation of perspective cams.\n    This is expressed like a scale, zoom = 2 will double, .5 make it half.\n\n    @method setZoom\n    @param {Number} zoom value\n    */\n    setZoom(val)\n    {\n        if(this.type === \"ortho\")\n        {\n            this._camera.zoom = val;\n        }\n        else\n        {\n            console.warn(\"setZoom() can't be used on perspective cams!\");\n        }\n    }\n\n    /**\n    Gets current zoom value.\n\n    @method getZoom\n    @return {Number} zoom value\n    */\n    getZoom()\n    {\n        if(this.type === \"ortho\")\n        {\n            return this._camera.zoom;\n        }\n        else\n        {\n            console.warn(\"getZoom() can't be used on perspective cams!\");\n        }\n    }\n\n    set zoom(val)\n    {\n        this.setZoom(val);\n    }\n    get zoom()\n    {\n        this.getZoom();\n    }\n\n    /**\n    Sets cam far plane\n\n    @method setFarPlane\n    @param {Number} far plane value\n    */\n    setFarPlane(far)\n    {\n        if(this.type !== \"cube\")\n        {\n            this._camera.far = far;\n            this.updateProjectionMatrix();\n        }\n        else if (this.type === \"cube\")\n        {\n            this._camera.children.forEach(\n                function(cam)\n                {\n                    cam.far = far;\n                    cam.updateProjectionMatrix();\n                });\n        }\n    }\n    /**\n    Gets cam far plane\n\n    @method getFarPlane\n    @return {Number} far plane value\n    */\n    getFarPlane()\n    {\n        return this._camera.far;\n    }\n\n    set farPlane(val)\n    {\n        this.setFarPlane(val);\n    }\n    get farPlane()\n    {\n        return this.setFarPlane;\n    }\n\n    /**\n    Sets cam near plane\n\n    @method setNearPlane\n    @param {Number} near plane value\n    */\n    setNearPlane(near)\n    {\n        if(this.type !== \"cube\")\n        {\n            this._camera.near = near;\n            this.updateProjectionMatrix();\n        }\n        else if (this.type === \"cube\")\n        {\n\n            this._camera.children.forEach(\n                function(cam)\n                {\n                    cam.near = near;\n                    cam.updateProjectionMatrix();\n                });\n        }\n    }\n    /**\n    Gets cam near plane\n\n    @method getNearPlane\n    @return {Number} far plane value\n    */\n    getNearPlane()\n    {\n        return this._camera.near;\n    }\n\n    set nearPlane(val)\n    {\n        this.setNearPlane(val);\n    }\n    get nearPlane()\n    {\n        return this.getNearPlane();\n    }\n\n    /**\n    Sets cam far and near planes\n\n    @method setPlanes\n    @param {Number} near near plane value\n    @param {Number} far far plane value\n    */\n    setPlanes(near, far)\n    {\n        this._camera.far = far;\n        this._camera.near = near;\n        this.updateProjectionMatrix();\n    }\n\n    /**\n    Tries to adjust the cam z distance so that 1 world unit == 1 screen pixel.\n    Useful to make object move at the mouse or touch position x and y.\n    For perspective cam only.\n\n    @method setToPixel\n    */\n    setToPixel()\n    {\n        if(this.type === \"perspective\")\n        {\n            var newPos;\n\n            if(this.context)\n            {\n                var canvasSize = this.context.getCanvasSize();\n                newPos = new Vector3(\n                    canvasSize.width/2,\n                    -canvasSize.height/2,\n                    1/(2 * Math.tan( (_Math.degToRad(this.fov/2.0) ) / canvasSize.height))\n                );\n            }\n            else\n            {\n                newPos = new Vector3(\n                    window.innerWidth/2,\n                    -window.innerHeight/2,\n                    1/(2 * Math.tan( (_Math.degToRad(this.fov/2.0) ) / window.innerHeight))\n                );\n            }\n            this.transform.setLocalPosition(newPos);\n\n        }\n        else\n        {\n            console.error(\"only perspective camera can be setted to screen pixel z position\");\n        }\n    }\n\n\n    perspectiveOffCenter( left,  right,  bottom,  top,  near,  far)\n    {\n        var x = 2.0 * near / (right - left);\n        var y = 2.0 * near / (top - bottom);\n        var a = (right + left) / (right - left);\n        var b = (top + bottom) / (top - bottom);\n        var c = -(far + near) / (far - near);\n        var d = -(2.0 * far * near) / (far - near);\n        var e = -1.0;\n\n        var m = this._camera.projectionMatrix;\n        m.set(x,0,a,0,0,y,b,0,0,0,c,d,0,0,e,0);\n        /*\n        m.elements[0] = x;\n        m.elements[1] = 0;\n        m.elements[2] = a;\n        m.elements[3] = 0;\n        m.elements[4] = 0;\n        m.elements[5] = y;\n        m.elements[6] = b;\n        m.elements[7] = 0;\n        m.elements[8] = 0;\n        m.elements[9] = 0;\n        m.elements[10] = c;\n        m.elements[11] = d;\n        m.elements[12] = 0;\n        m.elements[13] = 0;\n        m.elements[14] = e;\n        m.elements[15] = 0;\n        */\n\n        /*\n        m[0, 0] = x;\n        m[0, 1] = 0;\n        m[0, 2] = a;\n        m[0, 3] = 0;\n        m[1, 0] = 0;\n        m[1, 1] = y;\n        m[1, 2] = b;\n        m[1, 3] = 0;\n        m[2, 0] = 0;\n        m[2, 1] = 0;\n        m[2, 2] = c;\n        m[2, 3] = d;\n        m[3, 0] = 0;\n        m[3, 1] = 0;\n        m[3, 2] = e;\n        m[3, 3] = 0;\n        */\n    }\n\n}\n\n// module exports\nexport { Camera };\n","import {getOrDefault} from '../helpers/Misc';\nimport {Color} from '../core/Color';\nimport {Transform} from './Transform';\nimport {Vector3} from \"../core/Vector3\";\n\nclass Light\n{\n    /**\n     * Light will enable object to be seen in space. Camera and Light are requiered for a basic scene.\n     *\n     * @class Light\n     * @constructor\n     * @param {Object} params parameters object\n     * @param {String} [params.type:\"point\"] one of \"point\", \"directional\", \"ambient\", \"spot\"\n     * @param {Number} [params.intensity=1]\n     * @param {Number} [params.distance=1000] distance is taken in account only for point lights\n     * @param {Color} [params.color=Color.white]\n     */\n    constructor(params)\n    {\n        this.type = getOrDefault(params, \"type\", \"point\");\n\n        switch (this.type)\n        {\n            case \"point\":\n                this.light = new THREE.PointLight( 0xffffff );\n                this.light.distance = 1000;\n                break;\n\n            case \"directional\":\n                this.light = new THREE.DirectionalLight( 0xffffff );\n                this.light.position.set(1, 1, 1).normalize();\n                break;\n\n            case \"ambient\":\n                this.light = new THREE.AmbientLight( 0x404040 ); // soft white light\n                this.light.position.set(1, 1, 1).normalize();\n                break;\n\n            case \"spot\":\n                this.light = new THREE.SpotLight( 0xffffff );\n                //this.light.position.set(1, 1, 1).normalize();\n                this.target = new THREE.Object3D();\n                this.light.target = this.target;\n                break;\n\n            default:\n                this.light = new THREE.PointLight( 0xffffff );\n                this.type = \"point\";\n        }\n\n\n        this.light.intensity = getOrDefault(params, \"intensity\", 1);\n        this.light.distance = getOrDefault(params, \"distance\", 5000);\n        this.light.color = getOrDefault(params, \"color\", Color.white);\n\n        this.transform = new Transform(this/*.light*/);\n    }\n\n    /**\n    * Sets the light's intensity\n    * @method setIntensity\n    * @param {Object} val\n    */\n    setIntensity(val)\n    {\n        this.light.intensity =  val;\n    }\n\n    /**\n    * Gets the light's intensity\n    * @method getIntensity\n    * @param {Object} val\n    */\n    getIntensity(val)\n    {\n        return this.light.intensity;\n    }\n\n    /**\n    * Sets the light's distance factor\n    * @method setDistance\n    * @param {Number} val\n    */\n    setDistance(val)\n    {\n        if(this.type === \"point\" || this.type === \"spot\" ){\n            this.light.distance =  val;\n        }\n    }\n\n    /**\n    * Gets the light's distance factor\n    * @method getDistance\n    * @return {Number} the light distance factor\n    */\n    getDistance()\n    {\n        return this.light.distance;\n    }\n    /**\n     * setColor\n     * @method setColor\n     * @param {Color} color\n     */\n    setColor(color){\n        this.light.color = color;\n    }\n    /**\n     * getColor\n     * @method getColor\n     * @return {Color} color\n     */\n    getColor(){\n        return this.light.color;//TODO : return a Mobilizing object, not a Three one\n    }\n    /**\n     * Maximum extent of the spotlight, in radians, from its direction. Should be no more than Math.PI/2. The default is Math.PI/3.\n     * @method setAngle\n     * @param {Number} angle the spot angle\n     */\n    setAngle(val)\n    {\n        if(this.type === \"spot\")\n        {\n            this.light.angle = val;\n        }\n    }\n    /**\n     * getAngle\n     * @method getAngle\n     * @return {Number} the angle\n     */\n    getAngle()\n    {\n        return this.light.angle;\n    }\n\n    /**\n    * Position in space to where the spot light points\n    * @method setTargetPosition\n    * @param {Object} x\n    * @param {Object} y\n    * @param {Object} z\n    */\n    setTargetPosition(arg1, arg2, arg3)\n    {\n        if(this.type === \"spot\")\n        {\n            if(arg1 instanceof Vector3)\n            {\n                this.target.position.set(arg1.x, arg1.y, arg1.z);\n                this.target.updateMatrixWorld();\n            }\n            else\n            {\n                this.target.position.set(arg1, arg2, arg3);\n                this.target.updateMatrixWorld();\n            }\n        }\n    }\n    /**\n    * Smoothness of the spot impact shape (makes the light circle blurry)\n    * @method setPenumbra\n    * @param {Object} val between 0 and 1\n    */\n    setPenumbra(val)\n    {\n        this.light.penumbra = val;\n    }\n\n    /**\n     * setCastShadow\n     * @method setCastShadow\n     * @param {Boolean} enabled\n     */\n    setCastShadow(enabled)\n    {\n        this.light.castShadow = enabled;\n    }\n\n    /**\n     * set the Shadow map Size\n     * @method setShadowSize\n     * @param {Number} width\n     * @param {Number} height\n     */\n    setShadowSize(width,height)\n    {\n        this.light.shadow.mapSize.width = width; //shadow map size\n        this.light.shadow.mapSize.height = height; //shadow map size\n    }\n\n    /**\n     * setShadowDistance\n     * @method setShadowDistance\n     * @param {Number} near min shadow distance\n     * @param {Number} far max shadow distance\n     */\n    setShadowDistance(near,far)\n    {\n        this.light.shadow.camera.near = near; //min shadow distance\n        this.light.shadow.camera.far = far; //max shadow distance\n    }\n}\n\n// module exports\nexport { Light };","import * as THREE from 'three';\nimport {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\n\nclass Texture\n{\n    /**\n     * Texture are bitmap pictures loaded in the graphic card memory so they can be mapped on a geometry surface. Usually, texture are mapped through a Material. Keep in mind that WebGL, as an impletation of OpenGL, shares the same kind of limitations : textures sources should be power of 2 (even if here, Three.js is doing the job of resizing for you if they're not).\n     * Constants list for possible texture's mapping mode :\n     * \n     * Texture.UVMapping\n     * Texture.CubeReflectionMapping\n     * Texture.CubeRefractionMapping\n     * Texture.EquirectangularReflectionMapping\n     * Texture.EquirectangularRefractionMapping\n     * Texture.SphericalReflectionMapping\n     * Texture.CubeUVReflectionMapping\n     * Texture.CubeUVRefractionMapping\n     *\n     * @class Texture\n     * @constructor\n     * @param {Object} params\n     * @param {Context} params.image the Image object.\n     * @param {String} params.canvas the canvas object url.\n     */\n    constructor(params)\n    {\n        this._texture;\n        this._image = getOrDefault(params, \"image\", undefined);\n        this._canvas = getOrDefault(params, \"canvas\", undefined);\n\n        if(this._image){\n            this.fromImage(this._image);\n        }else if(this._canvas){\n            this.fromCanvas(this._canvas);\n        }\n    }\n\n    /**\n    * Create the texture from an image file\n    *\n    * @method fromImage\n    * @param {Image} image tells if the loader should force the main process to wait for the end of \n    */\n    fromImage(image){\n\n        this._texture = new THREE.Texture(image);\n        this._texture.needsUpdate = true;\n\n        this.width = image.width;\n        this.height = image.height;\n    }\n\n    /**\n     * Create the texture from a Canvas DOM element (can be Mobilizing itself -> when we'll can catch a WebGL canvas pixels...)\n     *\n     * @method fromCanvas\n     * @param {canvas} canvas canvas\n     */\n    fromCanvas(canvas)\n    {\n        this._texture = new THREE.Texture(canvas);\n        this._texture.needsUpdate = true;\n        this._texture.magFilter = THREE.LinearFilter;\n        //this._texture.minFilter = THREE.LinearMipMapLinearFilter;\n        this._texture.minFilter = THREE.LinearFilter;\n        this.width = this._texture.image.width;\n        this.height = this._texture.image.height;\n\n        //custom events management, used internally to autamatically refresh texture after drawn\n        if(canvas.events)\n        {\n            canvas.events.on(\"drawn\", () => { this.setNeedsUpdate(true); });\n        }\n    }\n\n    /**\n    * Clears the underlying Three.js texture object\n    * @method dispose\n    */\n    dispose()\n    {\n        this._texture.dispose();    \n    }\n\n    /**\n    * Define the repetition factor of this texture. If the value is > 1, then the texture will be mapped twice on the surface and so on. NB: usage of this method automatically sets the wrapS and wrapT properties to RepeatWrapping\n    * \n    * @method setRepeat\n    * @param {float} u the new u texture coordinate repetition to use\n    * @param {float} v the new u texture coordinate repetition to use\n    */\n    setRepeat(u,v)\n    {\n        if(this._texture && this._texture !== undefined){\n            this._texture.repeat.set( u, v );\n            this._texture.wrapS = THREE.RepeatWrapping;\n            this._texture.wrapT = THREE.RepeatWrapping;\n        }\n    }\n\n    /**\n    * How much a single repetition of the texture is offset from the beginning, in each direction U and V. Typical range is 0.0 to 1.0.\n    * \n    * @method undefined\n    * @param {Numbe} val offset between 0.0 to 1.0\n    */\n    setOffset(val)\n    {\n        this._texture.offset = val;\n    }\n\n    //TODO : setter and getter for Three.js texture props mapping\n\n    /**\n    * Set this to true to trigger an update next time the texture is used. Particularly important for setting the wrap mode.\n    * \n    * @method setNeedsUpdate\n    * @param {Boolean} val\n    */\n    setNeedsUpdate()\n    {\n        this._texture.needsUpdate = true;\n    }\n\n    /**\n    * False by default, which is the norm for PNG images. Set to true if the RGB values have been stored premultiplied by alpha.\n    * \n    * @method setPremultiplyAlpha\n    * @param {Boolean} val\n    */\n    setPremultiplyAlpha(val)\n    {\n        this._texture.premultiplyAlpha = val;\n    }\n\n    /**\n    * How the image is applied to the object. An object type of Texture.UVMapping is the default, where the U,V coordinates are used to apply the map.\n    *\n    * @property setMapping\n    * @param {Number} mapping \n    */\n    setMapping(mapping)\n    {\n        this._texture.mapping = mapping;\n    }\n\n}\n\nTexture.UVMapping = THREE.UVMapping;\nTexture.CubeReflectionMapping = THREE.CubeReflectionMapping;\nTexture.CubeRefractionMapping = THREE.CubeRefractionMapping;\nTexture.EquirectangularReflectionMapping = THREE.EquirectangularReflectionMapping;\nTexture.EquirectangularRefractionMapping = THREE.EquirectangularRefractionMapping;\nTexture.SphericalReflectionMapping = THREE.SphericalReflectionMapping;\nTexture.CubeUVReflectionMapping = THREE.CubeUVReflectionMapping;\nTexture.CubeUVRefractionMapping = THREE.CubeUVRefractionMapping;\n\n// module exports\nexport { Texture };","import * as THREE from 'three';\nimport {getOrDefault, getOrCreate} from '../helpers/Misc';\nimport {Material} from '../scene/Material';\nimport {Color} from '../core/Color';\nimport {Transform} from '../scene/Transform';\nimport {Texture} from '../texture/Texture';\nimport {debug} from '../helpers/Debug';\nimport {Base} from '../Base';\nimport {Mesh} from './Mesh';\n\nclass Label extends Base\n{\n    /*\n    * Label class\n    * A Label is a textured, quad shaped object to be used in Graphical User Interfaces.\n    * A Label can contains a background (color or existing picture) and/or a prerendered text.\n    *\n    * @class Label\n    * @constructor\n    * @param {Object} params Config parameters\n    * @param {String} params.text the String to display\n    * @param {Font} params.font font Mobilizing.Font object\n    * @param {Number} [params.fontSize = 72] fontSize font size\n    * @param {Number} [params.lineMaxCharCount = 40] lineMaxCharCount the maximum number of characters a line should count\n    * @param {Color} [params.color = Color.white] color the text color\n    * @param {Color} params.backgroundColor backgroundColor backgroundColor of the text\n    * @param {Texture} params.texture texture the texture to use fo this label (will cancel the text setting, only the texture will be rendered)\n    * @param {Number} [params.width = 100] width of the label\n    * @param {Number} [params.height = 100] height of the label\n    * \n    * @example\n    *    //TODO\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this.setName( getOrDefault(params, \"name\", undefined) );\n\n        this.font = getOrDefault(params, \"font\", null);//TODO default font!\n        this.material = getOrDefault(params, \"material\", \"basic\");\n\n        this._text = getOrDefault(params, \"text\", \"\");\n        this._lineMaxCharCount = getOrDefault(params, \"lineMaxCharCount\", 40);\n\n        this.style = new Style();\n\n        this._width = getOrDefault(params, \"width\", 100);\n        this._height = getOrDefault(params, \"height\", 100);\n        this.style.color = getOrDefault(params, \"color\", Color.white);\n\n        this.style.fontSize = getOrDefault(params, \"fontSize\", 72);\n        this.style.textAlign = getOrDefault(params, \"textAlign\", \"center\");\n\n        /*this._geometry = new THREE.PlaneBufferGeometry(1,1);\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );*/\n\n        this.mesh = new Mesh({primitive: \"plane\", width: 1, height:1, material:this.material});\n        \n        if (params.backgroundColor !== undefined)\n        {\n            this.style.hasBackground = true;\n            this.style.backgroundColor = params.backgroundColor;\n        }\n        else\n        {\n            this.style.hasBackground = false;\n        }\n\n        this.transform = new Transform(this/*.mesh*/);\n        this.transform.setLocalScale(this._width,this._height);\n        this.needsComputeTextSize = true;//What's this ?\n\n        this.precLine = getOrDefault(params, \"precLine\", \"\");// ajout ST\n\n        this._textSize = 0;//will be computed on render\n\n        if (params.texture !== undefined)\n        {\n            this.material.setTexture(params.texture);\n            this.transform.setLocalScale(params.width,params.height,1);\n        }\n        else\n        {\n            this.render();\n        }\n    }\n\n    /**\n    * set the width of this label.  Will be used by render()\n    * @method setWidth\n    * @param {Number} val the new width\n    */\n    setWidth(val)\n    {\n        this._width = val;\n    }\n\n    /**\n    * set the height of this label.  Will be used by render()\n    * @method setHeight\n    * @param {Number} val the new height\n    */\n    setHeight(val)\n    {\n        this._height = val;\n    }\n\n    /**\n    * set the Label background texture.\n    * @method setBackgroundTexture\n    * @param {Object} texture Texture to set as the Label background.\n    */\n    setBackgroundTexture(texture)\n    {\n        this.style.backgroundTexture = texture;\n    }\n\n    /**\n    * set the Label text content.\n    * @method setText\n    * @param {String} val text to be used as the Label content.\n    */\n    setText(val)\n    {\n        this._text = val;\n        this.render();\n    }\n\n    /**\n    * @deprecated\n    * @method setNeedsComputeTextSize\n    * @param {Object} val\n    */\n    setNeedsComputeTextSize(val)\n    {\n        this.needsComputeTextSize = val;\n    }\n\n    /**\n    * Set the current Label underlying canvas to use this color for the shadowblur effect\n    * @method setShadowColor\n    * @param {Color} color Mobilizing.Color object\n    */\n    setShadowColor(color){\n        this.shadowColor = \"rgba(\"+color.r+\",\"+color.g+\",\"+color.b+\",1)\";\n    }\n    /**\n    * Description for undefined\n    * @method setShadowBlur\n    * @param {Number} val\n    */\n    setShadowBlur(val){\n        this.shadowBlur = val;\n    }\n\n    /**\n    * Renders the label once all the setting are done. Should be called by the user when label properties are modified\n    * @method render\n    */\n    render()\n    {\n        //debug.log(\"render label\");\n        if (this._text === undefined)\n        {\n            this._text = \"\";\n        }\n        if (this._canvas === undefined)\n        {\n            this._canvas = document.createElement('canvas');\n            this._canvas.retinaResolutionEnabled = false; //to disable Retina canvas in Ejecta\n            //document.body.appendChild(this._canvas);\n        }\n        if (this._width > 2048)\n        {\n            this._width = 2048;\n        }\n        if (this._height > 2048)\n        {\n            this._height = 2048;\n        }\n        this._canvas.width = this._width;\n        this._canvas.height = this._height;\n\n        //this.transform.setLocalScale(this._width,this._height);\n\n        var context = this._canvas.getContext('2d');\n\n        context.fillStyle = this.style.backgroundColor.makeRGBAStringWithAlpha(this.style.backgroundColorAlpha);\n        context.shadowColor = this.shadowColor;\n        context.shadowBlur = this.shadowBlur;\n\n        if (this.style.backgroundTexture !== undefined)\n        {\n            //debug.log(this.style.backgroundTexture);\n            context.drawImage(this.style.backgroundTexture.texture.image, 0, 0, this._width, this._height);\n        }\n        else if (this.style.hasBackground)\n        {\n            context.fillRect(0,0,this._canvas.width, this._canvas.height);\n        }\n        else\n        {\n            context.clearRect ( 0 , 0 , this._canvas.width, this._canvas.height );\n        }\n\n        if (this.font !== undefined && this.font !== null)\n        {\n            debug.log(\"render label with font\",this.font);\n            var finaltext = \"\";//this._text;\n            //var words = this._text.split(\" \");\n            //césure automatique\n            var l = 0;\n            //var lastcesure = 0;\n            var word = \"\";\n            var ll = 0;\n            var first = true;\n\n            var SpaceLeft = this._lineMaxCharCount;\n            for (var j=0;j<this._text.length;++j)\n            {\n                var c = this._text[j];\n\n                if (c === '\\n' || c === ' ')\n                {\n                    if ((word.length+1) > SpaceLeft)\n                    {\n                        //debug.log(\"overflow detected, adding backslash then \" + word);\n                        //debug.log(\"BACKSLASH \" + word);\n                        finaltext += \"\\n\";\n                        finaltext += (word + \" \");\n                        SpaceLeft = this._lineMaxCharCount - (word.length+1);\n                        //word = \"\";\n                        if (c === '\\n')\n                        {\n                            finaltext += \"\\n\";\n                            SpaceLeft = this._lineMaxCharCount;\n                        }\n                    }\n                    else if (c === '\\n')\n                    {\n                        //debug.log(\"BACKSLASH detected, adding \" + word + \" then backslash\");\n                        finaltext += (word);\n                        //debug.log(word + \" BACKSLASH\");\n                        finaltext += \"\\n\";\n                        SpaceLeft = this._lineMaxCharCount;\n                        //word = \"\";\n                    }\n                    else\n                    {\n                        //debug.log(\"common case, adding \" + word + \" then space\");\n                        finaltext += (word + \" \");\n                        SpaceLeft = SpaceLeft - (word.length + 1);\n                        //word = \"\";\n                    }\n                    word = \"\";\n                }\n                else //lettre normale\n                {\n                    word += c;\n                }\n\n            }\n\n            if ((word.length+1) > SpaceLeft)\n            {\n                //debug.log(\"BACKSLASH \" + word);\n                finaltext += '\\n';\n            }\n            finaltext += word; //last word\n\n            var strings = finaltext.split(\"\\n\");\n\n            var x = 0;\n            var y = 0;\n\n            var path ;\n            if (strings.length === 0)\n            {\n                strings.push(finaltext);\n                // ajout sylvie\n                this.lastLine = finaltext;\n            }else{\n                this.lastLine = strings[strings.length-1];\n            }\n            this.nbLines = strings.length;\n\n            for (var k in strings)\n            {\n                var s = strings[k];\n                //debug.log(s);\n                if(this.needsComputeTextSize)\n                {\n                    this._textSize = this.font.getTextSize(s, this.style.fontSize);\n\n                    if(this.style.textAlign === \"center\")\n                    {\n                        x = this._width/2 - this._textSize.width/2;\n                    }\n                    else if(this.style.textAlign === \"end\" || this.style.textAlign === \"right\")\n                    {\n                        x = this._width - this._textSize.width;\n                    }\n                    else if(this.style.textAlign === \"left\" || this.style.textAlign === \"start\")\n                    {\n                        // ajout sylvie\n                        if(k === 0){\n                            //console.log(this.precLine)\n                            x = this.font.getTextSize(this.precLine, this.style.fontSize).width + this.style.textHorizontalMargin;\n                            //x = 0 + this.style.textHorizontalMargin;\n                        }else{\n                            x = 0 + this.style.textHorizontalMargin;\n                        }\n                    }\n                    var offset = 0;\n                    if(this.style.textVerticalAlign === \"center\")\n                    {\n                        if (strings.length > 1)\n                        {\n                            offset = k-(strings.length-1)/2;\n                        }\n                        y = this._height/2 + this._textSize.height/2 + offset * this.style.fontSize;\n                    }\n                    else if(this.style.textVerticalAlign === \"top\")\n                    {\n                        offset = k;\n                        y =  this.style.fontSize + offset * this.style.fontSize + this.style.textVerticalMargin;\n                    }\n                    else if(this.style.textVerticalAlign === \"bottom\")\n                    {\n                        //TO DO !!!!\n                        offset = k;\n                        y =  offset * this.style.fontSize;\n                    }\n\n                    //position du curseur\n                    this.cursorx = x+this._textSize.width;\n                    this.cursory = y;//+this._textSize.height/2;\n                }\n                path = this.font.getFont().getPath(s, x, y, this.style.fontSize);\n                //context.globalAlpha = this.style.colorAlpha;\n                path.fill = \"#\"+this.style.color.getHexString();\n                path.draw(context);\n\n            }\n\n        }\n        if(!this._texture)\n        {\n            this._texture = new Texture({canvas:this._canvas});\n        }else{\n            this._texture.dispose();\n        }\n\n        this._texture.fromCanvas(this._canvas);\n\n        this.mesh.material.setTexture(this._texture);\n    }\n\n    /**\n    Creates a text Label.\n    @method createTextLabel\n    @static\n    @deprecated\n    @param {String} text text to render on the Label.\n    @param {Object} font Font object.\n    @param {Number} fontSize The font Size (in pixels).\n    @param {String} align the text alignment (\"center\", \"end\", \"left\", \"right\", \"start\").\n    @param {Number} width Label width in pixels.\n    @param {Number} height Label height in pixels.\n    @param {Color} color the Label text color.\n    @param {Color} backgroundColor the background color.\n    @param {Texture} texture the background Texture.\n     */\n    createTextLabel(text, font, fontSize, align, width, height, color, backgroundColor, texture)\n    {\n        var labelTest = new Label(text, font, width, height);\n        labelTest.style.fontSize    = fontSize;\n        labelTest.style.color       = color;\n        if (backgroundColor !== undefined)\n        {\n            labelTest.style.hasBackground = true;\n            labelTest.style.backgroundColor = backgroundColor;\n        }\n        else\n        {\n            labelTest.style.hasBackground = false;\n        }\n        labelTest.style.textAlign = align;//\"center|end|left|right|start\"\n        if (texture !== undefined)\n        {\n            labelTest.material.setTexture(texture);\n            labelTest.transform.setLocalScale(width,height,1);\n        }\n        else\n        {\n            labelTest.render();\n        }\n        return labelTest;\n    }\n}\n\n// module exports\nexport { Label };\n","import {Mesh} from '../shape/Mesh';\nimport {Camera} from './Camera';\nimport {Light} from './Light';\nimport {Label} from '../shape/Label';\nimport {Quaternion} from '../core/Quaternion';\nimport {Matrix4} from '../core/Matrix4';\nimport {_Math} from '../helpers/Math';\nimport {Vector3} from '../core/Vector3';\nimport {Vector2} from '../core/Vector2';\nimport {debug} from '../helpers/Debug';\n\nclass Transform\n{\n\n    /**\n     Transform class is meant to be aggregated to any object that needs to be transformed in space.\n     {{#crossLink \"Mesh\"}}{{/crossLink}}, {{#crossLink \"Light\"}}{{/crossLink}} or {{#crossLink \"Camera\"}}{{/crossLink}} contains a transform instance.\n\n     @class Transform\n     @constructor\n     @uses {Math}\n    */\n    constructor(obj)\n    {\n        this.mobObject = obj;//used in children array to avoid confusion between three and mob objects\n        \n        if(obj instanceof Mesh){\n            this.entity = obj.mesh;\n        }else if(obj instanceof Camera){\n            this.entity = obj._camera;\n        }else if(obj instanceof Light){\n            this.entity = obj.light;\n        }else if(obj instanceof Label){\n            this.entity = obj.mesh.mesh;\n        }\n\n        this.children = [];\n    }\n\n    /**\n    * Geneates a transform to point at a certain coordinates, makes the object \"look at\" this point.\n    * @method lookAt\n    * @param {Vector} vector\n    */\n    lookAt(vector){\n        this.entity.lookAt(vector);\n    }\n\n    /**\n    Set the object rotation with a quarternion {x,y,z,w}.\n\n    @method setLocalQuaternion\n    @param {Quaternion} quarternion The quaternion to apply\n    */\n    setLocalQuaternion(q){\n\n        if(q instanceof Quaternion){\n            this.entity.quaternion.set(q.x, q.y, q.z, q.w);\n        }\n\n    }\n\n    /**\n    Get the object rotation as a quarternion.\n\n    @method getLocalQuaternion\n    @return {Quaternion} quarternion\n    */\n    getLocalQuaternion(){\n        var temp = new Quaternion(this.entity.quaternion.x,\n                                  this.entity.quaternion.y,\n                                  this.entity.quaternion.z,\n                                  this.entity.quaternion.w\n                                 );\n        return temp;\n    }\n\n\n    setLocalMatrix(m) {\n\n        this.entity.matrixAutoUpdate = false;\n\n        var mat = new Matrix4().multiplyMatrices(this.entity.matrix, m);\n        this.entity.applyMatrix(mat);\n        this.entity.updateMatrix();\n    }\n\n    //not documented - use setRotation\n    setLocalEulerAngles(arg1, arg2, arg3)\n    {\n        if(arguments.length === 3)//x,y,z float\n        {\n            this.entity.rotation.x = _Math.degToRad(arg1);\n            this.entity.rotation.y = _Math.degToRad(arg2);\n            this.entity.rotation.z = _Math.degToRad(arg3);\n\n        }\n        else if(arguments.length === 2)\n        {\n            if(typeof arg1 === \"number\" && typeof arg2 === \"number\")\n            {\n                this.entity.rotation.x = _Math.degToRad(arg1);\n                this.entity.rotation.y = _Math.degToRad(arg2);\n            }\n\n        }\n        else if(arguments.length === 1)//direct vector or single float\n        {\n            if(arg1 instanceof Vector3)\n            {\n                this.entity.rotation.x = _Math.degToRad(arg1.x);\n                this.entity.rotation.y = _Math.degToRad(arg1.y);\n                this.entity.rotation.z = _Math.degToRad(arg1.z);\n            }\n            if(arg1 instanceof Vector2)\n            {\n                this.entity.rotation.x = _Math.degToRad(arg1.x);\n                this.entity.rotation.y = _Math.degToRad(arg1.y);\n            }\n            else if(typeof arg1 === \"number\")\n            {\n                this.entity.rotation.z = _Math.degToRad(arg1);\n            }\n        }\n    }\n\n    //not documented - use getRotation\n    getLocalEulerAngles()\n    {\n        return new Vector3(_Math.radToDeg(this.entity.rotation.x) % 360,\n                           _Math.radToDeg(this.entity.rotation.y) % 360,\n                           _Math.radToDeg(this.entity.rotation.z) % 360\n                          );\n    }\n\n    /**\n     Set the euler angles rotation in degrees.\n    Polymorphic : can take various agruments of various types. Possible arguments number is 1, 2 or 3.\n\n     @method setLocalRotation\n     @param {float|Vector3|Vector2} number|Vector3|Vector2 Value for the new rotation of the transform. If a Vector3 is given, its x, y, z will be used for the rotation x, y, z. If a Vector2 is given, its x, y will be used for the rotation x and y, but z will be unchanged. If a number is given, it will be the position x.\n    @param {float} Number Value for the new y rotation of the transform.\n    @param {float} Number Value for the new z rotation of the transform.\n     */\n    setLocalRotation()\n    {\n        this.setLocalEulerAngles.apply(this, arguments);\n    }\n\n    /**\n    * Sets this transform's x rotation\n    *\n    * @method setLocalRotationX\n    * @param {Number} arg\n    */\n    setLocalRotationX(arg)\n    {\n        if(typeof arg === \"number\")\n        {\n            this.entity.rotation.x = _Math.degToRad(arg);\n        }\n    }\n    /**\n    * Sets this transform's y rotation\n    *\n    * @method setLocalRotationY\n    * @param {Number} arg\n    */\n    setLocalRotationY(arg)\n    {\n        if(typeof arg === \"number\")\n        {\n            this.entity.rotation.y = _Math.degToRad(arg);\n        }\n    }\n    /**\n    * Sets this transform's z rotation\n    *\n    * @method setLocalRotationZ\n    * @param {Number} arg\n    */\n    setLocalRotationZ(arg)\n    {\n        if(typeof arg === \"number\")\n        {\n            this.entity.rotation.z = _Math.degToRad(arg);\n        }\n    }\n\n    /**\n     * Get the current local rotation of this transform\n     *\n     * @method getLocalRotation\n     * @return {Vector3} localRotation vector\n    */\n    getLocalRotation()\n    {\n        return this.getLocalEulerAngles();\n    }\n\n    /**\n     * Get the current x local rotation of this transform\n     *\n     * @method getLocalRotationX\n     * @return {Number} localRotation x value\n    */\n    getLocalRotationX()\n    {\n        return this.getLocalEulerAngles().x;\n    }\n\n    /**\n     * Get the current y local rotation of this transform\n     *\n     * @method getLocalRotationY\n     * @return {Number} localRotation y value\n    */\n    getLocalRotationY()\n    {\n        return this.getLocalEulerAngles().y;\n    }\n\n    /**\n     * Get the current z local rotation of this transform\n     *\n     * @method getLocalRotationZ\n     * @return {Number} localRotation z value\n    */\n    getLocalRotationZ()\n    {\n        return this.getLocalEulerAngles().z;\n    }\n\n    /**\n     Set the local position of the transform (and to the object attach to it).\n     Polymorphic : can take various agruments of various types. Possible arguments number is 1, 2 or 3.\n\n     @method setLocalPosition\n     @param {float|Vector3|Vector2} number|Vector3|Vector2 Value for the new position of the transform. If a Vector3 is given, its x, y, z will be used for the position x, y, z. If a Vector2 is given, its x, y will be used for the position x and y, but z will be unchanged. If a number is given, it will be the position x.\n    @param {float} Number Value for the new y position of the transform.\n    @param {float} Number Value for the new z position of the transform.\n     */\n    setLocalPosition(arg1, arg2, arg3)\n    {\n        if(arguments.length === 3){//x,y,z float\n\n            this.entity.position.x = arg1;\n            this.entity.position.y = arg2;\n            this.entity.position.z = arg3;\n\n        }else if(arguments.length === 2){\n\n            if(typeof arg1 === \"number\" && typeof arg2 === \"number\"){\n                this.entity.position.x = arg1;\n                this.entity.position.y = arg2;\n            }\n\n        }else if(arguments.length === 1){//direct vector\n\n            if(arg1 instanceof Vector3){\n\n                this.entity.position.x = arg1.x;\n                this.entity.position.y = arg1.y;\n                this.entity.position.z = arg1.z;\n\n            }else if(arg1 instanceof Vector2){\n\n                this.entity.position.x = arg1.x;\n                this.entity.position.y = arg1.y;\n\n            }else if(typeof arg1 === \"number\"){\n                this.entity.position.x = arg1;\n                this.entity.position.y = arg1;\n                this.entity.position.z = arg1;\n            }\n        }\n    }\n\n    /**\n    * Sets this transform's x position\n    *\n    * @method setLocalPositionX\n    * @param {Number} arg\n    */\n    setLocalPositionX(arg)\n    {\n        if(typeof arg === \"number\"){\n            this.entity.position.x = arg;\n        }\n    }\n    /**\n    * Sets this transform's y position\n    *\n    * @method setLocalPositionY\n    * @param {Number} arg\n    */\n    setLocalPositionY(arg)\n    {\n        if(typeof arg === \"number\"){\n            this.entity.position.y = arg;\n        }\n    }\n    /**\n    * Sets this transform's z position\n    *\n    * @method setLocalPositionZ\n    * @param {Number} arg\n    */\n    setLocalPositionZ(arg)\n    {\n        if(typeof arg === \"number\"){\n            this.entity.position.z = arg;\n        }\n    }\n\n    /**\n    Gets the local position of this transform\n\n    @method getLocalPosition\n    @return {Vector3} localPosition vector\n    */\n    getLocalPosition()\n    {\n        var tempVec = new Vector3(this.entity.position.x,\n                                  this.entity.position.y,\n                                  this.entity.position.z);\n        return tempVec;\n    }\n\n    /**\n    Gets the local x position of this transform\n\n    @method getLocalPositionX\n    @return {Number} localPosition x\n    */\n    getLocalPositionX()\n    {\n        var tempVec = this.entity.position.x;\n        return tempVec;\n    }\n\n    /**\n    Gets the local x position of this transform\n\n    @method getLocalPositionY\n    @return {Number} localPosition y\n    */\n    getLocalPositionY()\n    {\n        var tempVec = this.entity.position.y;\n        return tempVec;\n    }\n\n    /**\n    Gets the local z position of this transform\n\n    @method getLocalPositionZ\n    @return {Number} localPosition z\n    */\n    getLocalPositionZ()\n    {\n        var tempVec = this.entity.position.z;\n        return tempVec;\n    }\n\n    /**\n\n    @method getWorldPosition\n    @return {Vector3} worlPosition vector of the object\n    */\n    getWorldPosition()\n    {\n        var vector = new Vector3();\n        vector.setFromMatrixPosition( this.entity.matrixWorld );\n        return vector;\n    }\n\n    /**\n    Set the scale of the transform.\n    Polymorphic : can take various agruments of various types. Possible arguments number is 1, 2 or 3.\n\n    @method setLocalScale\n    @param {float|Vector3|Vector2} number|Vector3|Vector2 Value for the new scale. If a Vector3 is given, its x, y, z will be used for the scale x, y, z. If a Vector2 is given, its x, y will be used for the scale x and y, but z will be 1. If a number is given, it will be the scale x.\n    @param {float} Number Value for the new y scale.\n    @param {float} Number Value for the new z scale.\n    */\n    setLocalScale(arg1, arg2, arg3)\n    {\n        if(arguments.length === 3)\n        {\n            this.entity.scale.x = arg1;\n            this.entity.scale.y = arg2;\n            this.entity.scale.z = arg3;\n        }\n        else if(arguments.length === 2)\n        {\n            if(typeof arg1 === \"number\" && typeof arg2 === \"number\")\n            {\n                this.entity.scale.x = arg1;\n                this.entity.scale.y = arg2;\n            }\n        }\n        else if(arguments.length === 1)\n        {\n            if(arg1 instanceof Vector3)\n            {\n                this.entity.scale.x = arg1.x;\n                this.entity.scale.y = arg1.y;\n                this.entity.scale.z = arg1.z;\n            }\n            else if(arg1 instanceof Vector2)\n            {\n                this.entity.scale.x = arg1.x;\n                this.entity.scale.y = arg1.y;\n            }\n            else if\n                (typeof arg1 === \"number\")\n            {\n                this.entity.scale.x = arg1;\n                this.entity.scale.y = arg1;\n                this.entity.scale.z = arg1;\n            }\n        }\n    }\n\n    /**\n    * Sets this transform's x scale\n    *\n    * @method setLocalScaleX\n    * @param {Number} arg\n    */\n    setLocalScaleX(arg)\n    {\n        if(typeof arg === \"number\")\n        {\n            this.entity.scale.x = arg;\n        }\n    }\n    /**\n    * Sets this transform's y scale\n    *\n    * @method setLocalScaleY\n    * @param {Number} arg\n    */\n    setLocalScaleY(arg)\n    {\n        if(typeof arg === \"number\")\n        {\n            this.entity.scale.y = arg;\n        }\n    }\n    /**\n    * Sets this transform's z scale\n    *\n    * @method setLocalScaleZ\n    * @param {Number} arg\n    */\n    setLocalScaleZ(arg)\n    {\n        if(typeof arg === \"number\")\n        {\n            this.entity.scale.z = arg;\n        }\n    }\n\n    /**\n\n    @method getLocalScale\n    @return {Vector3} localScale vector\n    */\n    getLocalScale()\n    {\n        var temp = new Vector3(this.entity.scale.x,\n                               this.entity.scale.y,\n                               this.entity.scale.z\n                              );\n        return temp;\n    }\n\n    /**\n    @method getLocalScaleX\n    @return {Number} localScale x\n    */\n    getLocalScaleX()\n    {\n        var temp = this.entity.scale.x;\n        return temp;\n    }\n\n    /**\n    @method getLocalScaleY\n    @return {Number} localScale y\n    */\n    getLocalScaleY()\n    {\n        var temp = this.entity.scale.y;\n        return temp;\n    }\n\n    /**\n    @method getLocalScaleZ\n    @return {Number} localScale z\n    */\n    getLocalScaleZ()\n    {\n        var temp = this.entity.scale.z;\n        return temp;\n    }\n\n    /**\n     * Perform a RayCast picking\n     *\n     * @method pick\n     * @param {Camera} cam The camera to use as a ray caster.\n     * @param {number} x The x coordinate in screen space for the ray casting\n     * @param {number} y The y coordinate in screen space for the ray casting\n     * @return {Object} if picking success, gives an object as {point:{x,y,z}, uv:{u,v}, distance:dist}, null otherwise.\n     */\n    pick(cam, x,y)\n    {\n        var targetList = [];\n        targetList.push(this.entity);\n\n        //FIXME : will bug with non fullscreen configuration!!!\n        //IDEA : use the context referenced in the cam to grab the canvas!\n        var nx = 0;\n        var ny = 0;\n\n        if(cam.context)\n        {\n            var canvas = cam.context.getCanvasSize();\n            nx = ( x / canvas.width ) * 2 - 1;\n            ny = - ( y / canvas.height ) * 2 + 1;\n        }\n        else\n        {\n            nx = ( x / window.innerWidth ) * 2 - 1;\n            ny = - ( y / window.innerHeight ) * 2 + 1;\n        }\n        // create a Ray with origin at the mouse position\n        //and direction into the scene (camera direction)\n\n        var raycaster = new THREE.Raycaster(); // create once\n\n        var vector = new THREE.Vector3( nx, ny, 1 );\n        var camera = cam.transform.entity;\n\n        var ray = raycaster.setFromCamera( vector, camera );\n\n        var intersects = raycaster.intersectObjects( [this.entity] );\n\n        //debug.log(\"intersects\",nx,ny, intersects);\n        // if there is one (or more) intersections\n        if ( intersects.length > 0 )\n        {\n            let temp = {};\n            temp.point = intersects[0].point;\n            temp.uv = intersects[0].uv;\n            temp.distance = intersects[0].distance;\n            return temp;\n        }\n        else // there are no intersections\n        {\n            return null;\n        }\n    }\n\n    /**\n    * Return a Vector2 giving the screen coordinates of the object\n    * @method getScreenCoordinates\n    * @param {Context} context the current Mobilizing context\n    * @param {Camera} camera the Camera to use for the projection\n    * @return {Vector2} the screen coordinates of the object\n    */\n    getScreenCoordinates(context, camera)\n    {\n        if(camera.type === \"perspective\")\n        {\n            var vector = new Vector3();\n\n            // TODO: need to update this when resize window\n            var widthHalf = 0.5 * context.getCanvasSize().width * camera.viewport.width;\n            var heightHalf = 0.5 * context.getCanvasSize().height * camera.viewport.height;\n\n            this.entity.updateMatrixWorld();\n            vector.setFromMatrixPosition(this.entity.matrixWorld);\n            vector.project(camera.camera);\n\n            vector.x = ( vector.x * widthHalf ) + widthHalf;\n            vector.y = -( vector.y * heightHalf ) + heightHalf;\n\n            return {x: vector.x,\n                    y: vector.y };\n        }\n\n    }\n\n    /**\n    * Adds a child to this transform (argument must be a transform too)\n    *\n    * @method addChild\n    * @param {Transform} child\n    */\n    addChild(child)\n    {\n        this.children.push(child.mobObject);\n        this.entity.add(child.entity);\n    }\n\n    /**\n    * Removes a child from the children chain\n    *\n    * @method removeChild\n    * @param {Object} child\n    */\n    removeChild(child)\n    {\n        this.children.splice( this.children.indexOf(child),1);\n        this.entity.remove(child.entity);\n    }\n\n    /**\n    * Gets an array containning all the children objects of this transform\n    *\n    * @method getChildren\n    * @return {Array}\n    */\n    getChildren(){\n        return this.children;\n    }\n\n    /**\n    * Gets one of all the children objects of this transform\n    *\n    * @method getChild\n    * @param {Number} index Index of the child to get\n    * @return {Object}\n    */\n    getChild(index){\n        return this.children[index];\n    }\n\n    /**\n    * Sets the render order of this object. The sortObjects of the renderer should be true for this property to have any effect.\n    *\n    * @method setRenderOrder\n    */\n    setRenderOrder(val){\n        this.entity.renderOrder = val;\n    }\n\n    /*====================\n    * deprecated methods!\n    * ====================*/\n\n    //what to do here ? Let it in tranform and Mesh or choose one of them ?\n    setVisible(visible)\n    {\n        this.entity.visible = visible;\n    }\n\n    getVisible()\n    {\n        return this.entity.visible;\n    }\n\n}\n\n// module exports\nexport { Transform };","import * as THREE from 'three';\nimport {getOrDefault} from '../helpers/Misc';\nimport {Vector2} from '../core/Vector2';\nimport {Vector3} from '../core/Vector3';\nimport {Matrix4} from '../core/Matrix4';\nimport {Color} from '../core/Color';\nimport {Material} from '../scene/Material';\nimport {Transform} from '../scene/Transform';\nimport {_Math} from '../helpers/Math';\nimport {debug} from '../helpers/Debug';\n\n/**\n A Mesh is the aggregation of a geomtery, made of vertices (Vector3 Array), texture coordinates (or uv, Vector2 Array), vertexColor (Color Array) and various methods to create and modify 3D objects that have a material (see {{#crossLink \"Material\"}}{{/crossLink}}) and a transform (see {{#crossLink \"Transform\"}}{{/crossLink}}).\n\nPrimitive types are documented in their respective private construction methods :\n<ul>\n<li>plane : a 4 points defined rectangular plane, see <a href=\"#method_constructPlane\">constructPlane</a></li>\n<li>quad  : a 4 points defined quadrilateral shape, see <a href=\"#method_constructQuad\">constructQuad</a></li>\n<li>box : a 6 faces defined 3D box with width, height and depth, see <a href=\"#method_constructBox\">constructBox</a></li>\n<li>cube : a 3D cube, see <a href=\"#method_constructCube\">constructCube</a></li>\n<li>sphere : a 3D sphere, see <a href=\"#method_constructSphere\">constructSphere</a></li>\n<li>circle : a flat circle, see <a href=\"#method_constructCircle\">constructCircle</a></li>\n<li>cylinder : a 3D cylinder, see <a href=\"#method_constructCylinder\">constructCylinder</a></li>\n<li>icosahedron : a 3D icosahedron, see <a href=\"#method_constructIcosahedron\">constructIcosahedron</a></li>\n<li>octahedron : a 3D octahedron, see <a href=\"#method_constructOctahedron\">constructOctahedron</a></li>\n<li>text : a 3D text extruded frome a typeface, see <a href=\"#method_constructText\">constructText</a></li>\n<li>node : a 3D node, to create parent/child hierarchy structure, see <a href=\"#method_constructNode\">constructNode</a></li>\n<li>line : a 2 points defined line, see <a href=\"#method_constructLine\">constructLine</a></li>\n<li>sprite : a billboard textured plane, see <a href=\"#method_constructSprite\">constructSprite</a></li>\n<li>arc : a flat coordinates generated arc, see <a href=\"#method_constructArc\">constructArc</a></li>\n</u>\n\n  @class Mesh\n */\n\nclass Mesh\n{\n    /**\n    * @class Mesh\n    * @constructor\n    *\n    * @param {Object} params parameters object\n    *    @example\n    *     function script()\n    *     {\n    *         var M;\n    *         var R;\n    *     \n    *         var camera;\n    *         var light;\n    *         var light2;\n    *     \n    *         var circle1;\n    *         var circle2;\n    *     \n    *         this.setup = function()\n    *         {\n    *     \n    *             M = this.getContext();\n    *     \n    *             R = new Mobilizing.Renderer3D();\n    *             M.addComponent(R);\n    *     \n    *             var camera = new Mobilizing.Camera();\n    *             camera.setFarPlane(100000);\n    *             R.addCamera(camera);\n    *     \n    *             light = new Mobilizing.Light();\n    *             light.setIntensity(1.2);\n    *             light.transform.setLocalPosition(20,20,100);\n    *             R.addToCurrentScene(light);\n    *     \n    *             light2 = new Mobilizing.Light();\n    *             light2.transform.setLocalPosition(-20,-20,-10);\n    *             R.addToCurrentScene(light2);\n    *     \n    *             circle1 = new Mobilizing.Mesh({primitive:\"circle\"});\n    *             circle1.transform.setLocalPosition(-2,0,-15);\n    *             R.addToCurrentScene(circle1);\n    *     \n    *             circle2 = new Mobilizing.Mesh({primitive:\"circle\",\n    *                                            radius:2,\n    *                                            segments:20,\n    *                                            thetaStart:Math.PI/8,\n    *                                            thetaLength:Math.PI,\n    *                                            material:\"lambert\"});\n    *             circle2.material.setWireframe(true);\n    *             circle2.transform.setLocalPosition(2,0,-15);\n    *             R.addToCurrentScene(circle2);\n    *             console.log(circle2);\n    *         };\n    *     \n    *         var r = 0;\n    *         this.update = function()\n    *         {\n    *             r++;\n    *             circle2.transform.setLocalRotation(-33,r,33);\n    *         };\n    *     };\n    *\n    * @param {String} params.primitive The name of the primitive to create, can be one of the listed names in this class description.\n    * @param {String} [params.material=\"phong\"] The name of the material to attach to the created primitive, can be one of : lambert, basic, phong.\n    * @param {Object} [params.geometry=undefined] An already existing geometry\n    */\n    constructor(params)\n    {\n        this.primitive = getOrDefault(params, \"primitive\", \"box\");\n\n        this.name = getOrDefault(params, \"name\", undefined);\n        this.material = getOrDefault(params, \"material\", \"phong\");\n        this._geometry = getOrDefault(params, \"geometry\", undefined);\n\n        this.visible = true;\n\n        //construct a geometry according to the argument\n        switch(this.primitive)\n        {\n            case \"plane\":\n\n                this.constructPlane(params);\n                break;\n\n            case \"quad\":\n\n                this.constructQuad(params);\n                break;\n\n            case \"box\":\n\n                this.constructBox(params);\n                break;\n\n            case \"cube\":\n\n                this.constructCube(params);\n                break;\n\n            case \"sphere\":\n\n                this.constructSphere(params);\n                break;\n\n            case \"circle\":\n\n                this.constructCircle(params);\n                break;\n\n            case \"cylinder\":\n\n                this.constructCylinder(params);\n                break;\n\n            case \"icosahedron\":\n\n                this.constructIcosahedron(params);\n                break;\n\n            case \"octahedron\":\n\n                this.constructOctahedron(params);\n                break;\n\n            case \"text\":\n\n                this.constructText(params);\n                break;\n\n            case \"node\":\n\n                this.constructNode();\n                break;\n\n            case \"line\":\n\n                this.constructLine(params);\n                break;\n\n            case \"sprite\":\n\n                this.constructSprite();\n                break;\n\n            case \"arc\":\n\n                this.constructArc(params);\n                break;\n\n            case \"custom\":\n\n                this.constructCustom(params);\n                break;\n\n            default:\n\n                this.constructNode();\n                break;\n        }\n\n        //agglomerate a transform object\n        if(!this.transform)\n        {\n            this.transform = new Transform(this);\n        }\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * A node is an empty 3D object. It has no geometry, but has a tansform, therefore it can be used to create the root element for grouping objects. In Mobilizing, transforms represents a kind of invisible coordinate axis that can be tansformed in space. We use it to construct parent/child relationships, like in `object.transform.addChild(otherObject.transform)`\n    * \n    * @method constructNode\n    */\n    constructNode()\n    {\n        this.mesh = new THREE.Object3D();\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructLine\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.point1=Vector3(0, -1, 0)] 1st point 3D coordinates\n    * @param {Number} [params.point2=Vector3(0, 1, 0)] 2nd point 3D coordinates\n    */\n    constructLine(params)\n    {\n        //line have special material so we must manage it specifically\n        this._geometry = new THREE.Geometry();\n        this._geometry.dynamic = true;\n\n        var point1 = getOrDefault(params, \"point1\", new Vector3(0,-1,0));\n        var point2 = getOrDefault(params, \"point2\", new Vector3(0,1,0));\n\n        console.log(point1, point2);\n        this._geometry.vertices.push(point1, point2);\n\n        this.material = new Material({type:\"line\"});\n\n        this.mesh = new THREE.Line( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructSprite\n    */\n    constructSprite()\n    {\n        this.material = new Material({type:\"sprite\"});\n        this.mesh = new THREE.Sprite( this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructPlane\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.width=1] the plane width in world unit\n    * @param {Number} [params.height=1] the plane height in world unit\n    * @param {Number} [params.segments=1] tesselation size for all sides\n    * @param {Number} [params.widthSegments=1] horizontal tesselation size, overrides segments parameters for this side\n    * @param {Number} [params.heightSegments=1] vertical tesselation size, overrides segments parameters for this side\n    */\n    constructPlane(params)\n    {\n        //width height widthSegments heightSegments\n        var width           = getOrDefault(params, \"width\", 1);\n        var height          = getOrDefault(params, \"height\", 1);\n        var segments = getOrDefault(params, \"segments\", 1);\n        var widthSegments   = getOrDefault(params, \"widthSegments\", segments);\n        var heightSegments  = getOrDefault(params, \"heightSegments\", segments);\n\n        this._geometry   = new THREE.PlaneBufferGeometry(width,\n                                                         height,\n                                                         widthSegments,\n                                                         heightSegments);\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructQuad\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.point1=Vector2(-1,  1)] upper left point\n    * @param {Number} [params.point2=Vector2( 1,  1)] upper right point\n    * @param {Number} [params.point3=Vector2( 1, -1)] lower right point\n    * @param {Number} [params.point4=Vector2(-1, -1)] lower left point\n    */\n    constructQuad(params)\n    {\n        var point1 = getOrDefault(params, \"point1\", new Vector2(-1,  1));\n        var point2 = getOrDefault(params, \"point2\", new Vector2( 1,  1));\n        var point3 = getOrDefault(params, \"point3\", new Vector2( 1, -1));\n        var point4 = getOrDefault(params, \"point4\", new Vector2(-1, -1));\n\n        var rectShape   = new THREE.Shape();\n        rectShape.moveTo( point1.x, point1.y );\n        rectShape.lineTo( point2.x, point2.y );\n        rectShape.lineTo( point3.x, point3.y );\n        rectShape.lineTo( point4.x, point4.y );\n        rectShape.lineTo( point1.x, point1.y );\n\n        this._geometry   = new THREE.ShapeGeometry( rectShape );\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructCube\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.size=1] the cube dimensions in world unit\n    * @param {Number} [params.segments=1] tesselation size for all sides\n    * @param {Number} [params.widthSegments=1] horizontal tesselation size, overrides segments parameters for this side\n    * @param {Number} [params.heightSegments=1] vertical tesselation size, overrides segments parameters for this side\n    * @param {Number} [params.depthSegments=1] depth tesselation size, overrides segments parameters for this side\n    */\n    constructCube(params)\n    {\n        var size = getOrDefault(params, \"size\", 1);\n        var segments = getOrDefault(params, \"segments\", 1);\n        var widthSegments   = getOrDefault(params, \"widthSegments\", segments);\n        var heightSegments  = getOrDefault(params, \"heightSegments\", segments);\n        var depthSegments   = getOrDefault(params, \"depthSegments\", segments);\n\n        this._geometry = new THREE.BoxGeometry(size,\n                                               size,\n                                               size,\n                                               widthSegments,\n                                               heightSegments,\n                                               depthSegments);\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructBox\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.width=1] the box width in world unit\n    * @param {Number} [params.height=1] the box height in world unit\n    * @param {Number} [params.depth=1] the box depth in world unit\n    * @param {Number} [params.segments=1] tesselation size for all sides\n    * @param {Number} [params.widthSegments=1] horizontal tesselation size, overrides segments parameters for this side\n    * @param {Number} [params.heightSegments=1] vertical tesselation size, overrides segments parameters for this side\n    * @param {Number} [params.depthSegments=1] depth tesselation size, overrides segments parameters for this side\n    */\n    constructBox(params)\n    {\n        //width height depth widthSegments heightSegments depthSegments\n        var width           = getOrDefault(params, \"width\", 1);\n        var height          = getOrDefault(params, \"height\", 1);\n        var depth           = getOrDefault(params, \"depth\", 1);\n        var segments = getOrDefault(params, \"segments\", 1);\n        var widthSegments   = getOrDefault(params, \"widthSegments\", 1);\n        var heightSegments  = getOrDefault(params, \"heightSegments\", 1);\n        var depthSegments   = getOrDefault(params, \"depthSegments\", 1);\n\n        this._geometry       = new THREE.BoxGeometry(width,\n                                                     height,\n                                                     depth,\n                                                     widthSegments,\n                                                     heightSegments,\n                                                     depthSegments);\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructSphere\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.radius=1] the sphere radius in world unit\n    * @param {Number} [params.segments=8] tesselation size for all axis\n    * @param {Number} [params.widthSegments=8] horizontal tesselation size\n    * @param {Number} [params.heightSegments=8] vertical tesselation size\n    * @param {Number} [params.phiStart=0] horizontal angle start of the sphere\n    * @param {Number} [params.phiLength=Math.PI*2] horizontal length of the sphere\n    * @param {Number} [params.thetaStart=0] vertical angle start of the sphere\n    * @param {Number} [params.thetaLength=Math.PI] vertical length of the sphere\n    */\n    constructSphere(params)\n    {\n        //radius widthSegments heightSegments phiStart phiLength thetaStart thetaLength\n        var radius              = getOrDefault(params, \"radius\", 1);\n        var segments            = getOrDefault(params, \"segments\", 8);\n        var widthSegments       = getOrDefault(params, \"widthSegments\", segments);\n        var heightSegments      = getOrDefault(params, \"heightSegments\", segments);\n        var phiStart            = getOrDefault(params, \"phiStart\", 0);\n        var phiLength           = getOrDefault(params, \"phiLength\", Math.PI*2);\n        var thetaStart          = getOrDefault(params, \"thetaStart\", 0);\n        var thetaLength         = getOrDefault(params, \"thetaLength\", Math.PI);\n\n        this._geometry = new THREE.SphereGeometry(radius,\n                                                  widthSegments,\n                                                  heightSegments,\n                                                  phiStart,\n                                                  phiLength,\n                                                  thetaStart,\n                                                  thetaLength);\n        this._geometry.dynamic = true;\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructCircle\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.radius=1] the circle radius in world unit\n    * @param {Number} [params.segments=32] horizontal tesselation size\n    * @param {Number} [params.thetaStart=0] vertical angle start of the circle\n    * @param {Number} [params.thetaLength=Math.PI] vertical length of the circle\n    */\n    constructCircle(params)\n    {\n        //radius segments thetaStart thetaLength\n        var radius      = getOrDefault(params, \"radius\", 1);\n        var segments    = getOrDefault(params, \"segments\", 32);\n        var thetaStart  = getOrDefault(params, \"thetaStart\", 0);\n        var thetaLength = getOrDefault(params, \"thetaLength\", Math.PI*2);\n\n        this._geometry = new THREE.CircleGeometry(radius,\n                                                  segments,\n                                                  thetaStart,\n                                                  thetaLength);\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructCylinder\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.radiusTop=1] the cylinder top radius in world unit\n    * @param {Number} [params.radiusBottom=1] the cylinder bottom radius in world unit\n    * @param {Number} [params.height=1] the cylinder height in world unit\n    * @param {Number} [params.radiusSegments=32] horizontal tesselation size\n    * @param {Number} [params.heightSegments=1] vertical tesselation size\n    * @param {Number} [params.openEnded=false] close the ends of the shape or not\n    * @param {Number} [params.thetaStart=0] vertical angle start of the cylinder\n    * @param {Number} [params.thetaLength=Math.PI] vertical length of the cylinder\n    */\n    constructCylinder(params)\n    {\n        //radiusTop radiusBottom height radiusSegments heightSegments openEnded thetaStart thetaLength\n        var radiusTop       = getOrDefault(params, \"radiusTop\", 1);\n        var radiusBottom    = getOrDefault(params, \"radiusBottom\", 1);\n        var height          = getOrDefault(params, \"height\", 1);\n        var radiusSegments  = getOrDefault(params, \"radiusSegments\", 32);\n        var heightSegments  = getOrDefault(params, \"heightSegments\", 1);\n        var openEnded       = getOrDefault(params, \"openEnded\", false);\n        var thetaStart      = getOrDefault(params, \"thetaStart\", 0);\n        var thetaLength     = getOrDefault(params, \"thetaLength\", Math.PI*2);\n\n        this._geometry = new THREE.CylinderGeometry(radiusTop,\n                                                    radiusBottom,\n                                                    height,\n                                                    radiusSegments,\n                                                    heightSegments,\n                                                    openEnded,\n                                                    thetaStart,\n                                                    thetaLength);\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructIcosahedron\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.radius=1] the icosahedron radius in world unit\n    * @param {Number} [params.detail=0] the icosahedron number of points (tesselation and \"roundness\")\n    */\n    constructIcosahedron(params)\n    {\n        //radius detail\n        var radius = getOrDefault(params, \"radius\", 1);\n        var detail = getOrDefault(params, \"detail\", 0);\n\n        this._geometry  = new THREE.IcosahedronGeometry(radius, detail);\n        this._geometry.dynamic = true;\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructOctahedron\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.radius=1] the octahedron radius in world unit\n    * @param {Number} [params.detail=0] the octahedron number of points (tesselation and \"roundness\")\n    */\n    constructOctahedron(params)\n    {\n        var radius = getOrDefault(params, \"radius\", 1);\n        var detail = getOrDefault(params, \"detail\", 0);\n\n        this._geometry = new THREE.OctahedronGeometry( radius, detail);\n        this._geometry.dynamic = true;\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * 3D Text is created from a typeface represented in JSON, please use <a href=\"http://gero3.github.io/facetype.js/\">facetype.js</a> to generate a JSON from a font file. The generated JSON must be loader with a Loader.load.JSON() method and passed to the constructor.\n    * \n    * @method constructText\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.text=\"text\"] the text string\n    * @param {Number} [params.fontSize=1] the text font height\n    * @param {Number} [params.height=1] the glyph extrusion height (or visually speaking, depth). 0 to have flat letters.\n    * @param {Number} [params.segments=5] the text details and tesselation\n    * @param {Number} params.font the text font to use. Must be a json generated from facetype.js\n    */\n    constructText(params)\n    {\n        //FIXME : il faut utiliser un loader pour charger le json de la typo produit par typeface.js\n        let text        = getOrDefault(params, \"text\", \"text\");\n        let fontSize    = getOrDefault(params, \"fontSize\", 1);\n        let height      = getOrDefault(params, \"height\", 1);\n        let segments    = getOrDefault(params, \"segments\", 5);\n        let font        = getOrDefault(params, \"font\", undefined);\n\n        let threeFont = new THREE.Font(font);\n        console.log(threeFont);\n\n        this._geometry = new THREE.TextGeometry(text, {size: fontSize,\n                                                       height: height,\n                                                       curveSegments: segments,\n                                                       font: threeFont,\n                                                       weight: \"normal\",\n                                                       style: \"normal\",\n                                                       bevelEnabled: false}\n                                               );\n\n        this._geometry.center();\n\n        //manage the material according to the passed params, see the attachMaterial method below\n        this.attachMaterial(this.material);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n    }\n\n    /**\n    * Geometry and resulting mesh method, you should not use directly this method as it is used internally by the constructor. This documentation only aims to help you identify the possibles parameters for a particular shape.\n    * \n    * @method constructArc\n    * @param {Object} params Parameters object, given by the constructor.\n    * @param {Number} [params.radius=1] the arc radius in world unit\n    * @param {Number} [params.width=0.2] the arc width (or weight, distance between the exterior segments and the center) in world unit\n    * @param {Number} [params.segments=32] the segments number (detail level)\n    * @param {Number} [params.startAngle=0] 0 and Math.PI*2 are at 3 o'clock, value is counter clock-wise\n    * @param {Number} [params.endAngle=Math.PI*2] 0 and Math.PI*2 are at 3 o'clock, value is counter clock-wise\n    * @param {Color} [params.color=Color.white] \n    * @param {Number} [params.center=Vector3.zero] \n    */\n    constructArc(params)\n    {\n        this._geometry = new THREE.Geometry();\n        this._geometry.dynamic = true;\n\n        let radius          = getOrDefault(params, \"radius\", 1);\n        let width           = getOrDefault(params, \"width\", 0.2);\n        let segments        = getOrDefault(params, \"segments\", 32);\n        let startAngle      = getOrDefault(params, \"startAngle\", 0);\n        let endAngle        = getOrDefault(params, \"endAngle\", Math.PI*2);\n        let color           = getOrDefault(params, \"color\", Color.white.clone());\n        let texture         = params.texture;\n        let uvScale         = params.uvScale;\n        let center          = getOrDefault(params, \"center\", Vector3.zero.clone());\n\n        this.createArc({center: center,\n                        radius: radius,\n                        segments: segments,\n                        startAngle: startAngle,\n                        endAngle: endAngle,\n                        color: color,\n                        texture: texture,\n                        width: width,\n                        uvScale: uvScale\n                       });\n    }\n\n    /**\n     * Construct an empty and unfinished Mesh for which a geometry must be constructed. Once filled with vertices, constructMesh method must be called, or a method generating a complete Mesh must be used (i.e generateFillMesh)\n     * \n     * @method constructCustom\n     * @param {Object} params Parameters object, given by the constructor.\n     */\n    constructCustom(params)\n    {\n        this._geometry = getOrDefault(params, \"geometry\", new THREE.Geometry());\n        this._geometry.dynamic = true;\n    }\n\n    /*\n     * =====\n     * Mesh generation from vertices defining segments made shapes\n     * =====\n     */\n\n    /**\n    * Generate the mesh for the given vertices and generates flat uvs for it. Usefull for 2D shapes\n    * @method generateFillMesh\n    */\n    generateFillMesh(vertices)\n    {\n        //main shape to hold paths\n        let shape = new THREE.Shape();\n\n        //draw shape\n        shape.moveTo( vertices[0].x, vertices[0].y );\n        for(let i = 1; i < vertices.length; i++)\n        {\n            shape.lineTo( vertices[i].x, vertices[i].y );\n        }\n        shape.closePath();\n\n        //make a geometry from the shape\n        let geometry = new THREE.ShapeGeometry(shape);\n        //construct the Mob Mesh\n        this._geometry = geometry;\n        this.constructMesh();\n\n        //generate flat uvs\n        this.generateFlatUVs();\n    }\n\n    /**\n    * Generate the flat uvs for this mesh.\n    * @method generateFlatUVs\n    */\n    generateFlatUVs()\n    {\n        let geometry = this._geometry;\n        let uvs = [];\n        let bounds = this.getBoundingBox();\n\n        for(let i = 0; i < geometry.faces.length; i++)\n        {\n            let face = geometry.faces[i];\n            uvs[i] = [new Vector2(_Math.map(geometry.vertices[face.a].x, bounds.min.x,bounds.max.x, 0,1),\n                                  _Math.map(geometry.vertices[face.a].y, bounds.min.y,bounds.max.y, 0,1)),\n                      new Vector2(_Math.map(geometry.vertices[face.b].x, bounds.min.x,bounds.max.x, 0,1),\n                                  _Math.map(geometry.vertices[face.b].y, bounds.min.y,bounds.max.y, 0,1)),\n                      new Vector2(_Math.map(geometry.vertices[face.c].x, bounds.min.x,bounds.max.x, 0,1),\n                                  _Math.map(geometry.vertices[face.c].y, bounds.min.y,bounds.max.y, 0,1))];\n        }\n        this.setUVs(0,uvs);\n    }\n\n\n    /**\n    * Static Utils to generate the stroke for the given vertices with the given stroke width\n    * @static\n    * @method generateStrokeShape\n    * @param {Mesh} mesh to use as a base to get vertices\n    * @param {Number} inflateValue stroke width\n    * @return (Shape) a Three.js Shape to make a geometry from\n    */\n    static generateStrokeShape(mesh, inflateValue)\n    {\n        let points = [];\n        let innerGeom = mesh._geometry.clone();\n        let outterGeom = mesh._geometry.clone();\n\n        let tempOutterGeom = mesh._geometry.clone();\n\n        /*\n         * Expand fill of convex polygon algorithm taken from\n         * \n         * https://stackoverflow.com/questions/3749678/expand-fill-of-convex-polygon\n         * credits to Oren Trutner\n         * Some addition to it by Dominique Cunin\n         */\n\n        //defines the rotation to apply further\n        let rot = Mesh.geometryIsCW(innerGeom) ? \"ccw\" : \"cw\";\n\n        for(let i = 0; i < tempOutterGeom.vertices.length; i++)\n        {\n            // get this point (pt1), the point before it\n            // (pt0) and the point that follows it (pt2)\n            let pt0 = tempOutterGeom.vertices[(i > 0) ? i - 1 : tempOutterGeom.vertices.length - 1];\n            let pt1 = tempOutterGeom.vertices[i];\n            let pt2 = tempOutterGeom.vertices[(i < tempOutterGeom.vertices.length - 1) ? i + 1 : 0];\n\n            // find the line vectors of the lines going\n            // into the current point\n            let v01 = new Vector2(pt1.x - pt0.x, pt1.y - pt0.y);\n            let v12 = new Vector2(pt2.x - pt1.x, pt2.y - pt1.y);\n\n            (rot === \"ccw\") ? v01.rotate90CCW() : v01.rotate90CW();\n            (rot === \"ccw\") ? v12.rotate90CCW() : v12.rotate90CW();\n\n            v01.normalize();\n            v12.normalize();\n\n            // find the normals of the two lines, multiplied\n            // to the distance that polygon should inflate\n            let d01 = v01.multiplyScalar(inflateValue).clone();\n            let d12 = v12.multiplyScalar(inflateValue).clone();\n            //console.log(d01, d12);\n\n            // use the normals to find two points on the\n            // lines parallel to the polygon lines\n            let ptx0  = { x: pt0.x + d01.x, y: pt0.y + d01.y };\n            let ptx10 = { x: pt1.x + d01.x, y: pt1.y + d01.y };\n            let ptx12 = { x: pt1.x + d12.x, y: pt1.y + d12.y };\n            let ptx2  = { x: pt2.x + d12.x, y: pt2.y + d12.y };\n            //console.log(ptx0, ptx10, ptx12, ptx2);\n\n            // find the intersection of the two lines, and\n            // add it to the expanded polygon\n            let newPoint = _Math.intersectionPoint([ptx0, ptx10], [ptx12, ptx2]);\n            outterGeom.vertices[i].x = newPoint.x;\n            outterGeom.vertices[i].y = newPoint.y;\n            //console.log(\"newPoint\", newPoint);\n        }\n\n        //Shape and subPath\n        let outterPath = new THREE.Shape();\n        let innerPath = new THREE.Path();\n\n        outterPath.moveTo(outterGeom.vertices[0].x, outterGeom.vertices[0].y);\n        innerPath.moveTo(innerGeom.vertices[0].x, innerGeom.vertices[0].y);\n\n        //!warning! must construct the path CCW (not the shape, that is CW)\n        for(let i = innerGeom.vertices.length-1; i > 0; i--)\n        {\n            outterPath.lineTo(outterGeom.vertices[i].x, outterGeom.vertices[i].y);  \n            innerPath.lineTo(innerGeom.vertices[i].x, innerGeom.vertices[i].y);\n        }\n\n        outterPath.closePath();\n        innerPath.closePath();\n\n        outterPath.holes.push(innerPath);\n\n        return outterPath;\n    }\n\n    /**\n    * Static Utils to check the direction of a geometry (ccw o cw)\n    * @static\n    * @method geometryIsCW\n    * @param {Geometry} geometry Three.js geometry\n    * @return {Boolean} is CW or not\n    */\n    static geometryIsCW(geometry)\n    {\n        let vertices = geometry.vertices;\n\n        for(let i=0; i<vertices.length; i++)\n        {\n            let v1 = new Vector2(vertices[i+1].x - vertices[i].x,\n                                 vertices[i+1].y - vertices[i].y);\n\n            let v2 = new Vector2(vertices[i+2].x - vertices[i+1].x,\n                                 vertices[i+2].y - vertices[i+1].y);\n\n            v1.rotate90CW();\n\n            let dot = v1.dot(v2);\n            \n            if(dot !== 0)\n            {\n                if( v1.dot(v2) > 0 )\n                {\n                    return true;\n                    break;\n                }\n                else\n                {\n                    return false;\n                    break;\n                }\n            }\n            else\n            {\n                console.log(\"dot product is 0\");    \n            }\n        }\n        /*return vecDot(\n            vecRot90CW({ x: p[1].x - p[0].x, y: p[1].y - p[0].y }),\n            { x: p[2].x - p[1].x, y: p[2].y - p[1].y }) >= 0;*/\n    }\n\n    /**\n    * Static Utils to generate the stroke Mesh from a given shape\n    * @static\n    * @method generateStrokeMesh\n    * @param {Mesh} mesh to use as a base to get vertices\n    * @param {Number} inflateValue stroke width\n    * @return {Mesh} the resulting Mesh\n    */\n    static generateStrokeMesh(mesh, inflateValue)\n    {\n        let shape = Mesh.generateStrokeShape(mesh, inflateValue);\n\n        let geometry = new THREE.ShapeGeometry(shape);\n\n        let strokeMesh = new Mesh({primitive:\"custom\", geometry: geometry});\n        strokeMesh.constructMesh();\n\n        return strokeMesh;\n    }\n\n    /**\n    * Utils to regenerate the stroke Mesh when already existing\n    * @method updateStrokeMesh\n    * @param {Number} inflateValue stroke width\n    */\n    updateStroke(mesh, inflateValue)\n    {\n        let shape = Mesh.generateStrokeShape(mesh, inflateValue);\n\n        let geometry = new THREE.ShapeGeometry(shape);\n        this.setVertices(geometry.vertices);\n        this.updateMesh();\n    }\n\n    /**\n    * Static Utils to generate the stroke Mesh from a given shape\n    * @static\n    * @method generateStrokeMeshFromShape\n    * @param {Shape} shape\n    * @return {Mesh} the resulting Mesh\n    */\n    static generateStrokeMeshFromShape(shape)\n    {\n        let geometry = new THREE.ShapeGeometry(shape);\n\n        let strokeMesh = new Mesh({primitive:\"custom\", geometry: geometry});\n        strokeMesh.constructMesh();\n        strokeMesh.material.setColor(this.strokeColor);\n\n        return strokeMesh;\n    }\n\n    /*\n     * =====\n     * Boundings management\n     * =====\n     */\n\n    /**\n    * Compute and returns the bounding box of the current geometry  or Node, which is an object made of 2 Vector3.\n    * \n    * @method getBoundingBox\n    * @return {Object} boundingBox object {min: new Vector3, max: new Vector3}\n    */\n    getBoundingBox()\n    {\n        if(this._geometry)\n        {\n            if(!this._geometry.boundingBox)\n            {\n                this._geometry.computeBoundingBox();\n            }\n            return this._geometry.boundingBox;\n        }\n        else //no geometry, let three do the math\n        {\n            var bbox = new THREE.Box3().setFromObject(this.mesh);\n            return bbox;\n        }\n    }\n\n    /**\n    * Compute and returns the bounding sphere of the current geometry or Node, which is an object with a radius :\n    * \n    * @method getBoundingSphere\n    * @return {Object} boundingSphere object {radius: number}\n    */\n    getBoundingSphere()\n    {\n        if(this._geometry)\n        {\n            if(!this._geometry.boundingSphere)\n            {\n                this._geometry.computeBoundingSphere();\n            }\n            return this._geometry.boundingSphere;\n        }\n        else //no geometry, let three do the math\n        {\n            var bbox = new THREE.Box3().setFromObject(this.mesh);\n            return bbox.getBoundingSphere();\n        }\n    }\n\n    /*setIndex(val){\n        this.index = val;\n    }*/\n\n    //============\n    // 2D Geometry creation\n    //============\n\n    createLine(start, end, color, texture, width, uvScale)\n    {\n        var right = Vector3.zero;\n        var dir = Vector3.zero;\n        dir.subVectors(end, start);\n\n        if(uvScale === undefined)\n        {\n            uvScale = dir.length();\n        }\n\n        dir.normalize();\n\n        right.crossVectors(dir, new Vector3(0,0,1)); //right vector\n        right.x *= width;\n        right.y *= width;\n        right.z *= width;\n\n        var p1 = new Vector3(start.x-right.x, start.y-right.y, start.z-right.z);\n        var p2 = new Vector3(start.x+right.x, start.y+right.y, start.z+right.z);\n        var p3 = new Vector3(end.x+right.x, end.y+right.y, end.z+right.z);\n        var p4 = new Vector3(end.x-right.x, end.y-right.y, end.z-right.z);\n\n        this.transform.setLocalPosition(Vector3.zero.clone());\n\n        var uv1 = new THREE.Vector2(0,uvScale);\n        var uv2 = new THREE.Vector2(1,uvScale);\n        var uv3 = new THREE.Vector2(1,0);\n        var uv4 = new THREE.Vector2(0,0);\n\n        this.pushQuad(p1,p2,p3,p4,uv1,uv2,uv3,uv4);\n        this.material.setColor(color);\n        this.material.setWireframe(false);\n    }\n\n    /**\n    * createCircle\n    * @method createCircle\n    * @param {Number} center\n    * @param {Number} radius\n    * @param {Number} segments\n    * @param {Color} color\n    * @param {Texture} texture\n    * @param {Number} width\n    * @param {Number} uvScale\n    */\n    createCircle(params)\n    {\n        let center  = getOrDefault(params, \"center\", new Vector3(0,0,0));\n        let radius  = getOrDefault(params, \"radius\", 1);\n        let segments  = getOrDefault(params, \"segments\", 32);\n        let color  = getOrDefault(params, \"color\",);\n        let width  = getOrDefault(params, \"width\",);\n        let uvScale  = getOrDefault(params, \"uvScale\", 1);\n\n        this.createArc({\"center\": center,\n                        \"radius\": radius,\n                        \"segments\": segments,\n                        \"startAngle\": 0,\n                        \"endAngle\": 2 * Math.PI,\n                        \"color\": Color.white.clone(),\n                        \"width\": 1,\n                        \"uvScale\": 1\n                       });\n    }\n\n    /**\n    * createArc\n    * @method createArc\n    * @param {Number} center\n    * @param {Number} radius\n    * @param {Number} segments\n    * @param {Number} startAngle\n    * @param {Number} endAngle\n    * @param {Color} color\n    * @param {Texture} texture\n    * @param {Number} width\n    * @param {Number} uvScale\n    */\n    createArc(params)\n    {\n        let center = getOrDefault(params,\"center\", new Vector3(0,0,0));\n        let radius = getOrDefault(params,\"radius\", 1);\n        let segments = getOrDefault(params,\"segments\", 32);\n        let startAngle = getOrDefault(params,\"startAngle\", 0);\n        let endAngle = getOrDefault(params,\"endAngle\", Math.PI*2);\n        let color = getOrDefault(params,\"color\", Color.white.clone());\n        let width = getOrDefault(params,\"width\", 1);\n        let uvScale = getOrDefault(params,\"uvScale\", 1);\n\n        if(uvScale === undefined)\n        {\n            uvScale = radius * (endAngle - startAngle) * 1;\n            //uvScale = Math.floor(uvScale); //(do we want a round count of uv ?)\n        }\n\n        let innerpoints = [];\n        let outerpoints = [];\n        let interval = (Math.PI * 2) / segments;\n\n        let starta = startAngle;\n        let enda = endAngle;\n        let a = 0;\n\n        for (a = starta; a <= enda; a += interval)\n        {\n            innerpoints.push(new Vector3(Math.cos(a) * (radius - width/2), Math.sin(a) * (radius - width/2), 0));\n            outerpoints.push(new Vector3(Math.cos(a) * (radius + width/2), Math.sin(a) * (radius + width/2), 0));\n        }\n\n        //on termine l'arc si on n'était pas sur un multiple\n        if (a !== enda)\n        {\n            innerpoints.push( new Vector3(Math.cos(endAngle) * (radius - width/2), Math.sin(endAngle) * (radius - width/2), 0) );\n            outerpoints.push( new Vector3(Math.cos(endAngle) * (radius + width/2), Math.sin(endAngle) * (radius + width/2), 0) );\n        }\n\n        for (let k=0; k < innerpoints.length-1; ++k)\n        {\n            let p1 = outerpoints[k];\n            let p2 = innerpoints[k];\n            let p3 = innerpoints[(k+1) % innerpoints.length];\n            let p4 = outerpoints[(k+1) % innerpoints.length];\n\n            let uv1 = new Vector2(0,(k+0) * uvScale / (innerpoints.length-1));\n            let uv2 = new Vector2(1,(k+0) * uvScale / (innerpoints.length-1));\n            let uv3 = new Vector2(1,(k+1) * uvScale / (innerpoints.length-1));\n            let uv4 = new Vector2(0,(k+1) * uvScale / (innerpoints.length-1));\n\n            this.pushQuad(p1,p2,p3,p4,uv1,uv2,uv3,uv4);\n        }\n\n        this.material = new Material({type:\"basic\"}); //basic\n        this.material.setColor(color);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n\n        this.transform = new Transform(this);\n        this.transform.setLocalPosition(center);\n    }\n\n    /**\n    * createDisc\n    * @method createDisc\n    * @param {Number} center\n    * @param {Number} radius\n    * @param {Number} segments\n    * @param {Color} color\n    * @param {Texture} texture\n    */\n    createDisc(center, radius, segments, color, texture)\n    {\n        this.createDiscSector(center, radius, segments, 0, 2*Math.PI, color, texture);\n    }\n\n    /**\n    * createDiscSector\n    * @method undefined\n    * @param {Number} center\n    * @param {Number} radius\n    * @param {Number} segments\n    * @param {Number} startAngle\n    * @param {Number} endAngle\n    * @param {Color} color\n    * @param {Texture} texture\n    */\n    createDiscSector(params)\n    {\n\n        let center = getOrDefault(params,\"center\", new Vector3(0,0,0)); \n        let radius = getOrDefault(params,\"radius\", 1); \n        let segments = getOrDefault(params,\"segments\", 32); \n        let startAngle = getOrDefault(params,\"startAngle\", 0); \n        let endAngle = getOrDefault(params,\"endAngle\", Math.PI*2); \n        let color = getOrDefault(params,\"color\", Color.white.clone());\n\n        let points = [];\n        let interval = (Math.PI*2)/segments;\n        let starta = startAngle;\n        let enda = endAngle;\n        let a = 0;\n\n        for (a = starta; a <= enda; a += interval)\n        {\n            points.push(new Vector3(Math.cos(a) * (radius), Math.sin(a) * (radius), 0));\n        }\n        //on termine si on n'était pas sur un multiple\n        if (a !== enda)\n        {\n            points.push(new Vector3(Math.cos(endAngle) * (radius), Math.sin(endAngle) * (radius), 0));\n        }\n\n        let p1 = new Vector3(0,0,0); //local center\n\n        for (let k = 0; k < points.length-1; ++k)\n        {\n            let p2 = points[k];\n            let p3 = points[k + 1];\n\n            //FIXME : à calculer plus finement, quel mode de projection on applique ?\n            this.pushTriangle(p1,p2,p3);\n\n            let uv1 = new Vector2(0,0);\n            let uv2 = new Vector2(1,0);\n            let uv3 = new Vector2(1,1);\n\n            this.pushUV(uv1, uv2, uv3);\n        }\n\n        this.material = new Material({type:\"basic\"}); //basic\n        //this.material.setColor(color);\n\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n\n        this.transform = new Transform(this);\n        this.transform.setLocalPosition(center);\n    }\n\n    /**\n    * Call this method to construct a custom mesh\n    * @method constructMesh\n    */\n    constructMesh()\n    {\n        this.material = new Material({type:\"basic\"}); //basic\n        this.mesh = new THREE.Mesh( this._geometry, this.material._material );\n        this.transform = new Transform(this);\n        this._geometry.computeBoundingBox();\n    }\n\n    //================\n    // VERTEX MANAGEMENT\n    //================\n\n    /**\n    Adds a vertex to the current geometry\n\n    @method pushVertex\n    @param {Vector3} v vertex to add\n    */\n    pushVertex(v)\n    {\n        this._geometry.vertices.push(v);\n        this._geometry.verticesNeedUpdate = true;\n    }\n\n    /**\n    Adds a face to the current geometry\n\n    @method pushFace\n    @param {Integer} i1 Face Index to add\n    @param {Integer} i2 Face Index to add\n    @param {Integer} i3 Face Index to add\n    */\n    pushFace(i1, i2, i3)\n    {\n        this._geometry.faces.push( new THREE.Face3( i1, i2, i3 ) );\n        this._geometry.elementsNeedUpdate = true;\n    }\n\n    /**\n    Adds a UV to the current geometry\n\n    @method pushUV\n    @param {Vector2} uv1 uv coordinates to add\n    @param {Vector2} uv2 uv coordinates to add\n    @param {Vector2} uv3 uv coordinates to add\n    */\n    pushUV(uv1, uv2, uv3)\n    {\n        this._geometry.faceVertexUvs[0].push( [uv1, uv2, uv3] );\n        this._geometry.uvsNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n    }\n    /**\n    Adds a UV to the current geometry\n\n    @method pushNormal\n    @param {Vector2} n1 n coordinates to add\n    @param {Vector2} n2 n coordinates to add\n    @param {Vector2} n3 n coordinates to add\n    */\n    pushNormal(n1, n2, n3)\n    {\n        this._geometry.faceVertexNormals[0].push( [n1, n2, n3] );\n        this._geometry.uvsNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n        this._geometry.normalsNeedUpdate = true;\n    }\n\n    /**\n    Adds a triangle to the current geometry\n\n    @method pushTriangle\n    @param {Vector3} v1 vertex coordinates of the triangle\n    @param {Vector3} v2 vertex coordinates of the triangle\n    @param {Vector3} v3 vertex coordinates of the triangle\n    */\n    pushTriangle(v1,v2,v3)\n    {\n        let i  = this._geometry.vertices.length;\n        this._geometry.vertices.push(v1, v2, v3);\n        this._geometry.faces.push( new THREE.Face3( i+0, i+1, i+2 ) );\n        this._geometry.verticesNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n    }\n\n    /**\n    * Adds a Quad to the current geometry\n    * \n    * @method pushQuad\n    * @param {Vector3} v1 vertex coordinates of the Quad\n    * @param {Vector3} v2 vertex coordinates of the Quad\n    * @param {Vector3} v3 vertex coordinates of the Quad\n    * @param {Vector3} v4 vertex coordinates of the Quad\n    * @param {Vector2} uv1 uv coordinates to add\n    * @param {Vector2} uv2 uv coordinates to add\n    * @param {Vector2} uv3 uv coordinates to add\n    * @param {Vector2} uv3 uv coordinates to add\n    */\n    pushQuad(v1,v2,v3,v4,uv1,uv2,uv3,uv4)\n    {\n        let i  = this._geometry.vertices.length;\n        //var fi = this._geometry.faces.length;\n        this._geometry.vertices.push(v1, v2, v3, v4);\n\n        this._geometry.faces.push( new THREE.Face3( i+0, i+1, i+2 ) );\n        this._geometry.faces.push( new THREE.Face3( i+0, i+2, i+3 ) );\n\n        this._geometry.faceVertexUvs[0].push([uv1, uv2, uv3]);\n        this._geometry.faceVertexUvs[0].push([uv1, uv3, uv4]);\n\n        this._geometry.verticesNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n        this._geometry.uvsNeedUpdate = true;\n    }\n\n    /**\n    * compute Face and Vertex Normals for the current geometry\n    * \n    * @method computeNormals\n    */\n    computeNormals()\n    {\n        this._geometry.computeFaceNormals();\n        this._geometry.normalsNeedUpdate = true;\n        this._geometry.computeVertexNormals(true);\n        this._geometry.verticesNeedUpdate = true;\n    }\n\n    /**\n    * updateMesh\n    * \n    * @method updateMesh\n    */\n    updateMesh()\n    {\n        this._geometry.normalsNeedUpdate = true;\n        this._geometry.verticesNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n        this._geometry.uvsNeedUpdate = true;\n    }\n    /**\n    * Clears this mesh's geometry, that is vertices, faces and faceVertexUvs\n    * @method clear\n    */\n    clear()\n    {\n        this._geometry.vertices = [];\n        this._geometry.faces = [];\n        this._geometry.faceVertexUvs[0] = [];\n        this._geometry.faceVertexNormals[0] = []; //NEW\n        this._geometry.verticesNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n        this._geometry.uvsNeedUpdate = true;\n    }\n\n    /**\n    * Erase this mesh's geometry and material from memory\n    * @method erase\n    */\n    erase()\n    {\n        this._geometry.dispose();\n        this.material.erase();\n    }\n\n    /**\n    * Set the vertices of this mesh geometry\n    * @method setVertices\n    * @param {Object} vertices\n    */\n    setVertices(vertices)\n    {\n        this._geometry.vertices = vertices;\n        this._geometry.verticesNeedUpdate = true;\n        this._geometry.computeBoundingBox();\n    }\n    /**\n    * Get the vertices of this mesh geometry\n    * @method getVertices\n    * @return {Object} vertices\n    */\n    getVertices()\n    {\n        return this._geometry.vertices;\n    }\n\n    /**\n    * Set the UV of this mesh geometry\n    * @method setUVs\n    * @param {integer} index\n    * @param {Array} uvs\n    */\n    setUVs(index, uvs)\n    {\n        this._geometry.faceVertexUvs[index] = uvs;\n        this._geometry.uvsNeedUpdate = true;\n        this._geometry.elementsNeedUpdate = true;\n    }\n\n    /**\n    * Get the UV of this mesh geometry\n    * @method getUVs\n    * @param {integer} index of the UV to get\n    * @return {Array} uvs\n    */\n    getUVs(index)\n    {\n        return this._geometry.faceVertexUvs[index];\n    }\n\n    /**\n    * Set the vertexColors of this mesh geometry's vertices\n    * @method setVertexColors\n    * @param {Array<Color>} colors\n    */\n    setVertexColors(colors)\n    {\n        this.material._material.vertexColors = THREE.VertexColors;\n        this._geometry.colors = colors;\n        this._geometry.colorsNeedUpdate = true;\n    }\n\n    /**\n    * Get the vertexColors of this mesh geometry's vertices\n    * @method getVertexColors\n    * @return {Array<Color>} colors\n    */\n    getVertexColors()\n    {\n        return this._geometry.colors;\n    }\n\n    /**\n    * Defines the position of the geometry's center (NOT the transform!).\n    *\n    * @method setCenter\n    * @param {number} x x coordinate\n    * @param {number} y y coordinate\n    * @param {number} z z coordinate\n    */\n    setCenter(x,y,z)\n    {\n        this._geometry.applyMatrix( new Matrix4().makeTranslation(x,y,z) );\n    }\n\n    /**\n    * Returns the center of the geometry (vertices) based on boundingbox\n    *\n    * @method getCenter\n    * @return {Vector3} vector3 of the current geometry center\n    */\n    getCenter()\n    {\n        //force bounding box computation\n        if(this._geometry.boundingBox === null)\n        {\n            this._geometry.computeBoundingBox();\n        }\n        return this._geometry.boundingBox.center();\n    }\n\n    /**\n    * Set the scale of the geometry (vertices) - this is not like scaling the transform. Shouldn't be done in loop. Polymorphic : can take various agruments of various types. Possible arguments number is 1, 2 or 3.\n    *\n    * @method setScale\n    * @param {float|Vector3|Vector2} number|Vector3|Vector2 Value for the new scale of the geometry. If a Vector3 is given, its x, y, z will be used for the scale x, y, z. If a Vector2 is given, its x, y will be used for the scale x and y, but z will be 1. If a number is given, it will be the scale x.\n    * @param {float} Number Value for the new y scale of the geometry.\n    * @param {float} Number Value for the new z scale of the geometry.\n    */\n    setScale(arg1, arg2, arg3)\n    {\n        if(arguments.length === 3)\n        {\n            this._geometry.applyMatrix( new Matrix4().makeScale(arg1, arg2, arg3));\n        }\n        else if(arguments.length === 2)\n        {\n            if(typeof arg1 === \"number\" && typeof arg2 === \"number\")\n            {\n                this._geometry.applyMatrix( new Matrix4().makeScale(arg1, arg2, 1));\n            }\n        }\n        else if(arguments.length === 1)\n        {\n            if(arg1 instanceof Vector3)\n            {\n                this._geometry.applyMatrix( new Matrix4().makeScale(arg1.x, arg1.y, arg1.z));\n            }\n            else if(arg1 instanceof Vector2)\n            {\n                this._geometry.applyMatrix( new Matrix4().makeScale(arg1.x, arg1.y,1) );\n            }\n            else if(typeof arg1 === \"number\")\n            {\n                this._geometry.applyMatrix( new Matrix4().makeScale(arg1,arg1,arg1) );\n            }\n        }\n    }\n\n    /**\n    * Set the rotation around x axis of the vertices (not the transform!)\n    *\n    * @method setRotationX\n    * @param {float} value Rotation value in degree\n    */\n    setRotationX(arg1)\n    {\n        this._geometry.applyMatrix( new Matrix4().makeRotationX( _Math.degToRad(arg1)));\n    }\n\n    /**\n    * Set the rotation around y axis of the vertices (not the transform!)\n    * \n    * @method setRotationY\n    * @param {float} value Rotation value in degree\n    */\n    setRotationY(arg1)\n    {\n        this._geometry.applyMatrix( new Matrix4().makeRotationY( _Math.degToRad(arg1)));\n    }\n\n    /**\n    * Set the rotation around z axis of the vertices (not the transform!)\n    * \n    * @method setRotationZ\n    * @param {float} value Rotation value in degree\n    */\n    setRotationZ(arg1)\n    {\n        this._geometry.applyMatrix( new Matrix4().makeRotationZ( _Math.degToRad(arg1)));\n    }\n\n    /**\n    * Set the visibility of this mesh\n    * \n    * @method setVisible\n    * @param {Boolean} value visible or not\n    */\n    setVisible(val)\n    {\n        this.mesh.visible = val;\n    }\n\n    /**\n    * Get the visibility of this mesh\n    * \n    * @method getVisible\n    * @return {Boolean} value visible or not\n    */\n    getVisible()\n    {\n        return this.mesh.visible;\n    }\n\n    /*apply()\n    {\n        this.mesh.visible = this.visible;\n    }*/\n\n    /**\n    * Updates this mesh material\n    * \n    * @method updateMaterial\n    * @private\n    */\n    updateMaterial()\n    {\n        if(this.mesh.material){\n            this.mesh.material = this.material._material;\n        }\n    }\n\n    /**\n    * Sets this Mesh material. Be warned that this method requiers to build a new mesh, so it can be slow on update. Better use it in setup.\n    * @method setMaterial\n    * @param {Material || String} material the new material to set (if String used, one of \"phong\", \"lambert\", \"basic\")\n    */\n    setMaterial(material){\n\n        this.material = null;\n\n        if(material === undefined)\n        {\n            this.material = new Material({type:\"default\"});\n        }\n        else if(material instanceof Material)\n        {\n            this.material = material;\n        }\n        else if(typeof material === \"string\")\n        {\n            this.material = new Material({type:material});\n        }\n        var tempMesh = new THREE.Mesh( this._geometry, this.material._material );\n        var tempTransform = this.transform;\n\n        this.mesh = tempMesh;\n        this.transform = new Transform(this);\n        this.transform.setLocalScale(tempTransform.getLocalScale().x,\n                                     tempTransform.getLocalScale().y,\n                                     tempTransform.getLocalScale().z);\n\n        this.transform.setLocalPosition(tempTransform.getLocalPosition().x,\n                                        tempTransform.getLocalPosition().y,\n                                        tempTransform.getLocalPosition().z);\n\n        this.transform.setLocalRotation(tempTransform.getLocalRotation().x,\n                                        tempTransform.getLocalRotation().y,\n                                        tempTransform.getLocalRotation().z);\n    }\n\n    /**\n    * Attach the material to this mesh. The material must have been created before calling this method\n    *\n    * @method attachMaterial\n    * @param {Material} material\n    */\n    attachMaterial(material)\n    {\n        if(material === undefined)\n        {\n            this.material = new Material({type:\"default\"});\n        }\n        else if(material instanceof Material)\n        {\n            this.material = material;\n        }\n        else if(typeof material === \"string\")\n        {\n            this.material = new Material({type:material});\n        }\n        if(material !== undefined && this.mesh){\n            this.updateMaterial();\n        }\n    }\n\n    setCastShadow(enabled)\n    {\n        this.mesh.castShadow = enabled;\n    }\n\n    setReceiveShadow(enabled)\n    {\n        this.mesh.receiveShadow = enabled;\n    }\n\n    //============\n    // 3D Geometry creation\n    //============\n\n    /**\n     Creates a plane.\n     @method CreatePlane\n     @static\n     @param {Number} width Plane width (in world units).\n     @param {Number} height Plane height (in world units).\n     @param {Number} segments tesselation on all axis (in world units).\n     @param {Object} material Mobilizing Material.\n     */\n    static CreatePlane(width, height, segments, material)\n    {\n        var obj = new Mesh({primitive:\"plane\",\n                            width: width,\n                            height: height,\n                            segments: segments,\n                            material:\"material\"\n                           });\n        return obj;\n    }\n\n    /**\n     Creates a box.\n     @method CreateBox\n     @static\n     @param {Number} sizeX size on the X axis (in world units).\n     @param {Number} sizeY size on the Y axis (in world units).\n     @param {Number} sizeZ size on the Z axis (in world units).\n     @param {Number} segments tesselation on all axis (in world units).\n     @param {Object} material Mobilizing Material.\n     */\n    static CreateBox(sizeX, sizeY, sizeZ, segments, material)\n    {\n        var obj = new Mesh({primitive:\"box\",\n                            width: sizeX,\n                            height: sizeY,\n                            depth: sizeZ,\n                            segments: segments,\n                            material: material\n                           });\n        return obj;\n    }\n\n    /**\n     Creates a text mesh.\n     @method CreateText\n     @static\n     @param {String} text test to render.\n     */\n    static CreateText(text, font, fontSize, material, curveSegments, height)\n    {\n        var obj = new Mesh({primitive:\"text\",\n                            text: text,\n                            font:typeface,\n                            fontSize: fontSize,\n                            height: height,\n                            segments: curveSegments,\n                            material: material\n                           });\n        return obj;\n    }\n\n    /**\n     Creates a sphere\n     @method CreateSphere\n     @static\n     @param {Number} radius the Sphere radius (in world units).\n     @param {Number} widthSegments horizontal segments count (in world units).\n     @param {Number} heightSegments vertical segments count (in world units).\n     @param {Object} material Mobilizing Material.\n     */\n    static CreateSphere(radius, widthSegments, heightSegments, material )\n    {\n        var obj = new Mesh({primitive:\"sphere\",\n                            radius: radius,\n                            widthSegments: hsegments,\n                            heightSegments: vsegments,\n                            material: material\n                           });\n        return obj;\n    }\n\n    /**\n     Creates a circle\n     @method CreateCircle\n     @static\n     @param {Number} radius Plane width (in world units).\n     @param {Number} segments Plane height (in world units).\n     @param {Object} material Mobilizing Material.\n     */\n    static CreateCircle(radius, segments, material )\n    {\n        var obj = new Mesh({primitive:\"circle\",\n                            segments: segments,\n                            material: material\n                           });\n        return obj;\n    }\n}\n\n\n/**\n * EdgesMesh class creates a hiddenline fashioned Mesh from any other Mesh. \"Hard\" edges only will be visible. he result is different from when a Mesh material is set to wireframe, as all the segment will not be visible. All the coplanar segment are erased here in a new geometry that is rendered with a \"line\" type material.\n * @class EdgesMesh\n * @extends Mesh\n * @constructor\n * @param {Object} params parameters this can contains the same parameters than Mesh class\n * @param {Mesh} params.mesh The existing Mesh to use for generate a new edge only Mesh (geometry and material)\n */\nclass EdgesMesh extends Mesh\n{\n    constructor(params)\n    {\n        var _params = getOrDefault(params, {});\n        _params.threshold = getOrDefault(_params.threshold, undefined);\n        super(_params);\n\n        this.material = undefined;\n\n        //this.mesh = new THREE.EdgesHelper(this.mesh, undefined, 90);\n        this.material = undefined;\n        this.material = new Material({type:\"line\"});\n\n        if(_params.mesh){//for imported objects\n            this.mesh = new THREE.LineSegments( new THREE.EdgesGeometry( _params.mesh.geometry, _params.threshold ), this.material._material);\n            //console.log(\"tempMesh.geometry\",_params.mesh);\n        }else{\n            this.mesh = new THREE.LineSegments( new THREE.EdgesGeometry( this._geometry, _params.threshold ), this.material._material);\n        }\n        //this.mesh.matrix = tempMesh.matrixWorld;\n        this.transform = undefined;\n        this.transform = new Transform(this);\n\n    }\n}\n\n// module exports\nexport { Mesh };\nexport { EdgesMesh };\n","import {Mesh} from '../shape/Mesh';\n\nclass Csg\n{\n    /*\n    ThreeCSG simple binding for Mobilizing.\n    Use static method to generate new Mesh from the combination of two existing Mesh.\n    User should be careful of scene management as boolean operations are not produced on one of the given Mesh in argument but generate a new mesh from these two.\n\n    @class Csg\n    @constructor\n    @param {Context} context\n    */\n    constructor(context){\n        this.context =  context;\n    }\n\n    /*\n    Generate a new Mesh from the subtract boolean operation of two Mesh.\n\n    @method substract\n    @static\n    @param {Mesh} mesh First mesh to use for the boolean operation\n    @param {Mesh} mesh Second mesh to use for the boolean operation\n    */\n    static substract(mobMesh1, mobMesh2){\n\n        var csgMesh1 = new ThreeBSP(mobMesh1.mesh);\n        var csgMesh2 = new ThreeBSP(mobMesh2.mesh);\n\n        var newBSP = csgMesh1.subtract( csgMesh2 );\n\n        var BSPGeom = newBSP.toGeometry();\n\n        var newMobMesh = new Mesh(undefined,undefined,BSPGeom);\n\n\n        return newMobMesh;\n    }\n\n    /*\n    Generate a new Mesh from the union boolean operation of two Mesh.\n\n    @method union\n    @static\n    @param {Mesh} mesh First mesh to use for the boolean operation\n    @param {Mesh} mesh Second mesh to use for the boolean operation\n    */\n    static union(mobMesh1, mobMesh2){\n\n        var csgMesh1 = new ThreeBSP(mobMesh1.mesh);\n        var csgMesh2 = new ThreeBSP(mobMesh2.mesh);\n\n        var newBSP = csgMesh1.union( csgMesh2 );\n\n        var BSPGeom = newBSP.toGeometry();\n\n        var newMobMesh = new Mesh(undefined,undefined,BSPGeom);\n\n\n        return newMobMesh;\n    }\n\n    /*\n    Generate a new Mesh from the intersection boolean operation of two Mesh.\n\n    @method intersect\n    @static\n    @param {Mesh} mesh First mesh to use for the boolean operation\n    @param {Mesh} mesh Second mesh to use for the boolean operation\n    */\n    static intersect(mobMesh1, mobMesh2){\n\n        var csgMesh1 = new ThreeBSP(mobMesh1.mesh);\n        var csgMesh2 = new ThreeBSP(mobMesh2.mesh);\n\n        var newBSP = csgMesh1.intersect( csgMesh2 );\n\n        var BSPGeom = newBSP.toGeometry();\n\n        var newMobMesh = new Mesh(undefined,undefined,BSPGeom);\n\n\n        return newMobMesh;\n    }\n\n}\n\n// module exports\nexport { Csg };","const MOBILE = \"mobile\";\n\nconst DESKTOP = \"desktop\";\n\n// A map of regular expressions to test the userAgent with and retreive OS information\nconst OS_REGEX = new Map([\n    [\"Windows 10\", /(Windows 10.0|Windows NT 10.0)/],\n    [\"Windows 8.1\", /(Windows 8.1|Windows NT 6.3)/],\n    [\"Windows 8\", /(Windows 8|Windows NT 6.2)/],\n    [\"Windows 7\", /(Windows 7|Windows NT 6.1)/],\n    [\"Windows Vista\", /Windows NT 6.0/],\n    [\"Windows Server 2003\", /Windows NT 5.2/],\n    [\"Windows XP\", /(Windows NT 5.1|Windows XP)/],\n    [\"Windows 2000\", /(Windows NT 5.0|Windows 2000)/],\n    [\"Windows ME\", /(Win 9x 4.90|Windows ME)/],\n    [\"Windows 98\", /(Windows 98|Win98)/],\n    [\"Windows 95\", /(Windows 95|Win95|Windows_95)/],\n    [\"Windows NT 4.0\", /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/],\n    [\"Windows CE\", /Windows CE/],\n    [\"Windows 3.11\", /Win16/],\n    [\"Android\", /Android/],\n    [\"Open BSD\", /OpenBSD/],\n    [\"Sun OS\", /SunOS/],\n    [\"Linux\", /(Linux|X11)/],\n    [\"iOS\", /(iPhone|iPad|iPod)/],\n    [\"Mac OS X\", /Mac OS X/],\n    [\"Mac OS\", /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/],\n    [\"QNX\", /QNX/],\n    [\"UNIX\", /UNIX/],\n    [\"BeOS\", /BeOS/],\n    [\"OS/2\", /OS\\/2/],\n    [\"Search Bot\", /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/]\n]);\n\nvar _STATICS = {};\n\n/**\n * Device class gives easy access to some device information such as the operating system and browser used\n *\n * @example\n *     Mobilizing.Device.getOS();\n *\n * @class Device\n */\nclass Device\n{\n    \n    /**\n    * Parse OS data from navigator.userAgent and navigator.appVersion\n    * Credit goes to http://stackoverflow.com/questions/9514179/how-to-find-the-operating-system-version-using-javascript\n    *\n    * @method parseOSData\n    * @static\n    * @private\n    */\n    static parseOSData()\n    {\n        let os = \"unknown\";\n        let osVersion = \"unknown\";\n        \n        for(let [key, regex] of OS_REGEX){\n            if(regex.test(navigator.userAgent)){    \n                os = key;\n            \n                if (/Windows/.test(os)) {\n                    osVersion = /Windows (.*)/.exec(os)[1];\n                    os = \"Windows\";\n                }\n                break;\n            }\n        }\n\n        switch (os) {\n            case \"Mac OS X\":\n                osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(navigator.userAgent)[1];\n                break;\n\n            case \"Android\":\n                osVersion = /Android ([\\.\\_\\d]+)/.exec(navigator.userAgent)[1];\n                break;\n\n            case \"iOS\":\n                osVersion = /OS (\\d+)_(\\d+)_?(\\d+)?/.exec(navigator.appVersion);\n                osVersion = osVersion[1] + \".\" + osVersion[2] + \".\" + (osVersion[3] | 0);\n                break;\n        }\n            \n        _STATICS[\"os\"] = os;\n        _STATICS[\"osVersion\"] = osVersion;\n        \n    }\n    \n    /**\n    * Parse browser data from navigator.appName, navigator.userAgent and navigator.appVersion\n    * Credit goes to http://stackoverflow.com/questions/9514179/how-to-find-the-operating-system-version-using-javascript\n    *\n    * @method parseBrowserData\n    * @static\n    * @private\n    */\n    static parseBrowserData()\n    {\n        let browser = navigator.appName;\n        let version;\n        let majorVersion;\n        let versionOffset;\n        let ix;\n        \n        // Opera\n        if ((versionOffset = navigator.userAgent.indexOf(\"Opera\")) != -1) {\n            browser = \"Opera\";\n            version = navigator.userAgent.substring(versionOffset + 6);\n            if ((versionOffset = navigator.userAgent.indexOf(\"Version\")) != -1) {\n                version = navigator.userAgent.substring(versionOffset + 8);\n            }\n        }\n        // MSIE\n        else if ((versionOffset = navigator.userAgent.indexOf(\"MSIE\")) != -1) {\n            browser = \"Microsoft Internet Explorer\";\n            version = navigator.userAgent.substring(versionOffset + 5);\n        }\n        // Chrome\n        else if ((versionOffset = navigator.userAgent.indexOf(\"Chrome\")) != -1) {\n            browser = \"Chrome\";\n            version = navigator.userAgent.substring(versionOffset + 7);\n        }\n        // Safari\n        else if ((versionOffset = navigator.userAgent.indexOf(\"Safari\")) != -1) {\n            browser = \"Safari\";\n            version = navigator.userAgent.substring(versionOffset + 7);\n            if ((versionOffset = navigator.userAgent.indexOf(\"Version\")) != -1) {\n                version = navigator.userAgent.substring(versionOffset + 8);\n            }\n        }\n        // Firefox\n        else if ((versionOffset = navigator.userAgent.indexOf(\"Firefox\")) != -1) {\n            browser = \"Firefox\";\n            version = navigator.userAgent.substring(versionOffset + 8);\n        }\n        // MSIE 11+\n        else if (navigator.userAgent.indexOf(\"Trident/\") != -1) {\n            browser = \"Microsoft Internet Explorer\";\n            version = navigator.userAgent.substring(navigator.userAgent.indexOf(\"rv:\") + 3);\n        }\n        // Other browsers\n        else if ((nameOffset = navigator.userAgent.lastIndexOf(\" \") + 1) < (versionOffset = navigator.userAgent.lastIndexOf(\"/\"))) {\n            browser = navigator.userAgent.substring(nameOffset, versionOffset);\n            version = navigator.userAgent.substring(versionOffset + 1);\n            if (browser.toLowerCase() == browser.toUpperCase()) {\n                browser = navigator.appName;\n            }\n        }\n        \n        // trim the version string\n        if ((ix = version.indexOf(\";\")) != -1) version = version.substring(0, ix);\n        if ((ix = version.indexOf(\" \")) != -1) version = version.substring(0, ix);\n        if ((ix = version.indexOf(\")\")) != -1) version = version.substring(0, ix);\n\n        majorVersion = parseInt(\"\" + version, 10);\n        if (isNaN(majorVersion)) {\n            version = \"\" + parseFloat(navigator.appVersion);\n            majorVersion = parseInt(navigator.appVersion, 10);\n        }\n        \n        _STATICS[\"browser\"] = browser;\n        _STATICS[\"browserVersion\"] = version;\n        _STATICS[\"browserMajorVersion\"] = majorVersion;\n        \n    }\n    \n    /**\n    * Get the device type\n    *\n    * @method getType\n    * @static\n    * @return {String} The device type (mobile or desktop)\n    */\n    static getType()\n    {\n        if(!(\"type\" in _STATICS)){\n            _STATICS[\"type\"] = /Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(navigator.appVersion) ? MOBILE : DESKTOP;\n        }\n        \n        return _STATICS[\"type\"];\n    }\n    \n    /**\n    * Get the operating system's type\n    *\n    * @method getOS\n    * @static\n    * @return {String} The OS type (Windows, Mac OS X, Android, iOS, etc)\n    */\n    static getOS()\n    {\n        if(!(\"os\" in _STATICS)){\n            Device.parseOSData();\n        }\n        \n        return _STATICS[\"os\"];\n    }\n    \n    /**\n    * Get the operating system's version\n    *\n    * @method getOSVersion\n    * @static\n    * @return {String} The OS version\n    */\n    static getOSVersion()\n    {\n        if(!(\"osVersion\" in _STATICS)){\n            Device.parseOSData();\n        }\n        \n        return _STATICS[\"osVersion\"];\n    }\n    \n    /**\n    * Get the name of the web browser\n    *\n    * @method getBrowser\n    * @static\n    * @return {String} The browser's name \n    */\n    static getBrowser()\n    {\n        if(!(\"browser\" in _STATICS)){\n            Device.parseBrowserData();\n        }\n        \n        return _STATICS[\"browser\"];\n    }\n    \n    /**\n    * Get the version of the web browser\n    *\n    * @method getBrowserVersion\n    * @static\n    * @return {String} The browser's version\n    */\n    static getBrowserVersion()\n    {\n        if(!(\"browserVersion\" in _STATICS)){\n            Device.parseBrowserData();\n        }\n        \n        return _STATICS[\"browserVersion\"];\n    }\n    \n    /**\n    * Get the major version number of the web browser\n    *\n    * @method getBrowserMajorVersion\n    * @static\n    * @return {Number} The browser's major version\n    */\n    static getBrowserMajorVersion()\n    {\n        if(!(\"browserMajorVersion\" in _STATICS)){\n            Device.parseBrowserData();\n        }\n        \n        return _STATICS[\"browserMajorVersion\"];\n    }\n    \n    /**\n    * Get the framework the html page is running under (ejecta or cordova), if any\n    *\n    * @method getFramework\n    * @static\n    * @return {String} The framework's name, or null if none\n    */\n    static getFramework()\n    {\n        if(!(\"framework\" in _STATICS)){\n            _STATICS[\"framework\"] = null;\n            \n            if(navigator.userAgent.toLowerCase().indexOf(\"ejecta\") > -1){\n                _STATICS[\"framework\"] = \"ejecta\";\n            }\n            else if(window.cordova){\n                _STATICS[\"framework\"] = \"cordova\";\n            }\n        }\n        \n        return _STATICS[\"framework\"];\n    }\n    \n    /**\n    * Get the screen's width\n    * This does not necessarily indicate the width available\n    * Some of the screen's width might be used by browser widgets and scrollbars\n    *\n    * @method getScreenWidth\n    * @static\n    * @return {Number} The screen's width in pixels\n    */\n    static getScreenWidth()\n    {\n        return window.screen.width;\n    }\n    \n    /**\n    * Get the screen's height\n    * This does not necessarily indicate the height available\n    * Some of the screen's height might be used by browser widgets and scrollbars\n    *\n    * @method getScreenHeight\n    * @static\n    * @return {Number} The screen's height in pixels\n    */\n    static getScreenHeight()\n    {\n        return window.screen.height;\n    }\n    \n    /**\n    * Shortcut to {{#crossLink \"Device/getScreenWidth:method\"}}{{/crossLink}} and {{#crossLink \"Device/getScreenHeight:method\"}}{{/crossLink}}\n    *\n    * @method getScreenSize\n    * @static\n    * @return {Object} An object with \"width\" and \"height\" as keys representing the screen's dimensions\n    */\n    static getScreenSize()\n    {\n        return {\n            \"width\": Device.getScreenWidth(),\n            \"height\": Device.getScreenHeight()\n        };\n    }\n}\n\n// module exports\nexport { Device };\n","import {debug} from './Debug';\nimport {Component} from '../Component';\n\n/**\n * Fired when charging state changed\n * @event chargingchange\n */\nconst EVT_CHARGING_CHANGED = 'chargingchange';\n\n/**\n * Fired when charge level changed\n * @event levelchange\n */\nconst EVT_LEVEL_CHANGED = 'levelchange';\n\n/**\n * Fired when charging time changed\n * @event chargingtimechange\n */\nconst EVT_CHARGING_TIME_CHANGED = 'chargingtimechange';\n\n/**\n * Fired when discharging time changed\n * @event dischargingtimechange\n */\nconst EVT_DISCHARGING_TIME_CHANGED = 'dischargingtimechange';\n\n\n/**\n* Component to monitor battery status changes\n*\n* @class BatteryStatus\n*/\nclass BatteryStatus extends Component\n{\n\n    /**\n    * @method setup\n    */\n    setup(){\n        this._manager = null;\n        \n        this._batteryAvailable = navigator.getBattery !== undefined;\n    }\n\n    /**\n    * @method on\n    */\n    on()\n    {\n        if(this._batteryAvailable){\n            super.on();\n            navigator.getBattery().then(manager => this.onBatteryManager(manager));\n        }\n        else{\n            debug.warn('The battery API is not supported on this device');\n        }\n    }\n\n    /**\n    * @method off\n    */\n    off()\n    {\n        super.off();\n        \n        if(this._manager){\n            this._manager.removeEventListener(\"chargingchange\", event => this.onChargingChange(event));\n            this._manager.removeEventListener(\"chargingtimechange\", event => this.onChargingTimeChange(event));\n            this._manager.removeEventListener(\"levelchange\", event => this.onLevelChange(event));\n            this._manager.removeEventListener(\"dischargingtimechange\", event => this.onDischargingTimeChange(event));\n            \n            this._manager = null;\n        }\n    }\n\n    /**\n    battery API promise callback\n    Adds event listeners on the battery manager\n\n    @method onBatteryManager\n    @param {BatteryManager} manager A BatteryManager (see https://developer.mozilla.org/en-US/docs/Web/API/BatteryManager)\n    @private\n    */\n    onBatteryManager(manager)\n    {\n        if(!this.getStatus()){\n            // this component has been turned off before getting the manager\n            return;\n        }\n        \n        this._manager = manager;\n        \n        this._manager.addEventListener(\"chargingchange\", event => this.onChargingChange(event));\n        this._manager.addEventListener(\"chargingtimechange\", event => this.onChargingTimeChange(event));\n        this._manager.addEventListener(\"levelchange\", event => this.onLevelChange(event));\n        this._manager.addEventListener(\"dischargingtimechange\", event => this.onDischargingTimeChange(event));\n    }\n\n    /**\n    chargingchange event handler\n    Fires a chargingchange event\n\n    @method onChargingChange\n    @private\n    */\n    onChargingChange(event)\n    {\n        this.events.trigger(EVT_CHARGING_CHANGED, event.target.charging);\n    }\n\n    /**\n    chargingtimechange event handler\n    Fires a chargingtimechange event\n\n    @method onChargingTimeChange\n    @private\n    */\n    onChargingTimeChange(event)\n    {\n        this.events.trigger(EVT_CHARGING_TIME_CHANGED, event.target.chargingTime);\n    }\n\n    /**\n    levelchange event handler\n    Fires a levelchange event\n\n    @method onDischargingTimeChange\n    @private\n    */\n    onDischargingTimeChange(event)\n    {\n        this.events.trigger(EVT_DISCHARGING_TIME_CHANGED, event.target.dischargingTime);\n    }\n\n    /**\n    dischargingtimechange event handler\n    Fires a dischargingtimechange event\n\n    @method onLevelChange\n    @private\n    */\n    onLevelChange(event)\n    {\n        this.events.trigger(EVT_LEVEL_CHANGED, event.target.level);\n    }\n\n    /**\n    Check if the battery is currently charging\n    The component needs to be activated before using this method\n\n    @method isCharging\n    @return {Boolean} True if charging, false otherwise\n    */\n    isCharging()\n    {\n        if(!this._manager){\n            debug.warn('The battery component needs to be active to get battery information');\n            return null;\n        }\n        \n        return this._manager.charging;\n    }\n\n    /**\n    Get the time remaining until the battery is fully charge\n    The component needs to be activated before using this method\n\n    @method getChargingTime\n    @return {Number} The remaining time in seconds until the battery is fully charged, or 0 if the battery is already fully charged\n    */\n    getChargingTime()\n    {\n        if(!this._manager){\n            debug.warn('The battery component needs to be active to get battery information');\n            return null;\n        }\n        \n        return this._manager.chargingTime;\n    }\n\n    /**\n    Get the time remaining until the battery is completely discharged\n    The component needs to be activated before using this method\n\n    @method getDischargingTime\n    @return {Number} The remaining time in seconds until the battery is completely discharged and the system will suspend\n    */\n    getDischargingTime()\n    {\n        if(!this._manager){\n            debug.warn('The battery component needs to be active to get battery information');\n            return null;\n        }\n        \n        return this._manager.dischargingTime;\n    }\n\n    /**\n    Get the battery's charge level\n    The component needs to be activated before using this method\n\n    @method getLevel\n    @return {Number} The charge level on a scale from 0.0 to 1.0\n    */\n    getLevel()\n    {\n        if(!this._manager){\n            debug.warn('The battery component needs to be active to get battery information');\n            return null;\n        }\n        \n        return this._manager.level;\n    }\n}\n\n// module exports\nexport { BatteryStatus };\n","import {Component} from '../Component';\nimport {getOrDefault} from '../helpers/Misc';\n\n/**\n * Fired when a new keydown event occures\n * @event keydown\n */\nconst EVT_KEY_DOWN = \"keydown\";\n\n/**\n * Fired when a new keypressed event occures\n * @event keypressed\n */\nconst EVT_KEY_PRESS = \"keypress\";\n\n/**\n * Fired when a new keyup event occures\n * @event keyup\n */\nconst EVT_KEY_UP = \"keyup\";\n\nclass Keyboard extends Component\n{\n    /**\n     * Simple mapping from HTLM keyboard events toward Mobilizing.js. Not of a big interest for now...\n     * \n     * @class Keyboard\n     * @constructor\n     * \n     * @param {Object} params Config parameters\n     * @param {Window} [params.target=window] The DOM element this instance is attached to\n    */\n\n    constructor(params)\n    {\n        super(params);\n        \n        this._target = getOrDefault(params, \"target\", window);\n    }\n\n    on()\n    {\n        super.on();\n\n        this._target.addEventListener(\"keydown\", event => this.onKeyDown(event));\n        this._target.addEventListener(\"keypress\", event => this.onKeyPress(event));\n        this._target.addEventListener(\"keyup\", event => this.onKeyUp(event));\n    }\n\n    off()\n    {\n        super.off();\n\n        this._target.removeEventListener(\"keydown\", event => this.onKeyDown(event));\n        this._target.removeEventListener(\"keypress\", event => this.onKeyPress(event));\n        this._target.removeEventListener(\"keyup\", event => this.onKeyUp(event));\n    }\n\n    setup()\n    {\n        //note: on window, keypress events are continously called, like keydown. It's not the case of html element\n        //we reproduce this behavior here.\n        this._isPressed = false;\n        this._keyDownCode;\n    }\n\n    update()\n    {\n\n    }\n\n    /**\n    * Fast way to verify in an update loop if a specific key is currently down\n    * \n    * @method getKeyIsDown\n    * @param {Object} key\n    * @return {Boolean} is down or not\n    */\n    getKeyIsDown(key)\n    {\n        if(this._keyDownCode === key.toLowerCase()){\n            return true;\n        }else{\n            return false;\n        }\n    }\n\n    /**\n    * Forward the keydown event\n    * \n    * @private\n    * @method onKeyDown\n    * @param {Object} event\n    */\n    onKeyDown(event)\n    {\n        this._keyDownCode = String.fromCharCode(event.keyCode).toLowerCase();\n\n        this.events.trigger(EVT_KEY_DOWN, event);\n        //event.preventDefault();\n    }\n\n    /**\n    * Forward the keypress event\n    * \n    * @private\n    * @method onKeyPress\n    * @param {Object} event\n    */\n    onKeyPress(event)\n    {\n        //if(!this._isPressed){\n\n            this._keyDownCode = String.fromCharCode(event.keyCode).toLowerCase();\n\n            this.events.trigger(EVT_KEY_PRESS, event);\n            this._isPressed = true;\n        //}\n        event.preventDefault();\n    }\n\n    /**\n    * Forward the keyup event\n    * \n    * @private\n    * @method onKeyUp\n    * @param {Object} event\n    */\n    onKeyUp(event)\n    {\n        this._keyDownCode = undefined;\n        this._isPressed = false;\n\n        this.events.trigger(EVT_KEY_UP, event);\n        //event.preventDefault();\n    }\n}\n\n// module exports\nexport { Keyboard };\n","/**\n * DOM helper class gives easy access to some basics calculations/manipulations frequently done on DOM elements\n *\n * @class DOM\n */\n\nclass _DOM\n{\n    /**\n     * Get an element's position within the document taking into account the scroll positions\n     * @method getElementPosition\n     * @static\n     * @param {Element} el The DOM element\n     * @return {Object} the position of the element as {x, y}\n     */\n    static getElementPosition(el)\n    {\n        let x = 0;\n        let y = 0;\n\n        while (el)\n        {\n            if (el.tagName === \"BODY\")\n            {\n                // deal with browser quirks with body/window/document and page scroll\n                let xScroll = el.scrollLeft || document.documentElement.scrollLeft;\n                let yScroll = el.scrollTop || document.documentElement.scrollTop;\n\n                x += (el.offsetLeft - xScroll + el.clientLeft);\n                y += (el.offsetTop - yScroll + el.clientTop);\n            }\n            else\n            {\n                // for all other non-BODY elements\n                x += (el.offsetLeft - el.scrollLeft + el.clientLeft);\n                y += (el.offsetTop - el.scrollTop + el.clientTop);\n            }\n            el = el.offsetParent;\n        }\n        return { \"x\":x, \"y\":y };\n    }\n\n}\n\n// module exports\nexport { _DOM };\n","import {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\nimport {Device} from '../helpers/Device';\nimport {_DOM} from '../helpers/DOM';\nimport {Component} from '../Component';\n\n// Events\n\n/**\n * Fired when the mouse postupdate is called\n * @event mouseupdate\n */\nconst EVT_MOUSE_UPDATE = \"mouseupdate\";\n\n/**\n * Fired when a mouse move is detected\n * @event mousemove\n */\nconst EVT_MOUSE_MOVE = 'mousemove';\n\n/**\n * Fired when the pointer moves onto the target element\n * @event mouseover\n */\nconst EVT_MOUSE_OVER = 'mouseover';\n\n/**\n * Fired when the pointer moves off the target element\n * @event mouseout\n */\nconst EVT_MOUSE_OUT = 'mouseout';\n\n/**\n * Fired when a button is pressed\n * @event mousepress\n * @param {Number} button The button number pressed\n */\nconst EVT_MOUSE_PRESS = 'mousepress';\n\n/**\n * Fired when a mouse move is detected and a button is being pressed\n * @event mousedrag\n */\nconst EVT_MOUSE_DRAG = 'mousedrag';\n\n/**\n * Fired when a button is released\n * @event mouserelease\n */\nconst EVT_MOUSE_RELEASE = 'mouserelease';\n\n/**\n * Fired when a button is pressed and released on the target element\n * @event mouseclick\n * @param {Number} button The button number pressed\n */\nconst EVT_MOUSE_CLICK = 'mouseclick';\n\n/**\n * Fired when a button is clicked twice on the target element\n * @event mousedblclick\n * @param {Number} button The button number pressed\n */\nconst EVT_MOUSE_DBLCLICK = 'mousedblclick';\n\n/**\n * Fired when the wheel button is rotated\n * @event mousewheel\n * @param {Number} deltaX The scroll amount for the x-axis\n * @param {Number} deltaY The scroll amount for the y-axis\n * @param {Number} deltaZ The scroll amount for the z-axis\n */\nconst EVT_MOUSE_WHEEL = 'mousewheel';\n\n\nclass Mouse extends Component\n{\n    /**\n     * Give simple access to mouse events\n     * \n     * @class Mouse\n     * @extends Component\n     * @constructor\n     * @param {Object} params Config parameters\n     * @param {Object} [params.target=window] The DOM element this instance is attached to\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this._target = getOrDefault(params, \"target\", window);\n    }\n\n    /**\n    * Initialization method\n    * @method setup Setup\n    */\n    setup()\n    {    \n        this._x = null;\n        this._y = null;\n\n        this._pX = null;\n        this._pY = null;\n\n        this._dragStartX = null;\n        this._dragStartY = null;\n\n        // keeps track of total wheel deltas between two updates\n        this._wheelDeltaX = 0;\n        this._wheelDeltaY = 0;\n        this._wheelDeltaZ = 0;\n\n        // keeps track of whether a button is being pressed\n        this._pressed = false;\n\n        // keeps track of whether the wheel has been activated since last update\n        this._wheelActivated = false;\n\n        // keeps track of whether the wheel values should be reset during next update\n        this._resetWheel = false;\n    }\n\n    /**\n    * @method on\n    */\n    on()\n    {        \n        super.on();\n\n        if(!this._target){\n            debug.error(\"Can't activate the mouse input component without a target\");\n            return;\n        }\n\n        this._target.addEventListener(\"mousemove\", event => this.onMouseMove(event));\n        this._target.addEventListener(\"mouseover\", event => this.onMouseOver(event));\n        this._target.addEventListener(\"mouseout\", event => this.onMouseOut(event));\n        this._target.addEventListener(\"mousedown\", event => this.onMouseDown(event));\n        this._target.addEventListener(\"mouseup\", event => this.onMouseUp(event));\n        this._target.addEventListener(\"click\", event => this.onClick(event));\n        this._target.addEventListener(\"dblclick\", event => this.onDblClick(event));\n        this._target.addEventListener(\"wheel\", event => this.onWheel(event));\n    }\n\n    /**\n    * @method off\n    */\n    off()\n    {        \n        super.off();\n\n        if(!this._target){\n            debug.error(\"Can't deactivate the mouse input component without a target\");\n            return;\n        }\n\n        this._target.removeEventListener(\"mousemove\", event => this.onMouseMove(event));\n        this._target.removeEventListener(\"mouseover\", event => this.onMouseOver(event));\n        this._target.removeEventListener(\"mouseout\", event => this.onMouseOut(event));\n        this._target.removeEventListener(\"mousedown\", event => this.onMouseDown(event));\n        this._target.removeEventListener(\"mouseup\", event => this.onMouseUp(event));\n        this._target.removeEventListener(\"click\", event => this.onClick(event));\n        this._target.removeEventListener(\"dblclick\", event => this.onDblClick(event));\n        this._target.removeEventListener(\"wheel\", event => this.onWheel(event));\n    }\n\n    preUpdate()\n    {\n        // check if the wheel was already active at previous update and if it needs to be reset\n        if(this._wheelActivated){\n            if(this._resetWheel){\n                this._wheelActivated = false;\n                this._resetWheel = false;\n\n                this._wheelDeltaX = 0;\n                this._wheelDeltaY = 0;\n                this._wheelDeltaZ = 0;\n            }\n            else{\n                this._resetWheel = true;\n            }\n        }\n    }\n\n    update()\n    {\n    }\n\n    postUpdate()\n    {\n        // update the previous x and y coordinates\n        this._pX = this._x;\n        this._pY = this._y;\n\n        this.events.trigger(EVT_MOUSE_UPDATE, {\n            \"pX\": this.getPX(),\n            \"pY\": this.getPY(),\n            \"x\": this.getX(),\n            \"y\": this.getY()\n        });\n\n    }\n\n    /**\n    mousemove event handler\n    Fires a mousemove event and possibly a mousedrag event\n\n    @method onMouseMove\n    @private\n    */\n    onMouseMove(event)\n    {\n        if(!this._target instanceof Window)\n        {\n            let position = _DOM.getElementPosition(this._target);\n\n            this._x = event.clientX - position.x;\n            this._y = event.clientY - position.y;\n        }\n        else\n        {\n            this._x = event.clientX;\n            this._y = event.clientY;\n        }\n\n        this.events.trigger(EVT_MOUSE_MOVE, {\n            \"pX\": this.getPX(),\n            \"pY\": this.getPY(),\n            \"x\": this.getX(),\n            \"y\": this.getY()\n        });\n\n        if(this.isPressed()){\n            this.events.trigger(EVT_MOUSE_DRAG, {\n                \"pX\": this.getPX(),\n                \"pY\": this.getPY(),\n                \"x\": this.getX(),\n                \"y\": this.getY()\n            });\n        }\n\n        event.preventDefault();\n    }\n\n    /**\n    mouseover event handler\n    Fires a mouseover event\n\n    @method onMouseOver\n    @private\n    */\n    onMouseOver(event)\n    {\n        this.events.trigger(EVT_MOUSE_OVER);\n\n        event.preventDefault();\n    }\n\n    /**\n    mouseover event handler\n    Fires a mouseout event\n\n    @method onMouseOut\n    @private\n    */\n    onMouseOut(event)\n    {\n        this.events.trigger(EVT_MOUSE_OUT);\n\n        event.preventDefault();\n    }\n\n    /**\n    mousedown event handler\n    Fires a mousepress event and updates the pressed state\n\n    @method onMouseDown\n    @private\n    */\n    onMouseDown(event)\n    {        \n        this._pressed = true;\n\n        this._dragStartX = this.getX();\n        this._dragStartY = this.getY();\n\n        this.events.trigger(EVT_MOUSE_PRESS, event.button);\n\n        event.preventDefault();\n    }\n\n    /**\n    mouseup event handler\n    Fires a mouserelease event and updates the pressed state\n\n    @method onMouseUp\n    @private\n    */\n    onMouseUp(event)\n    {\n        this._pressed = false;\n\n        this._dragStartX = null;\n        this._dragStartY = null;\n\n        this.events.trigger(EVT_MOUSE_RELEASE);\n\n        event.preventDefault();\n    }\n\n    /**\n    cick event handler\n    Fires a mouseclick event\n\n    @method onClick\n    @private\n    */\n    onClick(event)\n    {\n        this.events.trigger(EVT_MOUSE_CLICK, event.button);\n\n        event.preventDefault();\n    }\n\n    /**\n    dblcick event handler\n    Fires a mousedblclick event\n\n    @method onDblClick\n    @private\n    */\n    onDblClick(event)\n    {        \n        this.events.trigger(EVT_MOUSE_DBLCLICK, event.button);\n\n        event.preventDefault();\n    }\n\n    /**\n    wheel event handler\n    Fires a mousewheel event\n\n    @method onWheel\n    @private\n    */\n    onWheel(event)\n    {\n        this._wheelActivated = true;\n\n        this._wheelDeltaX += event.deltaX;\n        this._wheelDeltaY += event.deltaY;\n        this._wheelDeltaZ += event.deltaZ;\n\n        this.events.trigger(EVT_MOUSE_WHEEL, event.deltaX, event.deltaY, event.deltaZ);\n\n        event.preventDefault();\n    }\n\n    /**\n    returns whether a mouse button is currently pressed or not\n\n    @method isPressed\n    @return {Boolean} True if a mouse button is currently pressed\n    */\n    isPressed()\n    {\n        return this._pressed;\n    }\n\n    /**\n    returns the current x coordinate of the mouse\n\n    @method getX\n    @return {Number} The x coordinate of the mouse position\n    */\n    getX()\n    {\n        return this._x;\n    }\n\n    /**\n    returns the current y coordinate of the mouse\n\n    @method getY\n    @return {Number} The y coordinate of the mouse position\n    */\n    getY()\n    {\n        return this._y;\n    }\n\n    /**\n    returns the previous x coordinate of the mouse\n\n    @method getPX\n    @return {Number} The x coordinate of the previous mouse position\n    */\n    getPX()\n    {\n        return this._pX;\n    }\n\n    /**\n    returns the previous y coordinate of the mouse\n\n    @method getPY\n    @return {Number} The y coordinate of the previous mouse position\n    */\n    getPY()\n    {\n        return this._pY;\n    }\n\n    /**\n    returns the x delta between the previous and current mouse positions\n\n    @method getDeltaX\n    @return {Number} The x delta value\n    */\n    getDeltaX()\n    {\n        return this._x - this._pX;\n    }\n\n    /**\n    returns the y delta between the previous and current mouse positions\n\n    @method getDeltaY\n    @return {Number} The y delta value\n    */\n    getDeltaY()\n    {\n        return this._y - this._pY;\n    }\n\n    /**\n    returns the x and y deltas between the previous and current mouse positions\n\n    @method getDelta\n    @return {Object} The x and y delta values\n    */\n    getDelta()\n    {\n        return {\n            \"x\": this.getDeltaX(),\n            \"y\": this.getDeltaY()\n        };\n    }\n\n    /**\n    returns the x offset between the current mouse position and the position at the begining of the drag\n\n    @method getDragOffsetX\n    @return {Number} The x offset value\n    */\n    getDragOffsetX()\n    {\n        if(!this.isPressed()){\n            return 0;\n        }\n\n        return this.getX() - this._dragStartX;\n    }\n\n    /**\n    returns the y offset between the current mouse position and the position at the begining of the drag\n\n    @method getDragOffsetY\n    @return {Number} The y offset value\n    */\n    getDragOffsetY()\n    {\n        if(!this.isPressed()){\n            return 0;\n        }\n\n        return this.getY() - this._dragStartY;\n    }\n\n    /**\n    returns the x and y offsets between the current mouse position and the position at the begining of the drag\n\n    @method getDragOffset\n    @return {Object} The x and y offset values\n    */\n    getDragOffset()\n    {\n        return {\n            'x': this.getDragOffsetX(),\n            'y': this.getDragOffsetY()\n        };\n    }\n\n    /**\n    helper method to check if the wheel is supported on the device\n\n    @method isWheelSupported\n    @return {Boolean} True if the wheel is supported, false otherwise\n    */\n    isWheelSupported()\n    {\n        return (Device.getType() === \"desktop\") && (window.WheelEvent !== undefined);\n    }\n\n    /**\n    helper method to check if the wheel has been rotated\n\n    @method isWheelActivated\n    @return {Boolean} True if the wheel has been rotated, false otherwise\n    */\n    isWheelActivated()\n    {\n        return this._wheelActivated;\n    }\n\n    /**\n    returns the scroll amount for the x-axis\n\n    @method getWheelDeltaX\n    @return {Number} The scroll amount for the x-axis\n    */\n    getWheelDeltaX()\n    {\n        return this._wheelDeltaX;\n    }\n\n    /**\n    returns the scroll amount for the y-axis\n\n    @method getWheelDeltaY\n    @return {Number} The scroll amount for the y-axis\n    */\n    getWheelDeltaY()\n    {\n        return this._wheelDeltaY;\n    }\n\n    /**\n    returns the scroll amount for the z-axis\n\n    @method getWheelDeltaZ\n    @return {Number} The scroll amount for the z-axis\n    */\n    getWheelDeltaZ()\n    {\n        return this._wheelDeltaZ;\n    }\n\n    /**\n    returns the scroll amounts for the x, y and z axes\n\n    @method getWheelDelta\n    @return {Object} The scroll amounts for the x, y and z axes\n    */\n    getWheelDelta()\n    {\n        return {\n            \"x\": this.getWheelDeltaX(),\n            \"y\": this.getWheelDeltaY(),\n            \"z\" :this.getWheelDeltaZ()\n        };\n    }\n}\n\n// module exports\nexport { Mouse };\n","import {_Math} from '../helpers/Math';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {getOrDefault} from '../helpers/Misc';\nimport {_DOM} from '../helpers/DOM';\nimport {Time} from '../time/Time';\n\nclass TouchObject\n{\n    /**\n     * Object that represent what defines a Touch. Touch Class returns this type of objets when events are fired.\n     * This class is used internally and is documented for consultation purpose. Users should not make new instances from it.\n     * @private\n     * @class TouchObject\n     * @constructor\n     * @param {Number} x the x coordinate of the touch\n    */\n    constructor(x, y, index)\n    {\n        /**\n        * index\n        * @property {Number} index\n        */\n        this.index = index;\n        /**\n        * x coordinate of the touch\n        * @property {Number} x\n        */\n        this.x = x;\n        /**\n        * y coordinate of the touch\n        * @property {Number} y\n        */\n        this.y = y;\n        /**\n        * pX pevious x coordinate of the touch\n        * @property {Number} pX\n        */\n        this.pX = this.x;\n        /**\n        * pY previous y coordinate of the touch\n        * @property {Number} pY\n        */\n        this.pY = this.y;\n        /**\n        * id used internally to manage the touch list in Touch Class\n        * @property {Object} id\n        */\n        this.id = undefined;\n        /**\n        * xDelta delta on x coordinate (difference between pevious and current x)\n        * @property {Number} xDelta\n        */\n        this.xDelta = 0;\n        /**\n        * yDelta delta on y coordinate (difference between pevious and current y)\n        * @property {Number} yDelta\n        */\n        this.yDelta = 0;\n        /**\n        * startX x coordinate where the touch began\n        * @property {Number} startX\n        */\n        this.startX = this.x;\n        /**\n        * startY x coordinate where the touch began\n        * @property {Number} startY\n        */\n        this.startY = this.y;\n        /**\n        * offset on the X coordinate (difference between startX and current x)\n        * @property {Number} offsetX\n        */\n        this.offsetX = 0;\n        /**\n        * offset on the Y coordinate (difference between startY and current y)\n        * @property {Number} offsetY\n        */\n        this.offsetY = 0;\n    }\n\n    /**\n    * Set a new x coordinate and compute the new xDelta and offsetX\n    * @method setX\n    * @param {Object} x\n    */\n    setX(x)\n    {\n\n        //this.pX = this.x;\n\n        this.x = x;\n        this.xDelta = this.x - this.pX;\n\n        this.offsetX = this.x - this.startX;\n    }\n\n    /**\n    * Set a new y coordinate and compute the new yDelta and offsetY\n    * @method setY\n    * @param {Object} y\n    */\n    setY(y)\n    {\n\n        //this.pY = this.y;\n\n        this.y = y;\n        this.yDelta = this.y - this.pY;\n\n        this.offsetY = this.y - this.startY;\n    }\n\n    setPX()\n    {\n        this.pX = this.x;\n    }\n\n    setPY()\n    {\n        this.pY = this.y;\n    }\n\n}\n\n/**\n * Fired when a touch starts\n * @event touchstart\n */\nconst EVT_TOUCH_START = 'touchstart';\n\n/**\n * Fired when a touch ends\n * @event touchend\n */\nconst EVT_TOUCH_END = 'touchend';\n\n/**\n * Fired when a touch moved\n * @event touchmoved\n */\nconst EVT_TOUCH_MOVED = 'touchmoved';\n\n/**\n * Fired when the tap count changed\n * @event tapchanged\n */\nconst EVT_TAP_CHANGED = 'tapchanged';\n\n/**\n * Fired when the pressed state changed (ie a touch is on screen)\n * @event pressedchanged\n */\nconst EVT_PRESSED_CHANGED = 'pressedchanged';\n\nclass Touch extends Component\n{\n    /**\n     * Touch give an interface to access the multitouch events of the device. It holds a list of currently active touches and various ways to access their coordinates.\n     * \n     * @example\n     *     //this is how to use events in a user's script\n     *     function script()\n     *     {\n     *        \n     *        var M;\n     *        var R;\n     *        \n     *        var camera;\n     *        var cube;\n     *        var light;\n     *    \n     *        var y = 0;\n     *        var speed = 0;\n     *    \n     *        var touch;\n     *        \n     *        this.setup = function()\n     *        {\n     *            M = this.getContext();\n     *            R = M.addComponent( new Mobilizing.Renderer3D() );\n     *            \n     *            touch = M.addComponent(new Mobilizing.input.Touch({\"target\": R.canvas}));\n     *            touch.setup();//set it up\n     *            touch.on();//active it\n     *            \n     *            //construct a default perspective camera\n     *            camera = new Mobilizing.Camera();\n     *            camera.setFarPlane(10000);\n     *            camera.setToPixel();\n     *            R.addCamera(camera);\n     *    \n     *            //make a light\n     *            light = new Mobilizing.Light();\n     *            light.transform.setLocalPosition(500,-100,500);\n     *            light.setDistance(5000);\n     *            R.addToCurrentScene(light);\n     *    \n     *            //make a cube\n     *            cube = new Mobilizing.Mesh({primitive:\"box\", width:1, height:1, depth:1});\n     *            cube.transform.setLocalPosition(0,0,0);\n     *            cube.transform.setLocalScale(50);\n     *            R.addToCurrentScene(cube);\n     *        };\n     *    \n     *        this.update = function()\n     *        {\n     *            if(touch.pressed){\n     *    \n     *                cube.transform.setLocalPosition(\n     *                     touch.getX(0),\n     *                    - touch.getY(0),\n     *                    0);\n     *            }\n     *        };\n     *    };\n     * \n     * @class Touch\n     * @constructor\n     * @extends Component\n     * @param {Object} params Config parameters\n     * @param {DOMElement} params.target The DOM element that will be used to attach touch events on\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this._target = getOrDefault(params, \"target\", window);\n        this._time = new Time();\n    }\n\n    /**\n    * Initialization method\n    * @method setup Setup\n    */\n    setup()\n    {\n        //!!this.getContext() is not already available in constructor as setContext() is called after creation!!\n        let context = this.getContext();\n\n        context.addComponent(this._time);\n        this._time.setup();\n        this._time.on();\n\n        /**\n        Gives the number of touch currently active\n        @property {Number} count\n        */\n        this.count = 0;\n        /**\n        true if the active touch on screen > 1, false otherwise\n        @property {Boolean} pressed\n        */\n        this.pressed = false;\n\n        this.touches = {};\n\n        this.taps = 0;\n        this.tapsMaxInterval = 500; //sec but depends on timeScale (!?)\n        this.oldTapTime = 0;\n\n        this.pinchTouches = [];\n        this.pinchStart = 0;\n        this.pinch = 0;\n        this.pinchActive = false;\n\n        this.touchState;\n        this.touchDown;\n        this.touchUp;\n    }\n\n    on()\n    {\n        super.on();\n\n        this._target.addEventListener( \"touchstart\", event => this.onTouchStart(event));\n\n        this._target.addEventListener( \"touchend\", event => this.onTouchEnd(event));\n        this._target.addEventListener( \"touchcancel\", event => this.onTouchEnd(event));\n        this._target.addEventListener( \"touchleave\", event => this.onTouchEnd(event));\n\n        this._target.addEventListener( \"touchmove\", event => this.onTouchMove(event));\n    }\n\n    off()\n    {\n        super.off();\n\n        this._target.removeEventListener( \"touchstart\", event => this.onTouchStart(event));\n\n        this._target.removeEventListener( \"touchend\", event => this.onTouchEnd(event));\n        this._target.removeEventListener( \"touchcancel\", event => this.onTouchEnd(event));\n        this._target.removeEventListener( \"touchleave\", event => this.onTouchEnd(event));\n\n        this._target.removeEventListener( \"touchmove\", event => this.onTouchMove(event));\n    }\n\n\n    /**\n     * @method update\n     */\n    update()\n    {\n\n        if (this.pressed && !this.touchState)\n        {\n            this.touchDown = true;\n        }\n        else\n        {\n            this.touchDown = false;\n        }\n        if (!this.pressed && this.touchState)\n        {\n            this.touchUp = true;\n        }\n        else\n        {\n            this.touchUp = false;\n        }\n        this.touchState = this.pressed;\n\n        for(let obj in this.touches)\n        {\n            this.touches[obj].setPX();\n            this.touches[obj].setPY();\n        }\n    }\n\n    /**\n     * onTouchStart listener\n     * Manage a new touch and organize it in the main touch list Input.touches\n     *\n     * @method onTouchStart\n     * @private\n    */\n    onTouchStart(event)\n    {\n        let context = this.getContext();\n\n        let position = _DOM.getElementPosition(this._target);\n\n        let newTouch = null;\n\n        if( event.changedTouches !== null && event.changedTouches !== undefined)\n        {//touch\n\n            for(let i=0; i<event.changedTouches.length; i++)\n            {\n                let touch = event.changedTouches[i];\n\n                if( !(touch.identifier in this.touches) )\n                {//no touch in memory, build it\n\n                    var x = touch.pageX - position.x;\n                    var y = touch.pageY - position.x;\n\n                    newTouch = new TouchObject(x, y, this.count);\n                    debug.log(\"newTouch\",newTouch);\n\n                    newTouch.setX( x );\n                    newTouch.setY( y );\n                    newTouch.id = touch.identifier;\n\n                    newTouch.up = false; //JON\n                    newTouch.down = true; //JON\n\n                    //à laisser ici!\n                    this.touches[touch.identifier] = newTouch;\n\n                    this.count += 1;\n\n                }\n                else\n                {//touch is already there, update\n\n                    let touch = this.touches[touch.identifier];\n\n                    let x = touch.pageX - position.x;\n                    let y = touch.pageY - position.x;\n\n                    touch.setX( x );\n                    touch.setY( y );\n                }\n\n                //Events\n                this.events.trigger(EVT_TOUCH_START, newTouch);\n            }\n        }\n\n        //tap management, add a tap after a time interval\n        if(this._time.getTime() - this.oldTapTime < this.tapsMaxInterval)\n        {\n            this.taps += 1;\n            //Events\n            this.events.trigger(EVT_TAP_CHANGED, this.taps);\n        }\n        else\n        {\n            this.taps = 1;\n            //Events\n            this.events.trigger(EVT_TAP_CHANGED, this.taps);\n        }\n        //current time memory for next tap\n        this.oldTapTime = this._time.getTime();\n\n        //pressed state\n        this.pressed = true;\n        this.events.trigger(EVT_PRESSED_CHANGED, this.pressed);\n\n        //avoid the browser's defaults interactions\n        event.preventDefault();\n    }\n\n    /**\n     * onTouchEnd listener\n     * \n     * Manage a touch removal and organize it in the main touch list Input.touches\n     * \n     * @method onTouchEnd\n     * @private\n    */\n    onTouchEnd(event)\n    {\n        if( event.changedTouches !== null && event.changedTouches !== undefined ) {//touch\n\n            for(let i=0; i<event.changedTouches.length; i++)\n            {\n\n                let touch = event.changedTouches[i];\n\n                if(touch.identifier in this.touches) {//touch is there!\n\n                    //Events\n                    this.events.trigger(EVT_TOUCH_END, this.touches[touch.identifier]);\n                    //erase\n                    delete this.touches[touch.identifier];\n                    this.count -= 1;\n                }\n            }\n\n            //reset pinch value when no fingers\n            if(this.count <= 1)\n            {\n                this.pinchTouches = [];\n                this.pinchStart = 0;\n                this.pinch = 0;\n                this.pinchActive = false;\n            }\n\n        }\n\n        if(this.count === 0)\n        {\n            this.pressed = false;\n            this.events.trigger(EVT_PRESSED_CHANGED, this.pressed);\n        }\n\n        event.preventDefault();\n    }\n\n    /** \n     * onTouchMove listener\n     *\n     * Manage a touch move and organize it in the main touch list Input.touches\n     *\n     * @method onTouchMove\n     * @private\n    */\n    onTouchMove(event)\n    {\n        let position = _DOM.getElementPosition(this._target);\n\n        if( event.changedTouches !== null && event.changedTouches !== undefined ) {//touch\n\n            for(let i=0; i<event.changedTouches.length; i++)\n            {\n\n                let touch = event.changedTouches[i];\n\n                if(touch.identifier in this.touches) {//touch is there!\n\n                    let myTouch = this.touches[touch.identifier];\n\n                    var x = touch.pageX - position.x;\n                    var y = touch.pageY - position.y;\n\n                    myTouch.setX( x );\n                    myTouch.setY( y );\n\n                    this.events.trigger(EVT_TOUCH_MOVED, myTouch);\n                }\n            }\n        }\n\n        this.taps = 0;\n\n        event.preventDefault();\n    }\n\n    /**\n     * returns the x coordinate of the touch given as paramater\n     *\n     * @method getX\n     * @param {Number:Int} index the index of the touch to get x coordinate from\n     * @return {Number:Int} x coordinate of the touch if active, -1 if not active\n    */\n    getX(index)\n    {\n        let val;\n\n        if(typeof index === \"number\")\n        {\n            for(let obj in this.touches)\n            {\n                if(this.touches[obj].index === index)\n                {\n                    val = this.touches[obj].x;\n                }\n            }\n        }\n        return val;\n    }\n\n    /**\n     * returns the y coordinate of the touch given as paramater\n     *\n     * @method getY\n     * @param {Number:Int} index the index of the touch to get y coordinate from\n     * @return {Number:Int} y coordinate of the touch if active, -1 if not active\n    */\n    getY(index)\n    {\n        let val;\n\n        if(typeof index === \"number\")\n        {\n            for(let obj in this.touches)\n            {\n                if(this.touches[obj].index === index)\n                {\n                    val = this.touches[obj].y;\n                }\n            }\n        }\n        return val;\n    }\n\n    /**\n     * returns a TouchObject\n     *\n     * @method get\n     * @param {Number:Int} index the index of the touchObject to get\n     * @return {TouchObject}\n    */\n    get(index)\n    {\n        let val;\n\n        if(typeof index === \"number\")\n        {\n            for(let obj in this.touches)\n            {\n                if(this.touches[obj].index === index)\n                {\n                    val = this.touches[obj];\n                }\n            }\n        }\n        return val;\n    }\n\n    /**\n     * Returns a Number that represents the coordinate of the touch delta,\n     * that is the numerical difference between the previous state in time and the actual one.\n     *\n     * @method getDeltaX\n     * @param {Number:Int || Object:Touch} index the index of the touch to get x coordinate from, or the touch object\n     * @return {Number:Int}, the x coordinates of the touch delta;\n    */\n    getDeltaX(index)\n    {\n        let val;\n\n        if(typeof index === \"number\")\n        {\n\n            for(let obj in this.touches)\n            {\n\n                let touch = this.touches[obj];\n\n                if(touch.index === index)\n                {\n\n                    val = touch.xDelta;\n                }\n            }\n        }\n        return val;\n    }\n\n    /**\n     * Returns a Number that represents the coordinate of the touch delta,\n     * that is the numerical difference between the previous state in time and the actual one.\n     *\n     * @method getDeltaY\n     * @param {Number:Int || Object:Touch} index the index of the touch to get y coordinate from, or the touch object\n     * @return {Number:Int}, the y coordinates of the touch delta;\n    */\n    getDeltaY(index)\n    {\n        let val;\n\n        if(typeof index === \"number\")\n        {\n\n            for(let obj in this.touches)\n            {\n\n                let touch = this.touches[obj];\n\n                if(touch.index === index)\n                {\n\n                    val = touch.yDelta;\n                }\n            }\n        }\n        return val;\n    }\n\n    /**\n     * Returns an object {x:Number, y:Number} that represents the coordinate of the touch delta,\n     * that is the numerical difference between the previous state in time and the actual one.\n     *\n     * @method getDelta\n     * @param {Number:Int || Object:Touch} index the index of the touch to get coordinates from, or the touch object\n     * @return {Object} {x:Number, y:Number}, the x & y coordinates of the touch delta;\n    */\n    getDelta(index)\n    {\n        let val;\n\n        if(typeof index === \"number\")\n        {\n\n            for(let obj in this.touches)\n            {\n\n                let touch = this.touches[obj];\n\n                if(touch.index === index)\n                {\n\n                    val = {\"x\":touch.xDelta, \"y\":touch.yDelta};\n                }\n            }\n        }\n        return val;\n    }\n\n    /**\n     * Returns a Number that represents the x coordinate of the touch offset,\n     * that is the numerical difference between the start point of the touch and the actual one.\n     *\n     * @method getOffsetX\n     * @param {Number:Int || Object:Touch} index the index of the touch to get x offset coordinate from, or the touch object\n     * @return {Number} the x coordinates of the touch offset;\n    */\n    getOffsetX(index)\n    {\n        let val;\n\n        for(let obj in this.touches)\n        {\n\n            let touch = this.touches[obj];\n\n            if(touch.index === index)\n            {\n                val = touch.offsetX;\n            }\n        }\n        return val;\n    }\n\n    /**\n     * Returns a Number that represents the y coordinate of the touch offset,\n     * that is the numerical difference between the start point of the touch and the actual one.\n     *\n     * @method getOffsetY\n     * @param {Number:Int || Object:Touch} index the index of the touch to get y offset coordinate from, or the touch object\n     * @return {Number} the y coordinates of the touch offset;\n    */\n    getOffsetY(index)\n    {\n        let val;\n\n        for(let obj in this.touches)\n        {\n\n            let touch = this.touches[obj];\n\n            if(touch.index === index)\n            {\n                val = touch.offsetY;\n            }\n        }\n        return val;\n    }\n\n    /**\n     * Returns an object {x:Number, y:Number} that represents the coordinate of the touch offset,\n     * that is the numerical difference between the start point of the touch and the actual one.\n     *\n     * @method getOffset\n     * @param {Number:Int || Object:Touch} index the index of the touch to get offset coordinate from, or the touch object\n     * @return {Object} {x:Number, y:Number}, the x & y coordinates of the touch offset;\n    */\n    getOffset(index)\n    {\n        let val;\n\n        for(let obj in this.touches)\n        {\n\n            let touch = this.touches[obj];\n\n            if(touch.index === index)\n            {\n                val = {\"x\":touch.offsetX, \"y\":touch.offsetY};\n            }\n        }\n        return val;\n    }\n    /**\n     *Returns a Number that represents the pinch touch move,\n     *that is the numerical difference between the start point of 2 touches and the actual one.\n     *\n     * @method getPinch\n     * @return {Number} the pinch delta value;\n    */\n    getPinch()\n    {\n\n        let touchNb = 0;\n\n        //We must use a min of 2 touches\n        if(this.count >= 2)\n        {\n            //if don't have the touches, find and save them, else compute start point\n            if(this.pinchTouches[1] === undefined)\n            {\n                //loop through touches to find at least 2\n                for(let obj in this.touches)\n                {\n                    if(touchNb < 2)\n                    {\n                        //gather 2 touch if not already in memory\n                        this.pinchTouches[touchNb] = this.touches[obj];\n                        touchNb++;\n                    }\n                    if(touchNb === 2)\n                    {\n\n                        this.pinchActive = true;\n                        //we have 2 touches in memory, compute startpoint\n                        this.pinchStart = _Math.dist(\n                            this.pinchTouches[0].x,\n                            this.pinchTouches[0].y,\n                            this.pinchTouches[1].x,\n                            this.pinchTouches[1].y);\n\n                        //debug.log(\"pinchStart at break\",this.pinchStart);\n                        break;//2 touches found, break loop;\n                    }\n                }\n            }\n\n            //pinch computation's ready to be done\n            this.pinch =\n                _Math.dist(\n                this.pinchTouches[0].x,\n                this.pinchTouches[0].y,\n                this.pinchTouches[1].x,\n                this.pinchTouches[1].y)\n                - this.pinchStart;\n\n            //we have 2 touches in memory, compute startpoint\n            this.pinchStart = _Math.dist(\n                this.pinchTouches[0].x,\n                this.pinchTouches[0].y,\n                this.pinchTouches[1].x,\n                this.pinchTouches[1].y);\n        }\n        else\n        {\n            this.pinchStart = 0;\n            this.pinch = 0;\n            this.pinchTouches = [];\n        }\n\n        return this.pinch;\n    }\n}\n\n// module exports\nexport { Touch };\n","import {Vector3} from '../core/Vector3';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {Device} from '../helpers/Device';\n\n/**\n * Fired when a new acceleration is available\n * @event acceleration\n */\nconst EVT_ACC = 'acceleration';\n\n/**\n * Fired when a new acceleration including gravity is available\n * @event accelerationIncludingGravity\n */\nconst EVT_ACC_GRAVITY = 'accelerationIncludingGravity';\n\n/**\n * Fired when a new gravity vector is available\n * @event accelerationGravityVector\n */\nconst EVT_ACC_GRAVITY_VECTOR = 'accelerationGravityVector';\n\n/**\n * Fired when a new rotationrate data is available\n * @event rotationrate\n */\nconst EVT_ROTATION_RATE = 'rotationrate';\n\nclass Motion extends Component\n{\n    /**\n     * @class Motion\n     * @constructor\n     * Motion gives access to the embbeded accelerometers data of you device.\n    */\n    constructor(param){\n        super(param);\n\n        /**\n         * true if the acceloremeters are available on the device, false otherwise\n         * @property {Boolean} _accAvailable\n        */\n        this._accAvailable = window.DeviceMotionEvent;\n    }\n\n    setup(){\n\n        this.rotationRate = new Vector3();\n        this.acc = new Vector3();\n        this.userAcc = new Vector3();\n\n        this.smoothedAcc = new Vector3();\n\n        this.accel = [0, 0, 0];\n        this.kFilteringFactor = 0.07;\n        this.gravityVector = new Vector3();\n    }\n\n    on(){\n        if(this._accAvailable){\n            super.on();\n            \n            window.addEventListener( 'devicemotion', event => this.onDeviceMotion(event) );\n\n        }else{\n            debug.info(\"this device doesn't have acceloremeters\");\n        }\n    }\n\n    off(){\n        super.off();\n\n        window.removeEventListener( 'devicemotion', event => this.onDeviceMotion(event) );\n    }\n\n    onDeviceMotion(event){\n        \n        //Chrome manage everything reversed to Safari. We use Safari as 1, Chrome as -1\n        let reverse = 1;\n\n        if(Device.getOS() === \"Android\"){\n            reverse = -1;\n        }\n\n        if (event.acceleration)\n        {\n            this.userAcc.x = event.acceleration.x * reverse;\n            this.userAcc.y = event.acceleration.y * reverse;\n            this.userAcc.z = event.acceleration.z * reverse;\n\n            //if the device doesn't support acceleration without gravity\n            if(event.acceleration.x === null || event.acceleration.x === undefined){\n                this.computeUserAcc();\n            }\n            this.events.trigger(EVT_ACC, this.userAcc);\n        }\n\n        if (event.accelerationIncludingGravity)\n        {\n            this.acc.x = event.accelerationIncludingGravity.x * reverse;\n            this.acc.y = event.accelerationIncludingGravity.y * reverse;\n            this.acc.z = event.accelerationIncludingGravity.z * reverse;\n\n            //propagate event to user script\n            this.events.trigger(EVT_ACC_GRAVITY, this.acc);\n\n            //propagate custom event to user script\n            this.events.trigger(EVT_ACC_GRAVITY_VECTOR, () => {\n                this.computeGravityVector();\n                return this.gravityVector;\n            });\n        }\n\n        if (event.rotationRate)\n        {\n            this.rotationRate.x = event.rotationRate.alpha;\n            this.rotationRate.y = event.rotationRate.beta;\n            this.rotationRate.z = event.rotationRate.gamma;\n\n            //propagate custom event to user script\n            this.events.trigger(EVT_ROTATION_RATE, this.rotationRate);\n        }\n    }\n\n    /**\n    * Compute the values for the acc on devices that gives \"undefined\" for the event.acceleration prop (some Android)\n    * @private\n    * @method computeUserAcc\n    */\n    computeUserAcc(){\n\n        this.accel[0] = this.acc.x * this.kFilteringFactor + this.accel[0] * (1.0 - this.kFilteringFactor);\n        this.accel[1] = this.acc.y * this.kFilteringFactor + this.accel[1] * (1.0 - this.kFilteringFactor);\n        this.accel[2] = this.acc.z * this.kFilteringFactor + this.accel[2] * (1.0 - this.kFilteringFactor);\n\n        /*debug.log( this.acc.x - this.accel[0],\n                        this.acc.y - this.accel[1],\n                        this.acc.z - this.accel[2]);*/\n\n        this.userAcc.x = this.acc.x - this.accel[0];\n        this.userAcc.y = this.acc.y - this.accel[1];\n        this.userAcc.z = this.acc.z - this.accel[2];\n    }\n\n    /**\n    * Method to compute the gravity orientation vector based on accel including gravity.\n    * The result can also be get through the event onAccelerationGravityVector\n    * \n    * @method computeGravityVector\n    * @private\n    */\n    computeGravityVector()\n    {\n        this.accel[0] = this.acc.x * this.kFilteringFactor + this.accel[0] * (1.0 - this.kFilteringFactor);\n        this.accel[1] = this.acc.y * this.kFilteringFactor + this.accel[1] * (1.0 - this.kFilteringFactor);\n        this.accel[2] = this.acc.z * this.kFilteringFactor + this.accel[2] * (1.0 - this.kFilteringFactor);\n\n        this.gravityVector.z = this.accel[2] *( 360 /(2 * Math.PI) ) *1.1;\n        this.gravityVector.x = this.accel[1] *( 360 /(2 * Math.PI) ) *1.1;\n        this.gravityVector.y = Math.atan2(this.accel[0], this.accel[1]) * (180.0 / Math.PI) ;\n\n    }\n\n    /**\n     * Method to get the accel values without gravity.\n     * The result can also be get through the event onAcceleration\n     * \n     * @method getUserAcc\n     * @return {Object} userAcc object composed by x, y & z components\n    */\n    getUserAcc(){\n        return this.userAcc;\n    }\n\n    /**\n     * Method to get the accel values including gravity.\n     * The result can also be get through the event onAccelerationIncludingGravity\n     * \n     * @method getAcc\n     * @return {Object} acc object composed by x, y & z components\n    */\n    getAcc(){\n        return this.acc;\n    }\n\n    /**\n     * Method to get the gravity orientation vector based on accel including gravity.\n     * The result can also be get through the event onAccelerationGravityVector\n     * \n     * @method getGravityVector\n     * @return {Object} gravityVector object composed by x, y & z components\n    */\n    getGravityVector(){\n        return this.gravityVector;\n    }\n\n    /**\n     * Method to get the filtered accel including gravity.\n     * \n     * @method getSmoothedAcc\n     * @param {Number} factor The number to use for the filtering aglorithm (0.07 gives good results)\n     * @return {Object} smoothedAcc object composed by x, y & z components\n    */\n    getSmoothedAcc(factor)\n    {\n        this.smoothedAcc.x = this.acc.x * factor + this.smoothedAcc.x * (1.0 - factor);\n        this.smoothedAcc.y = this.acc.y * factor + this.smoothedAcc.y * (1.0 - factor);\n        this.smoothedAcc.z = this.acc.z * factor + this.smoothedAcc.z * (1.0 - factor);\n        return this.smoothedAcc;\n    }\n}\n\n// module exports\nexport { Motion };\n","import {Euler} from '../core/Euler';\nimport {Vector3} from '../core/Vector3';\nimport {Matrix4} from '../core/Matrix4';\nimport {Quaternion} from '../core/Quaternion';\nimport {_Math} from '../helpers/Math';\nimport {Component} from '../Component';\n\n/**\n * Fired when a new orientation is available\n * @event deviceorientation\n */\nconst EVT_DEVICE_ORIENTATION = \"deviceorientation\";\n\n/**\n * Fired when calibration is required\n * @event compassneedscalibration\n */\nconst EVT_COMPASS_CALIBRATION = \"compassneedscalibration\";\n\nclass Orientation extends Component\n{\n    /**\n     * Uses built-in compass and/or gyroscope to produce orientation Data. Some heplers functions are in there to generate quarternion that can be applied on a camera or a 3D object's transform.\n     * \n     * @class Orientation\n     * @extends Component\n     * @constructor\n    */\n    constructor(params){\n        super(params)\n\n        /**\n        * true if the magnetometer/compass is available on the device, false otherwise\n        * @property {Boolean} compassAvailable\n        */\n        this.compassAvailable = window.DeviceOrientationEvent;\n    }\n\n    setup(){\n\n        this.compass = new Vector3();\n\n        this.deviceRotationMatrix = new Matrix4();\n        this.deviceHeading = null;\n        this.deviceAttitude = null;\n        this.deviceBank = null;\n    }\n\n    on(){\n        super.on();\n\n        window.addEventListener(\"deviceorientation\", event => this.onDeviceOrientation(event) );\n        window.addEventListener(\"compassneedscalibration\", event => this.onCompassCalibration(event));\n    }\n\n    off(){\n        super.off();\n\n        window.removeEventListener(\"deviceorientation\", event => this.onDeviceOrientation(event) );\n        window.removeEventListener(\"compassneedscalibration\", event => this.onCompassCalibration(event));\n    }\n\n    /**\n     * Returns the compass/gyro current raw values.\n     * This can also be get with the onDeviceOrientation event from the user script\n     * \n     * @method getDeviceOrientation\n     * @return {Object} compass object with x, y & z components\n    */\n    getDeviceOrientation()\n    {\n        return this.compass;       \n    }\n\n    /**\n    * Creates a Quaternion that matches the device's current orientation. Calculated in radians.\n    * @private\n    * @method createGyroQuaternion\n    * @param {Number} alpha the angle to use for the quaternion creation\n    * @param {Number} beta  the angle to use for the quaternion creation\n    * @param {Number} gamma the angle to use for the quaternion creation\n    * @param {Object} screenOrientation orientation of the screen in degree! Can be very different depending on the plateform...\n    * @author Rich Tibbett, https://github.com/richtr/threeVR\n    */\n    createGyroQuaternion(alpha, beta, gamma, screenOrientation){\n\n        if ( alpha !== 0 && beta !== 0 && gamma !== 0) {\n\n            var finalQuaternion = new Quaternion();\n            var deviceEuler = new Euler();\n            var screenTransform = new Quaternion();\n            var worldTransform = new Quaternion( - Math.sqrt(0.5), 0, 0, Math.sqrt(0.5) ); // - PI/2 around the x-axis\n            var minusHalfAngle = 0;\n\n            deviceEuler.set( beta, alpha, -gamma, 'YXZ' );\n            finalQuaternion.setFromEuler( deviceEuler );\n            minusHalfAngle = -screenOrientation / 2;\n\n            screenTransform.set( 0, Math.sin( minusHalfAngle ), 0, Math.cos( minusHalfAngle ) );\n\n            finalQuaternion.multiply( screenTransform );\n            finalQuaternion.multiply( worldTransform );\n\n            return finalQuaternion;\n        }else{\n            return new Quaternion(0,0,0);//we have nothing to give\n        }\n    }\n\n    /**\n     * Can be used in the transform of a perspective camera to produce a \"blind camera\" effect : move the screen around to frame a part of the current scene like if you were using a camera.\n     * \n     * @method getGyroQuaternion\n     */\n    getGyroQuaternion()\n    {\n        if(this.compassAvailable)\n        {\n            if(this.compass.alpha)\n            {\n                var quaternion = this.createGyroQuaternion(\n                    _Math.degToRad(this.compass.alpha),\n                    _Math.degToRad(this.compass.beta),\n                    _Math.degToRad(this.compass.gamma),\n                    _Math.degToRad(window.orientation || 0)\n                );\n                return quaternion;\n            }\n        }\n    }\n\n    /**\n    * compass calibration event callback\n    * @private\n    * @method compassCalibrationHandler\n    * @param {Object} event\n    */\n    onCompassCalibration(event)\n    {\n        //alert(\"onCompassCalibration call\", event);\n        this.events.trigger(EVT_COMPASS_CALIBRATION, event);\n    }\n\n    /**\n    * callback used to access compass event.\n    * \n    * @private\n    * @method onDeviceorientation\n    * @param {Object} event\n    */\n    onDeviceOrientation(event)\n    {\n        this.compass.alpha = event.alpha;//x\n        this.compass.beta = event.beta;//y\n        this.compass.gamma = event.gamma;//z\n\n        //this.compass.heading = event.compassHeading || event.webkitCompassHeading || event.mozCompassHeading || event.ieCompassHeading;// || -event.alpha;\n\n        //When the device doesn't generate a heading information, find a substitute.\n        if (event.webkitCompassHeading)\n        {\n            this.compass.heading = event.webkitCompassHeading;\n        }\n        else\n        {\n            this.compass.heading =-event.alpha;\n        }\n\n        this.events.trigger(EVT_DEVICE_ORIENTATION, this.compass);\n    }\n\n    //FIXME (may be garbage code...)\n    computeRotationMatrix( alpha, beta, gamma )\n    {\n\n        var _x = beta  ? _Math.degToRad(beta)  : 0; // beta value\n        var _y = gamma ? _Math.degToRad(gamma) : 0; // gamma value\n        var _z = alpha ? _Math.degToRad(alpha) : 0; // alpha value\n\n        var cX = Math.cos( _x );\n        var cY = Math.cos( _y );\n        var cZ = Math.cos( _z );\n        var sX = Math.sin( _x );\n        var sY = Math.sin( _y );\n        var sZ = Math.sin( _z );\n\n        //\n        // ZXY rotation matrix construction.\n        //\n\n        var m11 = cZ * cY - sZ * sX * sY;\n        var m12 = - cX * sZ;\n        var m13 = cY * sZ * sX + cZ * sY;\n\n        var m21 = cY * sZ + cZ * sX * sY;\n        var m22 = cZ * cX;\n        var m23 = sZ * sY - cZ * cY * sX;\n\n        var m31 = - cX * sY;\n        var m32 = sX;\n        var m33 = cX * cY;\n\n        this.deviceRotationMatrix.set(\n            m11,    m21,    m31, 0,\n            m12,    m22,    m32, 0,\n            m13,    m23,    m33, 0,\n            0,      0,      0,   1\n        );\n\n        if (m12 > 0.998) { // singularity at north pole\n            this.deviceHeading = Math.atan2(m31,m33);\n            this.deviceAttitude = Math.PI/2;\n            this.deviceBank = 0;\n            return;\n        }\n        if (m12 < -0.998) { // singularity at south pole\n            this.deviceHeading = Math.atan2(m31,m33);\n            this.deviceAttitude = -Math.PI/2;\n            this.deviceBank = 0;\n            return;\n        }\n\n        this.deviceHeading = Math.atan2(-m13,m11);\n        this.deviceBank = Math.atan2(-m32,m22);\n        this.deviceAttitude = Math.asin(m12);\n    }\n\n    updateDeviceRotationMatrix(){\n        this.computeRotationMatrix(this.compass.alpha, this.compass.beta, this.compass.gamma);\n    }\n\n    getDeviceRotationMatrix() {\n        this.updateDeviceRotationMatrix();\n        return this.deviceRotationMatrix;\n    }\n}\n\n// module exports\nexport { Orientation };\n","import {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {_Math} from '../helpers/Math';\n\n/**\n * Fired when the location has been updated\n * @event locationupdated\n */\nconst EVT_LOC_UPDATED = \"locationupdated\";\n\n/**\n * Fired when the location update generated an error\n * @event locationerror\n */\nconst EVT_LOC_ERROR = \"locationerror\";\n\nclass GPS extends Component\n{\n    /**\n     * @class GPS\n     * @constructor\n     * \n     * @param {Object} params Config parameters\n     * @param {Object} params.context the Mobilizing context this Input instance is linked to\n     * @param {Boolean} params.enableHighAccuracy Boolean to activate accurate location (eats more battery and takes time)\n     * @param {Number} params.maximumAge Number of millisecond to define the maximum age of the geolocation data (default = 500000)\n     * @param {Number} params.timeout timeout of the location service in millisecond\n     */\n    constructor(params)\n    {\n        super(params)\n\n        /**\n        * Accurate location (eats more battery and takes time)\n        * @private\n        * @property {Boolean} _enableHighAccuracy\n        */\n        this._enableHighAccuracy = getOrDefault(params, \"enableHighAccuracy\", false);\n\n        /**\n        * Number of millisecond to define the maximum age of the geolocation data\n        * @private\n        * @property {Number} _maximumAge\n        */\n        this._maximumAge = getOrDefault(params, \"maximumAge\", undefined);\n\n        /**\n        * Timeout of the location service in millisecond\n        * @private\n        * @property {Number} _timeout\n        */\n        this._timeout = getOrDefault(params, \"timeout\", undefined);\n\n        /**\n         * true if the GPS is available on the device, false otherwise\n         * @private\n         * @property {Boolean} _GPSAvailable\n        */\n        this._GPSAvailable = (navigator !== undefined) && (\"geolocation\" in navigator);\n    }\n\n    /**\n    * Set the GPS up.\n    * @method setup\n    */\n    setup()\n    {\n        /**\n         * Object containing the informations given by the GPS. Used internally.\n         * @property {Object} _location\n         * @private\n        */\n        this._location = {\n            latitude : null,\n            longitude : null,\n            altitude : null,\n            accuracy: null,\n            altitudeAccuracy : null,\n            heading : null,\n            speed : null,\n            timestamp : null\n        };\n\n        this._watchID;\n    }\n\n    /**\n    * Activates the component\n    * @method on\n    */\n    on()\n    {\n        if(this._GPSAvailable)\n        {\n            super.on();\n\n            let positionOptions = {\n                enableHighAccuracy: this._enableHighAccuracy,\n                timeout: this._timeout,\n                maximumAge: this._maximumAge\n            };\n\n            this._watchID = navigator.geolocation.watchPosition(\n                event => this.updateLocationCallBack(event),\n                event => this.updateLocationErrorCallBack(event),\n                positionOptions\n            );\n        }\n        else\n        {\n            debug.info(\"this device has no GPS!\");\n        }\n    }\n\n    /**\n    * Deactivate the component\n    * @method off\n    */\n    off()\n    {\n        super.off();\n\n        navigator.geolocation.clearWatch(this._watchID);\n    }\n\n    /**\n    * Enable HighAccuracy. Requieres to set the component off once then to set it on again to use the new value.\n    * @method setHighAccuracy\n    * @param {Boolean} val Enable or not high accuracy\n    */\n    setEnableHighAccuracy(val)\n    {\n        this._enableHighAccuracy = val;\n    }\n\n    /**\n    * Set the time out for location update. Requieres to set the component off once then to set it again on to use the new value.\n    * @method setTimeout\n    * @param {Number} val the new value\n    */\n    setTimeout(val)\n    {\n        this._timeout = val;\n    }\n\n    /**\n    * Set the maximum age of a location data. Requieres to set the component off once then to set it on again to use the new value.\n    * @method setMaximumAge\n    * @param {Number} val the new value\n    */\n    setMaximumAge(val)\n    {\n        this._maximumAge = val;\n    }\n\n    /**\n      * returns the most recent location data. Location service MUST be activated on the device, or errors will get out from the callbacks!\n      * The return objects contains the standard HTML5 properties for geolocation :\n      * \n      *     location.longitude\n      *     location.latitude\n      *     location.altitude\n      *     location.accuracy\n      *     location.altitudeAccuracy\n      *     location.heading\n      *     location.speed\n      *     location.timestamp\n      * \n      * @method getLocation\n      * @return {Object} the location object updated with the most recent data.\n      */\n    getLocation()\n    {\n        if(this._active){\n            return this._location;\n        }else{\n            debug.warn(\"geolocation is off, turn it on with context.input.setGeolocationStatus(true);\");\n        }\n    }\n\n    /**\n     * Listener for the update of the location object with the most recent data.\n     * \n     * @method updateLocationCallBack\n     * @param {Object} position the HTML5 position object to use for the Mobilizing location object's update\n     * @private\n    */\n    updateLocationCallBack(position)\n    {\n        //debug.log(position);\n        this._location.longitude = position.coords.longitude;\n        this._location.latitude = position.coords.latitude;\n        this._location.altitude = position.coords.altitude;\n        this._location.accuracy = position.coords.accuracy;\n        this._location.altitudeAccuracy = position.coords.altitudeAccuracy;\n        this._location.heading = position.coords.heading;\n        this._location.speed = position.coords.speed;\n        this._location.timestamp = position.timestamp;\n        this._location.error = \"no error\";\n\n        this.events.trigger(EVT_LOC_UPDATED, this._location);\n    }\n\n    /**\n     * Listener for the update errors of the location object with the most recent data.\n     * \n     * @method updateLocationErrorCallBack\n     * @param error \n     * @private\n    */\n    updateLocationErrorCallBack(error)\n    {\n        if(error.code === 1){\n            console.error(\"location permission denied\");\n            this._location.error = \"location permission denied\";\n\n        }else if(error.code === 2){\n            console.error(\"location unavailable\");\n            this._location.error = \"location unavailable\";\n\n        }else if(error.code === 3){\n            console.error(\"location timeout\");\n            this._location.error = \"location timeout\";\n        }\n\n        this.events.trigger(EVT_LOC_ERROR, this._location.error);\n    }\n\n    /**\n     * reset the location object to avoid bugs\n     * @private\n     * @deprecated\n     * @method resetLocation\n     */\n    resetLocation()\n    {\n        this._location = {\n            latitude : null,\n            longitude : null,\n            altitude : null,\n            accuracy: null,\n            altitudeAccuracy : null,\n            heading : null,\n            speed : null,\n            timestamp : null\n        };\n    }\n};\n\nvar _STATICS = {};\n_STATICS.zoom = 1;\n_STATICS.worldSize = 512 * (Math.pow(2, _STATICS.zoom));\n\n/**\n* Some GPS coordinates convertion tools to use maps in Mobilizing.js\n* @class GPSUtils\n* @constructor\n* @static\n*/\nclass GPSUtils\n{\n\n    /**\n    * Converts longitude and latitude coords (from an OpenStreetMap map) into absolute pixels coords. This method don't calculate the pixels coords within a given map bound's! Use getCoordinateInMap for this.\n    * @static\n    * @method getPixelsCoordsFromOSMLngLat\n    * @param {Number} longitute longitute\n    * @param {Number} latitude latitude\n    * @param {Number} zoom the zoom factor fo this map\n    */\n    static getPixelsCoordsFromOSMLngLat(longitute, latitude, zoom)\n    {\n        if(zoom)\n        {\n            _STATICS.zoom = zoom;\n            _STATICS.worldSize = 512 * (Math.pow(2, _STATICS.zoom));\n        }\n\n        return {x: GPSUtils.lngX(longitute), y: GPSUtils.latY(latitude)};\n    }\n\n    /**\n    * Compute GPS coordinates into pixels x, y coordinates in a map. Here, we adopt the OSM standard for mappinp. Therefore, you should generate your bitmap earth map with a tool using OSM tiles (like MapBox, TileMill). You should give the zoom factor and the map bounds (in lognititude and latitude) to this method for the calculation to be effective\n    * @static\n    * @method getCoordinateInMap\n    * @param {Number} longitute\n    * @param {Number} latitude\n    * @param {Number} zoom zoom factor fo this map\n    * @param {Array} mapCoord MapBox/TileMill map coords array, like [-180,-85.0511,180,85.0511]\n    * @param {Number} mapWidth the map width in pixels\n    * @param {Number} mapHeight the map height in pixels\n    */\n    static getCoordinateInMap(longitute, latitude, mapCoord, mapWidth, mapHeight, zoom)\n    {\n        if(zoom)\n        {\n            _STATICS.zoom = zoom;\n        }\n        //construct local variable to simplify expressions writing\n        let leftLong = mapCoord[0];\n        let bottomLat = mapCoord[1];\n\n        let rightLong = mapCoord[2];\n        let topLat = mapCoord[3];\n\n        //construct the corners pixel coordinates\n        let topRight = GPSUtils.getPixelsCoordsFromOSMLngLat(rightLong, topLat);\n        let topLeft = GPSUtils.getPixelsCoordsFromOSMLngLat(leftLong, topLat);\n\n        let bottomRight = GPSUtils.getPixelsCoordsFromOSMLngLat(rightLong, bottomLat);\n        let bottomLeft = GPSUtils.getPixelsCoordsFromOSMLngLat(leftLong, bottomLat);\n\n        let absCoord = GPSUtils.getPixelsCoordsFromOSMLngLat(longitute, latitude);\n\n        let coords = {x: _Math.map(absCoord.x, topRight.x, topLeft.x, mapWidth/2, -mapHeight/2),\n                      y: _Math.map(absCoord.y, topRight.y, bottomRight.y, mapWidth/2, -mapHeight/2)};\n\n        return coords;\n    }\n\n    /**\n     * latitude to absolute x coord\n     * @static\n     * @method lngX\n     * @param {Number} lon\n     * @returns {Number} pixel coordinate\n     */\n    static lngX(lng) {\n        return (180 + lng) * _STATICS.worldSize / 360;\n    }\n    /**\n     * latitude to absolute y coord\n     * @static\n     * @method latY\n     * @param {Number} lat\n     * @returns {Number} pixel coordinate\n     */\n    static latY(lat) {\n        const y = 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + lat * Math.PI / 360));\n        return (180 - y) * _STATICS.worldSize / 360;\n    }\n\n    static xLng(x) {\n        return x * 360 / _STATICS.worldSize - 180;\n    }\n    static yLat(y) {\n        const y2 = 180 - y * 360 / _STATICS.worldSize;\n        return 360 / Math.PI * Math.atan(Math.exp(y2 * Math.PI / 180)) - 90;\n    }\n\n    /**\n    * Convert GPS coords to cartesian coords. NB : this algorithm is adapted to three.js geoms!\n    * @static\n    * @property getPolarFromLngLat\n    * @param {Numbe} longitude\n    * @param {Numbe} latitude\n    * @param {Numbe} radius\n    * @return {Object} {x, y, z} coordinates\n    */\n    static getPolarFromLngLat(longitude, latitude, radius)\n    {\n        let lng = _Math.degToRad(longitude + 180);\n        let lat = _Math.degToRad(90 - latitude);\n\n        let x = -(radius * Math.cos(lng) * Math.sin(lat));\n        let y = radius * Math.cos(lat);\n        let z = radius * Math.sin(lat) * Math.sin(lng);\n\n        return {x: x, y: y, z: z};\n    }\n\n}\n\n// module exports\nexport { GPS, GPSUtils };","import {Vector3} from '../core/Vector3';\n\n/*\n * MeshFX provides a set of static methods to work on 3D models verticies and to apply various effects on it.\n *\n * @class MeshFX\n */\nclass MeshFX\n{\n\n    /*\n    * Noise the vertices of the Mesh\n    * @static\n    * @method Noise\n    * @param {Mesh} mesh\n    * @param {Vector3} amount\n    */\n    static Noise(mesh, amount)\n    {\n        var vertices = mesh.getVertices();\n        for (var i =0;i<vertices.length;++i)\n        {\n            var noise = new Vector3(Math.random()-0.5, Math.random()-0.5, Math.random()-0.5);\n            vertices[i] = new Vector3(vertices[i].x+noise.x*amount, vertices[i].y+noise.y*amount, vertices[i].z+noise.z*amount);\n\n        }\n        mesh.setVertices(vertices);\n    }\n\n\n    static Nothing(mesh, amount)\n    {\n        var vertices = mesh.getVertices();\n        for (var i =0;i<vertices.length;++i)\n        {\n            var noise = new Vector3(Math.random()-0.5, Math.random()-0.5, Math.random()-0.5);\n            vertices[i] = new Vector3(vertices[i].x, vertices[i].y, vertices[i].z);\n\n        }\n        mesh.setVertices(vertices);\n    }\n\n    /*\n    * Offsets the vertices of the Mesh\n    * @static\n    * @method Offset\n    * @param {Mesh} mesh\n    * @param {Vector3} offset\n    */\n    static Offset(mesh, offset)\n    {\n        var vertices = mesh.getVertices();\n        for (var i =0;i<vertices.length;++i)\n        {\n            vertices[i] = new Vector3(vertices[i].x+offset.x, vertices[i].y+offset.y, vertices[i].z+offset.z);\n\n        }\n        mesh.setVertices(vertices);\n    }\n\n    /*\n    * Scales the vertices of the Mesh\n    * @static\n    * @method Scale\n    * @param {Mesh} mesh\n    * @param {Vector3} scale\n    */\n    static Scale(mesh, scale)\n    {\n        var vertices = mesh.getVertices();\n        for (var i =0;i<vertices.length;++i)\n        {\n            vertices[i] = new Vector3(vertices[i].x*scale.x, vertices[i].y*scale.y, vertices[i].z*scale.z);\n\n        }\n        mesh.setVertices(vertices);\n    }\n\n}\n\n// module exports\nexport { MeshFX };","import {debug} from './Debug';\nimport {Component} from '../Component';\n\nclass Midi extends Component\n{\n    /**\n     Gives access to the midi devices. This class requires the Web MIDI API to operate properly.\n\n     @class Midi\n     @constructor\n     @param {Object} params the parameters object\n     @param {String} params.in The Midi IN interface name we want to open.\n     @param {String} params.out The Midi OUT interface name we want to open.\n     @param {Function} params.onMidiIn The Midi IN callback we want to be called on a midi in event.\n     \n     @requires Web Midi API\n     */\n    constructor(params)\n    {\n        super(params);\n        this.midioutname    = params.out;\n        this.midiinname     = params.in;\n        //callbacks\n        this.onMidiIn       = params.onMidiIn;\n        debug.log(\"params.onMidiIn=\"+params.onMidiIn);\n        debug.log(\"this.onMidiIn=\"+this.onMidiIn);\n        if (navigator.requestMIDIAccess)\n        {\n            navigator.requestMIDIAccess().then( this.onMIDIInit.bind(this), this.onMIDIReject.bind(this) );\n        }\n        else\n        {\n            console.warn(\"No MIDI support present in your browser. Try in another browser.\");\n        }\n    }\n    \n    /**\n     Web MIDI API success callback.\n     @method onMIDIInit\n     @private\n     @param {Object} midi\n     */\n    onMIDIInit(midi)\n    {\n        this.midiAccess = midi;\n        this.hookUpMIDI();\n        this.midiAccess.onstatechange = this.hookUpMIDI;\n    }\n\n    /**\n     Web MIDI API failure callback.\n     @method onMIDIReject\n     @private\n     @param {Object} err\n     */\n    onMIDIReject(err)\n    {\n        alert(\"The MIDI system failed to start.  You're gonna have a bad time.\");\n    }\n\n    /**\n    * hookUpMIDI\n    * @method hookUpMIDI\n    * @private\n    */\n    hookUpMIDI()\n    {\n        if (this.midiinname !== undefined)\n        {\n            var inputs = this.midiAccess.inputs.values();\n            debug.log(\"MIDI inputs on your system : \");\n            for ( var input = inputs.next(); input && !input.done; input = inputs.next())\n            {\n                debug.log(\"input=\", input);\n                var midiname = input.value.name;\n                if (midiname === this.midiinname)\n                {\n                    debug.log(\"found midi interface IN : \" + midiname);\n                    input.value.onmidimessage = this.onMIDIMessage.bind(this);\n                }\n            }\n        }\n        if (this.midioutname !== undefined)\n        {\n            var outputs = this.midiAccess.outputs.values();\n            debug.log(\"MIDI outputs on your system : \");\n            for ( var output = outputs.next(); output && !output.done; output = outputs.next())\n            {\n                debug.log(\"output=\", output);\n                var midiname = output.value.name;\n            \n            \n                if (midiname === this.midioutname)\n                {\n                    debug.log(\"found midi interface OUT : \" + midiname);\n                    this.midioutput = output.value;\n                }\n            }\n        }\n    }\n    \n    /**\n    * onMIDIMessage\n    * @method onMIDIMessage\n    * @param {Object} event MIDI event\n    * @private\n    */\n    onMIDIMessage(event)\n    {\n        debug.log(\"this.onMidiIn=\" + this.onMidiIn);\n        if (this.onMidiIn !== undefined)\n        {\n            //channel message data1 data2\n            let message = event.data[0] & 0xf0;\n            let channel = event.data[0] - message;\n            let data1 = event.data[1];\n            let data2 = event.data[2];\n            this.onMidiIn(channel, message, data1, data2);\n        }\n    }\n\n    /**\n     Sends a Control Change MIDI message.\n     @method ControlChange\n     @param {Number} channel MIDI channel [0-15]\n     @param {Number} cc ControlChange number [0-127]\n     @param {Number} val ControlChange value [0-127]\n     @example\n         midi.ControlChange(2,11,50);\n     */\n    ControlChange(channel, cc, val)\n    {\n        if (this.midioutput === undefined)\n            return;\n        var ccMessage;\n        var m = 0xB0+channel;\n        ccMessage = [m, cc, val];\n        this.midioutput.send(ccMessage);\n    }\n\n    /**\n     Sends a NoteOn MIDI message.\n     @method NoteOn\n     @param {Number} channel MIDI channel [0-15]\n     @param {Number} note Midi Note number [0-127]\n     @param {Number} vel note MIDI velocity [0-127]\n     @example\n         midi.NoteOn(0,60,127);\n     */\n    NoteOn(channel, note, vel)\n    {\n        if (this.midioutput === undefined)\n            return;\n        var ccMessage;\n        var m = 0x90+channel;\n        ccMessage = [m, note, vel];\n        this.midioutput.send(ccMessage);\n    }\n\n    /**\n     Sends a NoteOff MIDI message.\n     @method NoteOff\n     @param {Number} channel MIDI channel [0-15]\n     @param {Number} note Midi Note number [0-127]\n     @param {Number} vel note MIDI velocity [0-127]\n     @example\n         midi.NoteOff(0,60,0);\n     */\n    NoteOff(channel, note, vel)\n    {\n        if (this.midioutput === undefined)\n            return;\n        var ccMessage;\n        var m = 0x80+channel;\n        ccMessage = [m, note, vel];\n        this.midioutput.send(ccMessage);\n    }\n\n}\n/**\n* Note On\n*/\nMidi.NoteOn = 144;\n/**\n * Note Off\n */\nMidi.NoteOff = 128;\n/**\n * After touch\n */\nMidi.Aftertouch = 160;\n/**\n * Control change\n */\nMidi.ControlChange = 176;\n/**\n * Program change\n */\nMidi.ProgramChange = 192;\n\n\n// module exports\nexport { Midi };\n","import {debug} from './Debug';\nimport {Component} from '../Component';\n\n/*\n * Profiler class should not be used by users\n *\n * @class Profiler\n * @private\n */\n\nclass Profiler extends Component\n{\n\n    /**\n     * Profiler is a Profiler component.\n     * \n     *\n     * @example\n     *     //to do\n     *\n     * @class Profiler\n     * @constructor\n     * @extends Component\n     * @param {Object} params Config parameters\n    */\n    constructor(params){\n        super(params);\n        this.timers          = [];\n        this.current_frame   = 0;\n        this.last_time       = 0;\n        this.initialize();\n    }\n\n    initialize()\n    {\n        var t = this.getTime();\n        var dt = this.last_time - t;\n        this.last_time = t;\n    }\n\n\n    update()\n    {\n        var t = this.getTime();\n        var dt = t - this.last_time;\n        this.last_time = t;\n        var frame = this.timers[this.current_frame];\n        if (!frame)\n        {\n            frame = {};\n            this.timers[this.current_frame] = frame;\n        }\n        this.timers[this.current_frame].dt = dt;\n        this.current_frame++;\n\n        this.logTimers();\n    }\n\n\n    startTimer(id)\n    {\n        //var t = Profiler.getTime();\n        //Profiler.timers[Profiler.current_frame].\n    }\n\n\n    getTime()\n    {\n        //return Date.now().getTime();\n        return new Date().getTime();\n    }\n\n\n    logTimers()\n    {\n        var str = \"\";\n        for (var i in this.timers)\n        {\n            str += this.timers[i].dt + \" \";\n        }\n        console.log(\"Profiler timers : \" + str);\n    }\n}\n\n\n// module exports\nexport { Profiler };","import {EventEmitter} from '../helpers/EventEmitter';\nimport {getOrDefault} from '../helpers/Misc';\n\n// Events\n/**\n * Fired when the readystate of the request changes\n * @event readystatechange\n * @param {Ajax} ajax The Ajax instance\n */\nconst EVT_READYSTATE_CHANGE = 'readystatechange';\n\n/**\n * Fired when the request is opened\n * @event start\n * @param {Ajax} ajax The Ajax instance\n */\nconst EVT_START = 'start';\n\n/**\n * Fired when an operation is in progress\n * @event progress\n * @param {Ajax} ajax The Ajax instance\n */\nconst EVT_PROGRESS = 'progress';\n\n/**\n * Fired when the request has finished loading\n * @event load\n * @param {Ajax} ajax The Ajax instance\n * @param {Boolean} success Whether the request was successfull or not\n */\nconst EVT_LOAD = 'load';\n\n/**\n * Fired when the request has finished loading and the status is greater or equal to 200 and less than 300, or is equal to 304\n * @event success\n * @param {Ajax} ajax The Ajax instance\n */\nconst EVT_SUCCESS = 'success';\n\n/**\n * Fired when the request encountered an error, or if it finished loading with an error status \n * @event error\n * @param {Ajax} ajax The Ajax instance\n */\nconst EVT_ERROR = 'error';\n\n\nclass Ajax\n{\n    /**\n    * Ajax is a helper class used to simplify the use of the XMLHttpRequest API\n    *\n    * @example\n    *    //TODO\n    *\n    * @class Ajax\n    * @constructor\n    * @param {Object} params The parameters object\n    * @param {String} params.url The URL to which the request is sent\n    * @param {String} [params.method = \"GET\"] The method used for the request (GET, POST, or PUT)\n    * @param {Object} [params.data = null] Data to be send along with the request\n    * @param {Object} [params.headers = null] An object of header key/value pairs to send along with requests\n    * @param {Boolean} [params.async = true] Whether the request is asynchronous or not\n    * @param {Boolean} [params.autoSend = true] Whether the request should be automatically sent\n    * @param {Boolean} [params.withCredentials = null] Whether cross-site Access-Control requests should be made using credentials such as cookies or authorization headers\n    * @param {String} [params.responseType = \"\"] The responseType this request must return\n    * @param {Number} [params.timeout = null] The number of milliseconds the request can take before automatically being terminated\n    * @param {Function} [params.onReadyStateChange = null] A function to be called when the readyState of the request changes\n    * @param {Function} [params.onStart = null] A function to be called when the request starts\n    * @param {Function} [params.onProgress = null] A function to be called when the request progresses\n    * @param {Function} [params.onLoad = null] A function to be called when the request finishes\n    * @param {Function} [params.onSuccess = null] A function to be called if the request succeeds\n    * @param {Function} [params.onError = null] A function to be called if the request fails\n    */\n    constructor(params)\n    {\n        this.url = params.url;\n        this.method = getOrDefault(params, \"method\", \"GET\");\n        let data = getOrDefault(params, \"data\", null);\n        let headers = getOrDefault(params, \"headers\", null);\n        this.async = getOrDefault(params, \"async\", true);\n        let autoSend = getOrDefault(params, \"autoSend\", true);\n        let withCredentials = getOrDefault(params, \"withCredentials\", null);\n        let timeout = getOrDefault(params, \"timeout\", null);\n        let responseType = getOrDefault(params, \"responseType\", \"text\");\n        let onReadyStateChange = getOrDefault(params, \"onReadyStateChange\", null);\n        let onStart = getOrDefault(params, \"onStart\", null);\n        let onProgress = getOrDefault(params, \"onProgress\", null);\n        let onLoad = getOrDefault(params, \"onLoad\", null);\n        let onSuccess = getOrDefault(params, \"onSuccess\", null);\n        let onError = getOrDefault(params, \"onError\", null);\n        \n        this.events = new EventEmitter({\"scope\": this});\n        \n        this._xhr = new XMLHttpRequest();\n        \n        // bind custom callbacks to events\n        if(onReadyStateChange){\n            this.events.on(EVT_READYSTATE_CHANGE, onReadyStateChange);\n        }        \n        if(onStart){\n            this.events.on(EVT_START, onStart);\n        }        \n        if(onProgress){\n            this.events.on(EVT_PROGRESS, onProgress);\n        }        \n        if(onLoad){\n            this.events.on(EVT_LOAD, onLoad);\n        }        \n        if(onSuccess){\n            this.events.on(EVT_SUCCESS, onSuccess);\n        }        \n        if(onError){\n            this.events.on(EVT_ERROR, onError);\n        }\n        \n        this._xhr.addEventListener(\"readystatechange\", this.onReadyStateChange.bind(this));\n        \n        // if this is a GET request, the data needs to be treated as URL parameters\n        if(this.method === 'GET' && data){\n            let url_params = [];\n            \n            for(let key in data){\n                url_params.push(key +'='+ encodeURIComponent(data[key]));\n            }\n            \n            this.url += '?'+ url_params.join('&');\n            \n            data = null;\n        }\n        \n        this.setResponseType(responseType);\n\n        // set custom headers\n        if(headers !== null){\n            for(let key in headers){\n                this.setRequestHeader(key, headers[key]);\n            }\n        }\n        \n        if(withCredentials !== null){\n            this.setWithCredentials(withCredentials);\n        }\n        \n        if(timeout !== null){\n            this.setTimeout(timeout);\n        }\n        \n        if(autoSend){\n            this._xhr.open(this.method, this.url, this.async);\n            this.send(data);\n        }\n    }\n\n    /**\n    * A helper function to create a request of type GET\n    *\n    * @method get\n    * @static\n    * @param {Object} params The parameters to send to the constructor\n    */\n    static get(params)\n    {        \n        params.method = 'GET';\n        \n        return new Ajax(params);\n    }\n\n    /**\n    * A helper function to create a request of type POST\n    *\n    * @method post\n    * @static\n    * @param {Object} params The parameters to send to the constructor\n    */\n    static post(params)\n    {        \n        params.method = 'POST';\n        \n        return new Ajax(params);\n    }\n\n    /**\n    * A helper function to create a request of type PUT\n    *\n    * @method put\n    * @static\n    * @param {Object} params The parameters to send to the constructor\n    */\n    static put(params)\n    {        \n        params.method = 'PUT';\n        \n        return new Ajax(params);\n    }\n\n    /**\n    * The readystatechange event handler\n    *\n    * @method onReadyStateChange\n    * @private\n    */\n    onReadyStateChange()\n    {        \n        this.events.trigger(EVT_READYSTATE_CHANGE, this);\n        \n        switch(this.getReadyState()){\n            case XMLHttpRequest.OPENED:\n                this.events.trigger(EVT_START, this);\n                break;\n                \n            case XMLHttpRequest.LOADING:\n                this.events.trigger(EVT_PROGRESS, this);\n                break;\n                \n            case XMLHttpRequest.DONE:                \n                let status = this.getStatus();\n                let success = false;\n                \n                if(status === 200 && status < 300 || status === 304){\n                    success = true;\n                }\n                // local requests can return a status of 0 even if no error occurs\n                else if(status === 0 && !this._xhr.error){\n                    success = true;\n                }\n                \n                this.events.trigger(EVT_LOAD, this, success);\n                \n                if(success){\n                    this.events.trigger(EVT_SUCCESS, this);\n                }\n                else{\n                    this.events.trigger(EVT_ERROR, this);\n                }\n                \n                break;\n        }\n    }\n\n    /**\n    * Get the XMLHttpRequest instance for the request\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n    *\n    * @method getXHR\n    * @return {XMLHttpRequest} The XMLHttpRequest instance\n    */\n    getXHR()\n    {\n        return this._xhr;\n    }\n\n    /**\n    * Wrapping method for the setRequestHeader method of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/setRequestHeader\n    *\n    * @method setRequestHeader\n    * @param {String} header The name of the header\n    * @param {String} value The value of the header\n    */\n    setRequestHeader(header, value)\n    {\n        this._xhr.setRequestHeader(header, value);\n    }\n\n    /**\n    * Wrapping method for the withCredentials property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials\n    *\n    * @method setWithCredentials\n    * @param {Boolean} value Whether cross-site Access-Control requests should be made using credentials such as cookies or authorization headers\n    */\n    setWithCredentials(value)\n    {\n        this._xhr.withCredentials = value;\n    }\n\n    /**\n    * Wrapping method for the timeout property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/timeout\n    *\n    * @method setTimeout\n    * @param {Number} value The number of milliseconds the request can take before automatically being terminated\n    */\n    setTimeout(value)\n    {\n        this._xhr.timeout = value;\n    }\n    \n    /**\n    * Wrapping method for the responseType property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responsetype\n    *\n    * @method setResponseType\n    * @param {String} value The type of response to be given by this request. Possible values are : \"arraybuffer\", \"text\", \"json\", \"document\", \"blob\"\n    */\n    setResponseType(value)\n    {\n        this._xhr.responseType = value;\n    }\n\n    /**\n    * Wrapping method for the send method of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/send\n    *\n    * @method send\n    * @param {Mixed} data The data to send along the request\n    */\n    send(data)\n    {\n        this._xhr.open(this.method, this.url, this.async);\n        this._xhr.send(data);\n    }\n\n    /**\n    * Wrapping method for abort method of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/abort\n    *\n    * @method abort\n    */\n    abort()\n    {\n        this._xhr.abort();\n    }\n\n    /**\n    * Wrapping method for status property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/status\n    *\n    * @method getStatus\n    * @return {Number} The status of the request\n    */\n    getStatus()\n    {\n        return this._xhr.status;\n    }\n\n    /**\n    * Wrapping method for statusText property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/statusText\n    *\n    * @method getStatusText\n    * @return {DOMString} The status message of the request\n    */\n    getStatusText()\n    {\n        return this._xhr.statusText;\n    }\n\n    /**\n    * Wrapping method for readyState property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\n    *\n    * @method getReadyState\n    * @return {Number} The state the XMLHttpRequest client is in\n    */\n    getReadyState()\n    {\n        return this._xhr.readyState;\n    }\n\n    /**\n    * Wrapping method for responseType property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseType\n    *\n    * @method getResponseType\n    * @return {String} The response's type\n    */\n    getResponseType()\n    {\n        return this._xhr.responseType;\n    }\n\n    /**\n    * Wrapping method for response property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/response\n    *\n    * @method getResponse\n    * @return {Mixed} The response's body\n    */\n    getResponse()\n    {\n        return this._xhr.response;\n    }\n\n    /**\n    * Wrapping method for responseText property of XMLHttpRequest\n    * see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseText\n    *\n    * @method getResponseText\n    * @return {String} The text response\n    */\n    getResponseText()\n    {\n        return this._xhr.responseText;\n    }\n\n    /**\n    * Return the XMLHttpRequest responseText as a JSON object\n    *\n    * @method getJSON\n    * @return {Object} The responseText parsed as a JSON object\n    */\n    getJSON()\n    {\n        return JSON.parse(this.getResponseText());\n    }\n}\n\n// module exports\nexport { Ajax };","import {Mesh} from '../shape/Mesh';\nimport {Material} from '../scene/Material';\nimport {Color} from '../core/Color';\nimport {Vector2} from '../core/Vector2';\nimport {Vector3} from '../core/Vector3';\nimport {debug} from '../helpers/Debug';\n\n\n/**\n * OBJ class gives easy access to some calculations specific to OBJs\n *\n * @class OBJ\n */\n\nclass OBJ\n{\n\n    /**\n     * Load an OBJ and dependencies from a URL\n     * @method load\n     * @static\n     * @param {Loader} loader\n     * @param {Object} params The parameters object\n     * @param {Function} [params.onStart = null] A function to be called when the loading starts\n     */\n    \n    \n    static load(loader, params)\n    {\n        OBJ.callBack = params.onLoad;\n        return loader.loadText({\n                               url:params.url,\n                               onLoad:OBJ.parseOBJ.bind(null,loader)\n                        });\n    }\n    \n  \n    static attachTexture(loader, model, data)\n    {\n        console.log(\"attachTexture \", loader, model, data);\n        model.material.setTexture(data);\n    }\n    \n    \n    static parseMTL(loader, model, data)\n    {\n        console.log(\"model=\" + model);\n        //OBJ.mtl = data;\n        console.log(\"mtl content =\", data);\n        var lines = data.toString().split(\"\\n\");\n        //console.log(\"MTL lines = \" + lines);\n        lines.forEach(line => {\n                      var words = line.split(\" \");\n                      //console.log(\"WORDS:\"+words);\n                      switch(words[0])\n                      {\n                      //comment, we just ignore\n                      case \"#\":\n                      break;\n                      //new material declared\n                      case \"newmtl\":\n                      console.log(\"new material : \" + words[1]);\n                      break;\n                      //ambient term\n                      case \"Ka\":\n                      model.material.setEmissiveColor(new Mobilizing.Color(words[1],words[2],words[3]));\n                      break;\n                      case \"Kd\": //diffuse\n                      model.material.setColor(new Mobilizing.Color(words[1],words[2],words[3]));\n                      break;\n                      \n                      case \"Ks\": //specular\n                      model.material.setSpecularColor(new Mobilizing.Color(words[1],words[2],words[3]));\n                      model.material._material.shininess = 20;\n                      break;\n                      \n                      case \"Ns\": //specular exponent\n                      \n                      break;\n                      \n                      case \"d\": //dissolved == opacity\n                      \n                      break;\n                      \n                      case \"Tr\": //Transparent\n                      //d = 1-Tr;\n                      break;\n                      \n                      case \"illum\": //illumination model\n                      \n                      break;\n                      \n                      case \"map_Kd\": //Map diffuse\n                      //load texture\n                      //console.log(\"load texture : \" + words[1]);\n                      var texture = loader.loadTexture({url:words[1], onLoad:OBJ.attachTexture.bind(null,loader, model)});\n                      model.updateMaterial();\n                      \n                      break;\n                      default:\n                      console.log(\"unknown MTL line : \" , words);\n                      break;\n                      }\n                      });\n\n                    //model.material.setColor(Mobilizing.Color.green);\n        \n    }\n    \n    static parseOBJ(loader, data)\n    {\n        console.log(\"onLoaded data=\", data);\n        console.log(\"loader=\", loader);\n        //console.log(\"onLoaded result=\", this.result);\n        //this.text = data.getResponseText();\n        OBJ.text = data;\n        console.log(\"text=\", OBJ.text);\n        //this.text = this.result._value; //FIXME\n        \n        var p;\n        if (OBJ.mesh !== undefined)\n        {\n            p = OBJ.mesh;\n        }\n        else\n        {\n            console.log(\"create material\");\n            p = new Mesh({});\n            /*if(OBJ.materialType !== null){\n                p.material = new Material({type:OBJ.materialType});\n            }else{\n                p.material = new Material({type:\"phong\"});\n            }\n             */\n            p.material = new Material({type:\"phong\"});\n            console.log(\"Material created : \" , p.material);\n            //p.material.setColor(Mobilizing.Color.red);\n            //p.material.setTexture(texture);\n            //p.updateMaterial();\n            //p.material.color = Color.white;\n            //p.material.setWireframe(true);\n        }\n        \n        console.log(\"parsing obj file...\");\n        //OBJ parsing =====================================\n        var lines = OBJ.text.toString().split(\"\\n\");\n        var uvs = [];\n        var normals = [];\n        lines.forEach(line => {\n                      var words = line.split(\" \");\n                      \n                      //debug.log(\"LINE \" + line);\n                      switch(words[0])\n                      {\n                      case \"mtllib\": //chargement de la lib\n                      console.log(\"mtllib \" + words[1]);\n                      OBJ.resultmtl = loader.loadText({\n                                      url:words[1],\n                                      onLoad:OBJ.parseMTL.bind(null,loader, p)\n                                      });\n                      break;\n                      \n                      case \"usemtl\":\n                      console.log(\"usemtl \" + words[1]);\n                      //to do : load mtl file\n\n                      break;\n                      \n                      case \"o\":\n                      console.log(\"OBJ o \" + words[1]);\n                      break;\n                      \n                      case \"g\":\n                      console.log(\"OBJ g \" + words[1]);\n                      break;\n                      \n                      case \"v\":\n                      //debug.log(\"Vertice\")\n                      var v = new Vector3(words[1], words[2], words[3]);\n                      p.pushVertex(v);\n                      break;\n                      \n                      case \"vt\":\n                      debug.log(\"uv \" + words[1] + \" \" + words[2]);\n                      var vUV = new Vector2(words[1], words[2]);\n                      uvs.push(vUV);\n                      break;\n                      \n                      case \"vn\":\n                      var vN = new Vector3(words[1], words[2], words[3]);\n                      normals.push(vN);\n                      //debug.log(\"normal\")\n                      break;\n                      \n                      case \"s\":\n                      //debug.log(\"Face\")\n                      break;\n                      \n                      case \"f\": //FACE definition\n                      //debug.log(uvs);\n                      //debug.log(\"Face\")\n                      var index1 = words[1].split(\"/\");\n                      var index2 = words[2].split(\"/\");\n                      var index3 = words[3].split(\"/\");\n                      p.pushFace(index1[0]-1, index2[0]-1, index3[0]-1);\n                      p.pushUV(uvs[index1[1]-1], uvs[index2[1]-1], uvs[index3[1]-1]);\n                      p.pushNormal(normals[index1[2]-1], normals[index2[2]-1], normals[index3[2]-1]); //NEW\n                      \n                      if (words.length > 4)\n                      {\n                      //we have quads, we need to add an additionnal triangle\n                      var index4 = words[4].split(\"/\");\n                      p.pushFace(index1[0]-1, index3[0]-1, index4[0]-1);\n                      p.pushUV(uvs[index1[1]-1], uvs[index3[1]-1], uvs[index4[1]-1]);\n                      }\n                      break;\n                      \n                      case \"#\":\n                      //debug.log(\"Comment\")\n                      break;\n                      }\n                      });\n        \n        p.computeNormals();\n        //p.updateMaterial();\n        console.log(\"callback called : \", p);\n        OBJ.callBack(p);\n        //p.material.setTexture(OBJ.texture);\n        \n    }\n}\n\n// module exports\nexport { OBJ };\n","import {EventEmitter} from './EventEmitter';\nimport {debug} from './Debug';\nimport {Ajax} from '../net/Ajax';\nimport {Texture} from '../texture/Texture';\nimport {OBJ} from '../helpers/OBJ';\nimport {getOrDefault, singletonize} from '../helpers/Misc';\n\n/**\n * Fired by a LoadRequest when it has started loading\n * @event start\n */\nconst EVT_REQUEST_START = 'start';\n\n/**\n * Fired by a LoadRequest when it has successfully finished loading\n * @event load\n * @param {Mixed} value The loaded and processed value\n */\nconst EVT_REQUEST_LOAD = 'load';\n\n/**\n * Fired by a LoadRequest when it has failed loading\n * @event error\n * @param {String} error The error\n */\nconst EVT_REQUEST_ERROR = 'error';\n\n/**\n * Fired when one of the Loader's requests has finished loading\n * @event load\n * @param {LoadRequest} request The LoadRequest\n */\nconst EVT_LOAD = 'load';\n\n/**\n * Fired when one of the Loader's requests has failed loading\n * @event error\n * @param {LoadRequest} request The LoadRequest\n */\nconst EVT_ERROR = 'error';\n\n/**\n * Fired when all the Loader's request have finished loading (whether successfully or not)\n * @event complete\n * @param {Array} requests The list of consumed requests\n */\nconst EVT_COMPLETE = 'complete';\n\n/**\n * A status indicating that the loader has not yet started consuming requests\n * @property pending\n * @static\n * @final\n * @private\n */\nconst STATUS_PENDING = 'pending';\n\n/**\n * A status indicating that the loader has started consuming requests\n * @property loading\n * @static\n * @final\n * @private\n */\nconst STATUS_LOADING = 'loading';\n\n/**\n * A status indicating that the loader has finished consuming all requests\n * @property complete\n * @static\n * @final\n * @private\n */\nconst STATUS_COMPLETE = 'complete';\n\n/**\n * LoadRequest object encapsulates a request of a loader\n * \n * @class LoadRequest\n * @constructor\n * @param {Object} params The parameters object\n * @param {Function} params.consume A function to be called (with this request as an argument) to consume the request\n * @param {Function} [params.onStart = null] A function to be called when the loading starts\n * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n * @param {Function} [params.onError = null] A function to be called when the loading fails\n*/\nclass LoadRequest{\n\n    constructor(params){\n\n        this._consumeCallback = params.consume;\n        this._value = undefined;\n        this._error = undefined;\n\n        this.events = new EventEmitter({\"scope\": this});\n\n        let onStart = getOrDefault(params, \"onStart\", null);\n        let onLoad = getOrDefault(params, \"onLoad\", null);\n        let onError = getOrDefault(params, \"onError\", null);\n\n        if(onStart){\n            this.events.on(EVT_REQUEST_START, onStart);\n        }  \n        if(onLoad){\n            this.events.on(EVT_REQUEST_LOAD, onLoad);\n        }\n        if(onError){\n            this.events.on(EVT_REQUEST_ERROR, onError);\n        }\n    }\n\n    /**\n    * Launch the associated Ajax request\n    * @method consume\n    */\n    consume(){\n        this._consumeCallback(this);\n    }\n\n    /**\n    * Set the value of this LoadRequest. Will be filled after loading completion\n    * @method setValue\n    * @param {Object} value\n    */\n    setValue(value){\n        this._value = value;\n    }\n\n    /**\n    * Get the value of this LoadRequest\n    * @method getValue\n    * @return {Mixed} value\n    */\n    getValue(){\n        return this._value;\n    }\n\n    /**\n    * Set the error that occured if any\n    * @method setError\n    * @param {Mixed} error\n    */\n    setError(error){\n        this._error = error;\n    }\n\n    /**\n    * Get the error that occured if any\n    * @method getError\n    * @return {Mixed} error\n    */\n    getError(){\n        return this._error;\n    }\n}\n\nclass Loader{\n    /**\n    * A loader class that manage the loading of datas from url. This is mainly used internally to manage the preLoad method in users script. Users should usually use this class methods to load datas and obtain the result encapsulated in a LoadRequest object.\n    * \n    * @class Loader\n    * @constructor\n    * @param {Object} params Config parameters\n    * @param {Function} params.onLoad\n    * @param {Function} params.onError\n    * @param {Function} params.onComplete\n    * \n    * @example\n    *     this.preLoad = function(loader){\n    *     \n    *       logoFile = loader.loadImage({url:\"logo_mobilizing.png\",\n    *                                    onStart: function(){console.log(\"Started loading of logo\");},\n    *                                    onLoad: function(data){console.log(\"Hell Yeah! Got\", data);}\n    *                                   });\n    *     }\n    *\n    *     this.setup = function(){\n    *\n    *       console.log(\"logoFile\", logoFile);\n    *       //will print the LoadRequest object. Access the loaded data with logoFile.getValue()\n    *     }\n    */\n    constructor(params){\n\n        let onLoad = getOrDefault(params, \"onLoad\", null);\n        let onError = getOrDefault(params, \"onError\", null);\n        let onComplete = getOrDefault(params, \"onComplete\", null);\n\n        this._status = STATUS_PENDING;\n        this._requests = [];\n        this._complete = 0;\n\n        this.events = new EventEmitter({\"scope\": this});\n\n        if(onLoad){\n            this.events.on(EVT_LOAD, onLoad);\n        }  \n        if(onError){\n            this.events.on(EVT_ERROR, onError);\n        }\n        if(onComplete){\n            this.events.on(EVT_COMPLETE, onComplete);\n        }\n    }\n\n    /**\n    * Consume (executes) all the requests\n    * @method consumeAll\n    */\n    consumeAll(){\n\n        if(this._requests.length > 0)\n        {\n            this._status = STATUS_LOADING;\n\n            for (let request of this._requests)\n            {\n                request.consume();\n            }\n        }\n        else\n        {\n            this.doComplete();\n        }\n    }\n\n    /**\n    * Helper method to update the status and trigger the complete event\n    * @method doComplete\n    * @private\n    */\n    doComplete(){\n        this._status = STATUS_COMPLETE;\n        this.events.trigger(EVT_COMPLETE, this._requests);\n    }\n\n    /**\n    * Loads data from a URL. This static method must be provided a callback method.\n    * @static\n    * @method load\n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    * @param {Mixed} callback.result The load result if successful\n    * @param {String} callback.error The load error if unsuccessful\n    * @param {String} [responseType] The type of the respons to return from the Ajax call\n    * @param {Function} [processData] function definning what to do with the data coming from the promise\n    */\n    static load(url, callback, responseType, processData){\n\n        //check if the url is aleady in cache for loading\n        if(Loader.Cache.isLoading(url))\n        {\n            if(callback)\n            {\n                Loader.Cache.addCallback(url, callback);\n                //console.log(\"adding\", callback);\n                return;\n            }\n        }\n        //check if the file is already cached (loaded)\n        if(Loader.Cache.isCached(url))\n        {\n            debug.info(\"ressource \"+url+\" is cached and won't be loaded again\");\n            return Loader.Cache.get(url);\n        }\n        else\n        {\n            //add this url to the file to cache\n            Loader.Cache.addKey(url);\n        }\n\n        let ajax = new Ajax({\n            \"url\": url,\n            \"responseType\": responseType,\n            \"autoSend\": false\n        });\n\n        if(processData === undefined){\n            processData = (ajax) => {\n                return ajax.getResponse();\n            };\n        }\n\n        ajax.events.on(\"success\", (ajax) => {\n            let result = processData(ajax);\n            callback( result );\n            //this is the loading response whithout further process,\n            //add it to the cache and pass the response to all other registred callback\n            Loader.Cache.addValue(url, result);\n        });\n\n        ajax.events.on(\"error\", (ajax) => {\n            callback( undefined, ajax.getStatusText() );\n        });\n\n        ajax.send();\n    }\n\n    /**\n    * Loads a text from a URL. This static method must be provided a callback method.\n    * @method loadText\n    * @static \n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    * @param {Mixed} callback.result The load result if successful\n    * @param {String} callback.error The load error if unsuccessful\n    */\n    static loadText(url, callback)\n    {\n        Loader.load(url, callback, \"text\");\n    }\n\n    /**\n    * Loads a JavaScript object, parsed from a JSON string from a URL. This static method must be provided a callback method.\n    * @method loadJSON\n    * @static \n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    * @param {Mixed} callback.result The load result if successful\n    * @param {String} callback.error The load error if unsuccessful\n    */\n    static loadJSON(url, callback)\n    {\n        Loader.load(url, callback, \"json\");\n    }\n\n    /**\n    * Loads an arraybuffer from a URL. This static method must be provided a callback method.\n    * @method loadArrayBuffer\n    * @static \n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    * @param {Mixed} callback.result The load result if successful\n    * @param {String} callback.error The load error if unsuccessful\n    */\n    static loadArrayBuffer(url, callback)\n    {\n        Loader.load(url, callback, \"arraybuffer\");\n    }\n\n    /**\n    * Loads a blob from a URL. This static method must be provided a callback method.\n    * @method loadBlob\n    * @static \n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    */\n    static loadBlob(url, callback)\n    {\n        Loader.load(url, callback, \"blob\");\n    }\n\n    /**\n    * Loads an image from a URL. This static method must be provided a callback method.\n    * @static\n    * @method loadImage\n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    * @param {Mixed} callback.result The load result if successful\n    * @param {String} callback.error The load error if unsuccessful\n    */\n    static loadImage(url, callback)\n    {\n        let img = new Image();\n\n        img.addEventListener(\"load\", () => {\n            callback(img);\n        }, false);\n\n        img.addEventListener(\"error\", () => {\n            callback(undefined, \"Error loading the image \"+ url);\n        }, false);\n\n        img.src = url;\n    }\n\n    /**\n    * Loads a script from a URL. This static method must be provided a callback method.\n    * @method loadScript\n    * @static \n    * @param {String} url the URL to load data from\n    * @param {Function} callback callback function that the user wants to call on load completion\n    */\n    static loadScript(url, callback)\n    {\n        let script = document.createElement(\"script\");\n        document.head.appendChild(script);\n        script.addEventListener(\"load\", function(){ callback() });\n        script.src = url;\n    }\n\n    /**\n    * Load a data from the URL given in parameters. ResponseType is the default one of an Ajax object, that is String.\n    * @method load\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @param {String} [params.responseType] The type of the respons to return from the Ajax call\n    * @param {Function} params.processData function definning what to do with the data coming from the promise\n    * @return {LoadRequest} the LoadRequest object is incomplete at call and will be filled by the inner promise manager, when fulfilled.\n    */\n    load(params){\n        let url = params.url;\n        let onStart = getOrDefault(params, \"onStart\", null);\n        let onLoad = getOrDefault(params, \"onLoad\", null);\n        let onError = getOrDefault(params, \"onError\", null);\n        let responseType = getOrDefault(params, \"responseType\", \"\");\n        let processData = getOrDefault(params, \"processData\", (ajax) => {return ajax.getResponse();});\n\n        let ajax = new Ajax({\"url\": url, \"responseType\": responseType, \"autoSend\": false});\n\n        let request = new LoadRequest({\n            \"consume\": (request) => {\n                ajax.send();\n            },\n            \"onStart\" : onStart,\n            \"onLoad\" : onLoad,\n            \"onError\" : onError\n        });\n\n        ajax.events.on(\"start\", (ajax) => {\n            request.events.trigger(EVT_REQUEST_START);\n        });\n\n        ajax.events.on(\"success\", (ajax) => {\n            let value = processData(ajax, this);\n\n            request.setValue(value);\n            request.events.trigger(EVT_REQUEST_LOAD, value);\n\n            this.events.trigger(EVT_LOAD, request);\n\n            this._complete++;\n\n            if(this._complete == this._requests.length){\n                this.doComplete();\n            }\n        });\n\n        ajax.events.on(\"error\", (ajax) => {\n            let error = ajax.getStatusText();\n\n            request.setError(error);\n            request.events.trigger(EVT_REQUEST_ERROR, error);\n\n            this.events.trigger(EVT_ERROR, request);\n\n            this._complete++;\n\n            if(this._complete == this._requests.length){\n                this.doComplete();\n            }\n        });\n\n        this._requests.push(request);\n\n        if(this._status === STATUS_LOADING){\n            request.consume();\n        }\n\n        return request;\n    }\n\n    /**\n    * Loads a text from a URL.\n    * @method loadText\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the Ajax request is fulfilled\n    */\n    loadText(params){\n\n        return this.load(Object.assign({}, params, {\n            responseType: \"text\"\n        }));\n    }\n\n    /**\n    * Loads a JavaScript object, parsed from a JSON string from a URL.\n    * @method loadJSON\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the Ajax request is fulfilled\n    */\n    loadJSON(params){\n\n        return this.load(Object.assign({}, params, {\n            responseType: \"json\"\n        }));\n    }\n\n    /**\n    * Load an image from the URL given in parameters. The Image Object is given as the returned LoadRequest's value.\n    * @method loadImage\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the Ajax request is fulfilled\n    */\n    loadImage(params){\n\n        let url = params.url;\n        let onStart = getOrDefault(params, \"onStart\", null);\n        let onLoad = getOrDefault(params, \"onLoad\", null);\n        let onError = getOrDefault(params, \"onError\", null);\n\n        let img = new Image();\n\n        let request = new LoadRequest({\n            \"consume\": (request) => {\n                img.src = url;\n                request.events.trigger(EVT_REQUEST_START);\n            },\n            \"onStart\" : onStart,\n            \"onLoad\" : onLoad,\n            \"onError\" : onError\n        });\n\n        img.addEventListener(\"load\", () => {\n            request.setValue(img);\n            request.events.trigger(EVT_REQUEST_LOAD, img);\n\n            this.events.trigger(EVT_LOAD, request);\n\n            this._complete++;\n\n            if(this._complete == this._requests.length){\n                this.doComplete();\n            }\n        }, false);\n\n        img.addEventListener(\"error\", () => {\n            let error = \"Error loading the image \"+ url;\n\n            request.setError(error);\n            request.events.trigger(EVT_REQUEST_ERROR, error);\n\n            this.events.trigger(EVT_ERROR, request);\n\n            this._complete++;\n\n            if(this._complete == this._requests.length){\n                this.doComplete();\n            }\n        });\n\n        this._requests.push(request);\n\n        if(this._status === STATUS_LOADING){\n            request.consume();\n        }\n\n        return request;\n    }\n\n    /**\n    * Load a video from the URL given in parameters. The Video Object is given as the returned LoadRequest's value.\n    * @method loadVideo\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the request is fulfilled\n    */\n    loadVideo(params){\n\n        let url = params.url;\n        let onStart = getOrDefault(params, \"onStart\", null);\n        let onLoad = getOrDefault(params, \"onLoad\", null);\n        let onError = getOrDefault(params, \"onError\", null);\n\n        let video = document.createElement(\"video\");\n        video.autoplay = false;\n\n        let request = new LoadRequest({\n            \"consume\": (request) => {\n                video.src = url;\n                video.load();\n                request.events.trigger(EVT_REQUEST_START);\n            },\n            \"onStart\" : onStart,\n            \"onLoad\" : onLoad,\n            \"onError\" : onError\n        });\n\n        video.addEventListener(\"canplay\", () => {\n            request.setValue(video);\n            request.events.trigger(EVT_REQUEST_LOAD, video);\n\n            this.events.trigger(EVT_LOAD, request);\n\n            this._complete++;\n\n            if(this._complete == this._requests.length){\n                this.doComplete();\n            }\n        }, false);\n\n        video.addEventListener(\"error\", () => {\n            let error = \"Error loading the video \"+ url + \" \" + video.error.code;\n\n            debug.log(video.error);\n\n            request.setError(error);\n            request.events.trigger(EVT_REQUEST_ERROR, error);\n\n            this.events.trigger(EVT_ERROR, request);\n\n            this._complete++;\n\n            if(this._complete == this._requests.length){\n                this.doComplete();\n            }\n        });\n\n        this._requests.push(request);\n\n        if(this._status === STATUS_LOADING){\n            request.consume();\n        }\n\n        return request;\n    }\n\n    /**\n    * Loads an ArrayBuffer from a URL.\n    * @method loadArrayBuffer\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the Ajax request is fulfilled\n    */\n    loadArrayBuffer(params){\n\n        return this.load(Object.assign({}, params, {\n            responseType: \"arraybuffer\"\n        }));\n    }\n\n    /**\n    * Loads a blob from a URL.\n    * @method loadBlob\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the Ajax request is fulfilled\n    */\n    loadBlob(params){\n\n        return this.load(Object.assign({}, params, {\n            responseType: \"blob\"\n        }));\n    }\n\n    /**\n    * Loads an OBJ from a URL.\n    * @method loadOBJ\n    * @param {Object} params The parameters object\n    * @param {String} params.url the URL to load data from\n    * @param {Function} [params.onStart = null] A function to be called when the loading starts\n    * @param {Function} [params.onLoad = null] A function to be called when the loading finishes\n    * @param {Function} [params.onError = null] A function to be called when the loading fails\n    * @return {LoadRequest} a LoadRequest who's value is incomplete at first and will be filled once the Ajax request is fulfilled\n    */\n    loadOBJ(params){\n        return OBJ.load(this, params);\n    }\n\n\n    loadTexture(params){\n\n        var t = new Texture();\n        console.log(\"try to load \" + params.url);\n        var result = this.loadImage({url:params.url,\n                                     onLoad: function (img)\n                                     {\n                                         t.fromImage(img);\n                                         if (params.onLoad !== undefined)\n                                         {\n                                             console.log(\"call onLoad:\", params.onLoad);\n                                             params.onLoad(t);\n                                         }\n                                     }\n                                    });\n        console.log(\"result=\", result);\n        return t;\n    }\n\n}\n\nclass Cache{\n    /**\n    * Cache gives the possibility to automatically avoid the reloading of the same ressource. It uses url to check if a given ressource has already been loaded or if it's currently loading.\n    * Cache exists only once as a static class of Loader and should never be created by user.\n    * Cache is enabled by default. To disable it, use Loader.Cache.enable(false) before you start using a Loader or a component that uses a Loader internally (like Button, RichText, etc.)\n    * It is used only in Loader static methods for now (to fix!).\n    * @class Cache\n    * @constructor\n    */\n    constructor()\n    {\n        this.enabled = true;\n        this.files = {};\n        this.callbacks = [];\n    }\n\n    /**\n    * Enable or disable cache\n    * @method enable\n    * @param {Boolean} bool\n    */\n    enable(bool)\n    {\n        this.enabled = false;\n    }\n\n    /**\n    * Add a file to the cache with the given key\n    * @method add\n    * @param {Object} key\n    * @param {Object} file\n    */\n    add(key, file)\n    {\n        if ( this.enabled === false )\n        {\n            return;\n        }\n\n        if(!this.getKey(key))\n        {\n            debug.info( 'Cache Adding key and file:', key, file );\n            this.files[ key ] = file;\n        }\n    }\n\n    /**\n    * Add a key to the cache with no value, for further completion\n    * @method addKey\n    * @param {Object} key\n    */\n    addKey(key)\n    {\n        if ( this.enabled === false )\n        {\n            return;\n        }\n\n        if(!this.getKey(key))\n        {\n            debug.info( 'Cache Adding key:', key );\n            this.files[ key ] = undefined;\n        }\n    }\n\n    /**\n    * Add a value to the cache to the given, already existing key\n    * @method addValue\n    * @param {Object} key\n    * @param {Object} file\n    */\n    addValue(key, file)\n    {\n        if ( this.enabled === false )\n        {\n            return;\n        }\n\n        if(this.getKey(key) && this.files[key] === undefined)\n            if(this.getKey(key) && this.files[key] === undefined)\n            {\n                debug.info( 'Cache Adding value:', file, \"to key\", key );\n                this.files[key] = file;\n\n                //process then remove callback consumed\n                for(let i = this.callbacks.length-1; i >= 0; i--)\n                {\n                    //console.log(\"this.callbacks\", this.callbacks[i]);\n                    if(this.callbacks[i].key === key)\n                    {\n                        let callback = this.callbacks[i].callback;\n                        callback(file);\n\n                        this.callbacks.splice(i,1);\n                    }\n                }\n                debug.log(\"this.callbacks.length\",this.callbacks.length);\n            }\n    }\n\n    /**\n    * Get the value of the given key\n    * @method get\n    * @param {Object} key\n    * @return {Object} the file in cache\n    */\n    get(key)\n    {\n        if( this.enabled === false ) return;\n        //console.log( 'Cache', 'Checking key:', key );\n        return this.files[ key ];\n    }\n\n    /**\n    * Remove the given key\n    * @method remove\n    * @param {Object} key\n    */\n    remove(key)\n    {\n        delete this.files[ key ];\n    }\n\n    /**\n    * Check if the file of the given key is aleady cached\n    * @method isCached\n    * @param {Object} key\n    * @return {Boolean} is cached or not\n    */\n    isCached(key)\n    {\n        //console.log( 'Cache', 'Checking key:', key, \"in\", this.files[key] );\n        if(this.files[key])\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    /**\n    * Check if the file of the given key is loading (only the key exists, not the value)\n    * @method isLoading\n    * @param {Object} key\n    * @return {Boolean} is loading or not\n    */\n    isLoading(key)\n    {\n        if(this.getKey(key))\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    /**\n    * Get the key if it exists, even with no value\n    * @method getKey\n    * @param {Object} key\n    * @return {Object} the key or undefined\n    */\n    getKey(key)\n    {\n        let keys = Object.keys(this.files);\n\n        for(let k = 0; k < keys.length; k++)\n        {\n            if(keys[k] === key)\n            {\n                //console.log(\"getKey found\",keys[k], key);\n                return keys[k];\n            }\n        }\n        return undefined;\n    }\n\n    /**\n    * Empty the file list\n    * @method clear\n    */\n    clear()\n    {\n        this.files = {};\n    }\n\n    /**\n    * Adds a callback coming from a Loader, with its associated key. We use a list of object as we must be able to register several callback that can have the same key.\n    * @method addCallback\n    * @param {Object} key\n    * @param {Function} callback\n    */\n    addCallback(key, callback)\n    {\n        let temp = {key: key, callback: callback};\n        //console.log(\"will add key\",  temp.key,\"callback\", temp.callback);\n        this.callbacks.push(temp);\n    }\n}\n\nLoader.Cache = new Cache();\n\n// module exports\nexport { Loader };\nexport { Cache };\n","import {debug} from './helpers/Debug';\nimport {Component} from './Component';\n\nclass ComponentProxy extends Component\n{\n    /**\n     * ComponentProxy is a proxy that converts (like a kind of casting) scripts into Mobilizing Components. It was designed specifically to convert users script to regular Components, so they can be used besides all the other Components used by the program. The script should implement the methods preLoad(), setup(), update(). Users can define their own Component using this class for converting their script to a regular Mobilizing Component, we call it custom behavior.\n     *\n     * @example\n     *     //to do\n     *\n     * @class ComponentProxy\n     * @constructor\n     * @extends Component\n     * \n     * @param {Object} params Config parameters\n     * @param {Script} params.targetScript The Mobilizing user's script to convert in a Component\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this.targetScript = params.targetScript; \n        this.targetScript.context = params.context;\n\n        this.targetScript.getContext = function(){\n            return this.context;\n        };\n    }\n\n    /**\n     * @method preLoad\n     */\n    preLoad(...args)\n    {\n        if(typeof this.targetScript.preLoad === \"function\")\n        {\n            this.targetScript.preLoad(...args);\n        }\n    }\n\n    /**\n    * Initialization method\n    * @method setup Setup\n    */\n    setup()\n    {\n        this.targetScript.setup();   \n    }\n    /**\n     * @method update\n     */\n    update()\n    {\n        this.targetScript.update();\n    }\n\n}\n\n// module exports\nexport { ComponentProxy };\n","import * as THREE from 'three';\n\nimport {debug} from './helpers/Debug';\nimport {Component} from './Component';\nimport {Loader} from './helpers/Loader';\nimport {ComponentProxy} from './ComponentProxy';\n\nclass Context extends Component\n{\n    /**\n    * Mobilizing.js defines a context to enable the use of multiple Mobilizing.js instances in the same webpage.\n    *\n    * @class Context\n    * @constructor\n    */\n    constructor(params)\n    {\n        super(params);\n        this._components = []; //list of components\n        this.loader = new Loader(); //default loader\n    }\n\n    /**\n    * Context initialization. Instanciates a Loader.\n    *\n    * @method init\n    */\n    init()\n    {\n        \n    }\n    \n    /**\n     * Setup for this Context instance (setup all components)\n     *\n     * @method setup\n     */\n    setup()\n    {\n        for (var c in this._components)\n        {\n            //this._components[c].setup();\n            this.chainedCall(this._components[c], \"setup\");\n        }\n        \n    }\n    \n    /**\n    * preLoad all components\n    * \n    * @method setup\n    */\n    preLoad()\n    {\n        for (var c in this._components)\n        {\n            this._components[c].preLoad(this.loader);\n        } \n    }\n\n    /**\n    * Update\n    * @method update\n    */\n    update()\n    {\n        //new components pre-update-post\n        for (var c in this._components)\n        {\n            //this._components[c].preUpdate();\n            this.chainedCall(this._components[c], \"preUpdate\");\n        }\n\n        for (var c in this._components)\n        {\n            this.chainedCall(this._components[c], \"update\");\n        }\n\n        for (var c in this._components)\n        {\n            //this._components[c].postUpdate();\n            this.chainedCall(this._components[c], \"postUpdate\");\n        }\n    }\n\n\n    chainedCall(component, method)\n    {\n        component[method](); //execute first\n        var chained = component.getChainedComponents();\n        //recurse then\n        if (chained.length > 0)\n        {\n            for (var c in chained)\n            {\n                this.chainedCall(chained[c], method);\n            }\n        }\n    }\n\n    /**\n    * Add a Component to this context\n    * @method addComponent\n    * @param {Component} component\n    */\n    addComponent(component)\n    {\n        //encapsulate class in a component : useful for user script\n        if ( !(component instanceof Component ))\n        {\n            component = new ComponentProxy({targetScript:component, context:this});\n        }\n\n        this._components.push(component);\n        component.setContext(this);//add the context to the component\n        //component.setup(); //no\n        return component;\n    }\n    /*\n    \n    addBehaviour(target, component)\n    {\n        component.context = this;\n        component.getContext = function(){return this.context;};\n        component.target = target;\n        component.getTarget = function(){return this.target;};\n        this.components.push(component);\n        component.setup();\n    }\n    \n     */\n}\n// module exports\nexport { Context };\n","import {Context} from '../Context';\nimport {debug} from './Debug';\nimport {getOrDefault} from './Misc';\n\nclass Runner\n{\n    /**\n     A runner is used to instanciate a Mobilizing.js user's script inside a specific context. It is requiered to use a Runner to initiate a context and to attech a script to it.\n\n     @class Runner\n     @constructor\n     @param mobscriptinstance the Mobilizing.js script instance given by the user\n     @param params JSON parameters to activate or not some Mobilizing.js modules when used in an other lib (i.e. CoSiMa)\n     @param params.canvas canvas used by the engine\n     @param params.callback a callback function that get called when the user script setup() is finished (function args are the Runner instance and the user script instance)\n     @param params.inputEnabled enable the Mobilizing Input built-in manager\n     @param params.audioEnabled enable the Mobilizing Audio manager\n\n     @example\n         <!DOCTYPE html>\n            <html>\n                <head>\n                    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf8\">\n                    <meta charset=\"UTF-8\">\n                    <meta name=\"viewport\" content=\"height=device-height,width=device-width\" />\n                    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=no\" />\n                    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n                    <meta name=\"apple-touch-fullscreen\" content=\"yes\">\n\n                    <link rel='stylesheet' href='css/main.css' />\n\n                    <script src=\"../../vendor/three/three.min.js\"></script>\n                    <script src=\"../../vendor/opentype/opentype.js\"></script>\n                    <script src=\"../../dist/Mobilizing.js\"></script>\n                    <script src=\"script.js\"></script>\n                    <script>\n                        //script.js is a user written script that must be instanciate for the Runner\n                        var runner = new Mobilizing.Runner(new script());\n                    </script>\n                </head>\n            <body>\n            </body>\n          </html>\n\n     @example\n         function script()\n         {\n            this.setup = function(){\n            //get the current context to work with\n                var context = this.getContext();\n            };\n\n            this.update = function(){\n\n            };\n          };\n     */\n    constructor(params)\n    {\n        this.callback = getOrDefault(params, \"callback\", undefined); \n        this.context = params.context;\n\n        if (document.readyState === \"complete\")\n        {\n            this.run();\n        }\n        else\n        {\n            window.addEventListener(\"load\", this.run.bind(this));\n        }\n        this.frame = 0;\n    }\n\n    /**\n     * Runs the runner, init the context, create the preLoader and launch it, then execute the script\n     *\n     * @method run\n     * @private\n     */\n    run()\n    {\n        this.context.init();\n        this.context.preLoad();\n        this.context.loader.events.on(\"complete\", function(){ this.startLoop()}.bind(this) );\n        this.context.loader.consumeAll();\n    }\n\n    /**\n    * Starts the loop of the user's script, that is the update function\n    * @method startLoop\n    * @private\n    */\n    startLoop()\n    {\n        this.context.setup();   //call all components setups\n        this.loop();        //start the main loop\n    }\n\n    /**\n    * onFrameBegin\n    * \n    * @method onFrameBegin\n    */\n    onFrameBegin()\n    {\n        //move to a component ?\n        this.frame++;\n\n        if (this.context.stats !== undefined)\n        {\n            this.context.stats.begin();\n        }\n    }\n\n    /**\n    * onFrameEnd\n    * \n    * @method onFrameEnd\n    */\n    onFrameEnd()\n    {\n        if (this.context.stats !== undefined)\n        {\n            this.context.stats.end();\n        }\n    }\n\n    /**\n     * Runner's requestAnimationFrame loop manager\n     *\n     * @method loop\n     * @private\n     */\n    loop()\n    {\n        this.onFrameBegin();\n        this.context.update();//engine update\n        //we don't need anymore user script update and 3D rendering (this is done internally by the context)\n        this.onFrameEnd();\n        requestAnimationFrame(this.loop.bind(this));//schedule next\n    }\n\n}\n\n// module exports\nexport { Runner };\n","import {_Math} from './Math';\nimport {debug} from './Debug';\nimport {Component} from '../Component';\nimport {getOrDefault} from './Misc';\nimport {Mouse} from '../input/Mouse';\nimport {Touch} from '../input/Touch';\nimport {EventEmitter} from './EventEmitter';\n\nvar TOUCH_TYPE = \"touch\";\nvar MOUSE_TYPE = \"mouse\";\n\nclass PointerObject\n{\n    /**\n    * PointerObject is a thin layer that unify all inputs to simplify UI interactions\n    * \n    * @class PointerObject\n    * @constructor\n    * @param {Number} x\n    * @param {Number} y\n    * @param {Number} state\n    * @param {Number} type\n    */\n    constructor(params)\n    {\n        let x = getOrDefault(params, \"x\", 0);\n        let y = getOrDefault(params, \"y\", 0);\n        let state = getOrDefault(params, \"state\", false);\n        let type = getOrDefault(params, \"type\", undefined);\n\n        this._x = x;\n        this._y = y;\n        this._deltaX = 0;\n        this._deltaY = 0;\n        this._state = state;\n        this._type = type;\n        this._component = null;\n    }\n    /**\n    * Set the component\n    * \n    * @method setComponent\n    * @param {Object} component\n    */\n    setComponent(component)\n    {\n        this._component = component;\n    }\n    /**\n    * get the component\n    * \n    * @method getComponent\n    * @return {Object} component\n    */\n    getComponent(component)\n    {\n        return this._component;\n    }\n    /**\n    * Set the x coordinate\n    * \n    * @method setX\n    * @param {Object} x\n    */\n    setX(x)\n    {\n        this._x = x;\n    }\n    /**\n    * Set the y coordinate\n    * \n    * @method setY\n    * @param {Object} y\n    */\n    setY(y)\n    {\n        this._y = y;\n    }\n    /**\n    * Get the x coordinate\n    * \n    * @method getX\n    * @return {Object} x\n    */\n    getX()\n    {\n        return this._x;\n    }\n    /**\n    * Get the y coordinate\n    * \n    * @method getY\n    * @return {Object} y\n    */\n    getY()\n    {\n        return this._y;\n    }\n    /**\n    * Set the x coordinate\n    * \n    * @method setDeltaX\n    * @param {Object} x\n    */\n    setDeltaX(x)\n    {\n        this._deltaX = x;\n    }\n    /**\n    * Set the y delta coordinate\n    * \n    * @method setDeltaY\n    * @param {Object} y\n    */\n    setDeltaY(y)\n    {\n        this._deltaY = y;\n    }\n    /**\n    * Get the x coordinate\n    * \n    * @method getDeltaX\n    * @return {Object} x\n    */\n    getDeltaX()\n    {\n        return this._deltaX;\n    }\n    /**\n    * Get the y coordinate\n    * \n    * @method getDeltaY\n    * @return {Object} y\n    */\n    getDeltaY()\n    {\n        return this._deltaY;\n    }\n    /**\n    * Set the state\n    * \n    * @method setState\n    * @param {Boolean} state\n    */\n    setState(state)\n    {\n        this._state = state;\n    }\n    /**\n    * Get the state\n    * \n    * @method getState\n    * return {Boolean} state\n    */\n    getState()\n    {\n        return this._state;\n    }\n    /**\n    * Set the type\n    * \n    * @method setType\n    * return {String} type\n    */\n    setType(type)\n    {\n        this._type = type;\n    }\n    /**\n    * Get the type\n    * \n    * @method getType\n    * return {String} type\n    */\n    getType()\n    {\n        return this._type;\n    }\n}\n\n/**\n * Fired when a pointer is on (pressed or down)\n * @event on\n */\nconst EVT_ON = 'on';\n\n/**\n * Fired when a pointer is off (released or erased)\n * @event off\n */\nconst EVT_OFF = 'off';\n\n/**\n * Fired when a pointer moved\n * @event moved\n */\nconst EVT_MOVED = 'moved';\n\nclass Pointer extends Component\n{\n    /**\n    * Pointer is an abstraction that enables various input devices to send the same kind of events. It is designed to accumulate various type of inputs in a Map of PointerOject. Each input device is converted in a PointerOject in order to unify its interface. Usefully mainly internally for interactive UI objects like buttons.\n    * \n    * @example\n    *    //TODO\n    *\n    * @class Pointer\n    * @constructor\n    * @param {Object} params Parameters Object\n    * @param {Component} params.components the input components to add to this pointer (i.e. Mouse)\n    */\n    constructor(params)\n    {\n        super(params);\n\n        let components = getOrDefault(params, \"components\", undefined);\n        this.pointers = new Map();\n\n        // special pointer to get the last active pointer\n        this.lastActivePointer = new PointerObject();\n        this.lastActivePointer.setType(\"lastActive\");\n\n\n        if(components)\n        {\n            for(var i in components)\n            {\n                let component = components[i];\n                this.add(component);\n            }\n        }\n    }\n\n    /**\n    * Remove unused Pointers\n    * \n    * @method postUpdate\n    */\n    postUpdate()\n    {\n        for(let pointerKey of this.pointers.keys())\n        {\n            let pointer = this.pointers.get(pointerKey);\n\n            if(pointer.getState() === false && pointer.getType() === TOUCH_TYPE)\n            {\n                //console.log(\"erase\",pointer);\n                this.pointers.delete(pointerKey);\n            }\n\n            //update ce qui doit l'être mais qui ne peut l'être ailleurs\n            if(pointer.getType() === \"touch\")\n            {\n                pointer.setDeltaX(pointer.getComponent().getDeltaX());\n                pointer.setDeltaY(pointer.getComponent().getDeltaY());\n            }\n            else if(pointer.getType() === \"mouse\")\n            {\n                pointer.setDeltaX(pointer.getComponent().getDeltaX());\n                pointer.setDeltaY(pointer.getComponent().getDeltaY());\n            }\n\n        }\n    }\n\n    /**\n    * Adds the specified input component as a PointerObject to the pointers list.\n    * @method add\n    * @param {Component} component\n    */\n    add(component)\n    {\n        //console.log(\"component\",component);\n\n        if(component instanceof Touch)\n        {\n            let touchComponent = component;//just to understand better\n            //console.log(\"will add Touch comp\", touchComponent);\n\n            //register a new Pointer at touch creation\n            touchComponent.events.on(\"touchstart\", (touch) => {\n\n                let pointer = new PointerObject();\n                pointer.setComponent(component);\n                pointer.setType(TOUCH_TYPE);\n                pointer.setState(true);\n                pointer.setX(touch.x);\n                pointer.setY(touch.y);\n                this.pointers.set(touch.id, pointer);\n\n                this.events.trigger(EVT_ON, {pointer:pointer, x:pointer.getX(), y:pointer.getY()});\n\n                this.lastActivePointer.setState(true);\n                this.lastActivePointer.setX(touch.x);\n                this.lastActivePointer.setY(touch.y);\n                //console.log(\"touchstart\", pointer, this.pointers);\n            });\n\n            //updates a Pointer at touch mouved\n            touchComponent.events.on(\"touchmoved\", (touch) => {\n\n                let pointer = this.pointers.get(touch.id);\n                pointer.setState(true);\n                pointer.setX(touch.x);\n                pointer.setY(touch.y);\n                pointer.setDeltaX(touch.xDelta);\n                pointer.setDeltaY(touch.yDelta);\n                this.events.trigger(EVT_MOVED, {pointer:pointer, x:pointer.getX(), y:pointer.getY()});\n\n                this.lastActivePointer.setState(true);\n                this.lastActivePointer.setX(touch.x);\n                this.lastActivePointer.setY(touch.y);\n                this.lastActivePointer.setDeltaX(touch.xDelta);\n                this.lastActivePointer.setDeltaY(touch.yDelta);\n                //console.log(\"touchmoved\", pointer);\n            });\n\n            //updates a Pointer at touch mouved\n            touchComponent.events.on(\"touchend\", (touch) => {\n\n                let pointer = this.pointers.get(touch.id);\n                pointer.setState(false);\n                pointer.setX(touch.x);\n                pointer.setY(touch.y);\n\n                this.events.trigger(EVT_OFF, {pointer:pointer});\n\n                this.lastActivePointer.setState(false);\n                this.lastActivePointer.setX(touch.x);\n                this.lastActivePointer.setY(touch.y);\n                //console.log(\"touchend\", pointer);\n            });\n\n        }\n        else if(component instanceof Mouse)\n        {\n            let mouseComponent = component;//just to understand better\n\n            let pointer = new PointerObject();\n            pointer.setComponent(component);\n            pointer.setType(MOUSE_TYPE);\n\n            mouseComponent.events.on(\"mousepress\", (coords) => {\n                let pointer = this.pointers.get(component.getID());\n                pointer.setState(true);\n                this.events.trigger(EVT_ON, {pointer:pointer, x:pointer.getX(), y:pointer.getY()});\n\n                this.lastActivePointer.setState(true);\n            });\n\n            mouseComponent.events.on(\"mouserelease\", (coords) => {\n                let pointer = this.pointers.get(component.getID());\n                pointer.setState(false);\n                this.events.trigger(EVT_OFF, {pointer:pointer});\n\n                this.lastActivePointer.setState(false);\n            });\n\n            mouseComponent.events.on(\"mousemove\", (coords) => {\n                let pointer = this.pointers.get(component.getID());\n\n                pointer.setDeltaX(mouseComponent.getDeltaX());\n                pointer.setDeltaY(mouseComponent.getDeltaY());\n\n                pointer.setX(coords.x);\n                pointer.setY(coords.y);\n\n                this.events.trigger(EVT_MOVED, {pointer:pointer, x:pointer.getX(), y:pointer.getY()});\n\n                this.lastActivePointer.setState(true);\n                this.lastActivePointer.setX(pointer.getX());\n                this.lastActivePointer.setY(pointer.getY());\n                this.lastActivePointer.setDeltaX(pointer.getDeltaX());\n                this.lastActivePointer.setDeltaY(pointer.getDeltaY());\n            });\n\n            mouseComponent.events.on(\"mouseupdate\", (coords) => {\n                let pointer = this.pointers.get(component.getID());\n\n                pointer.setDeltaX(mouseComponent.getDeltaX());\n                pointer.setDeltaY(mouseComponent.getDeltaY());\n\n                /*this.events.trigger(EVT_MOVED, {pointer:pointer, x:pointer.getX(), y:pointer.getY()});*/\n\n                this.lastActivePointer.setState(true);\n                this.lastActivePointer.setDeltaX(pointer.getDeltaX());\n                this.lastActivePointer.setDeltaY(pointer.getDeltaY());\n            });\n\n\n            this.pointers.set(component.getID(), pointer);\n        }\n    }\n\n    /**\n    * Returns the specified PointerObject to work with its state\n    * @method get\n    * @param {Component} component\n    * @return {Component} the corresponding input Component\n    */\n    get(component)\n    {\n        return this.pointers.get(component.id);\n    }\n\n    /**\n    * Returns an Array from the pointers Map object. For debug purpose.\n    * @method getPointersArray\n    * @return {Array} Pointers array\n    */\n    getPointers()\n    {\n        return Array.from(this.pointers.values());\n    }\n\n    /**\n    * Returns true if ANY of the PointerObjects (input Component) state is true, false otherwise. i.e. if you add a mouse and a touch component to the pointer, this will return true if any of these 2 has it's state to true.\n    * @method getState\n    * @return {Array} pointers array\n    */\n    getState()\n    {\n        for(let pointer of this.pointers.values())\n        {\n            //the virtual pointer is on true\n            if(pointer.getState())\n            {\n                return true;\n            }\n        }\n        this.events.trigger(\"off\");\n        return false;\n    }\n\n    /**\n    * Returns x coordinates of the PointerObject (input Component) of the given index. If no index is given, the last active pointer will return.\n    * @method getX\n    * @return {Number} x coordinate\n    */\n    getX(index)\n    {\n        let values = [];\n\n        for(let pointer of this.pointers.values())\n        {\n            values.push(pointer.getX());\n        }\n\n        if(index) // we want a specific pointer in the list\n        {\n            return index === undefined ? values : values[index];\n        }\n        else // we want a value\n        {\n            return this.lastActivePointer.getX();\n        }\n    }\n\n    /**\n    * Returns y coordinates of the PointerObject (input Component) of the given index. If no index is given, the last active pointer will return.\n    * @method getY\n    * @return {Number} y coordinate\n    */\n    getY(index)\n    {\n        let values = [];\n\n        for(let pointer of this.pointers.values())\n        {\n            values.push(pointer.getY());\n        }\n        if(index) // we want a specific pointer in the list\n        {\n            return index === undefined ? values : values[index];\n        }\n        else // we want a value\n        {\n            return this.lastActivePointer.getY();\n        }\n    }\n\n    /**\n    * Returns x delta coordinates of the PointerObject (input Component) of the given index. If no index is given, the last active pointer will return.\n    * @method getDeltaX\n    * @return {Number} coordinate\n    */\n    getDeltaX(index)\n    {\n        let values = [];\n\n        for(let pointer of this.pointers.values())\n        {\n            values.push(pointer.getDeltaX());\n        }\n        if(index) // we want a specific pointer in the list\n        {\n            return index === undefined ? values : values[index];\n        }\n        else // we want a value\n        {\n            return this.lastActivePointer.getDeltaX();\n        }\n    }\n\n    /**\n    * Returns y delta coordinates of the PointerObject (input Component) of the given index. If no index is given, the last active pointer will return.\n    * @method getDeltaY\n    * @return {Number} coordinate\n    */\n    getDeltaY(index)\n    {\n        let values = [];\n\n        for(let pointer of this.pointers.values())\n        {\n            values.push(pointer.getDeltaY());\n        }\n        if(index) // we want a specific pointer in the list\n        {\n            return index === undefined ? values : values[index];\n        }\n        else // we want a value\n        {\n            return this.lastActivePointer.getDeltaY();\n        }\n    }\n}\n\n// module exports\nexport { Pointer };","import {EventEmitter} from '../helpers/EventEmitter';\nimport {getOrDefault} from '../helpers/Misc';\n\n/**\n * Fired when the client successfully connects to the server\n * @event connect\n */\nconst EVT_CONNECT = 'connect';\n\n/**\n * Fired when the client disconnects from the server\n * @event disconnect\n */\nconst EVT_DISCONNECT = 'disconnect';\n\n/**\n * Fired when a connection error occurs\n * @event error\n */\nconst EVT_ERROR = 'error';\n\n\nclass PubSub\n{\n    /**\n    * PubSub is a publish-subscribe messaging system based on socket.io\n    * It allows simple socket communication between different clients\n    * An runing instance of MobilizingServer is required to make this work\n    *\n    * @example\n    *    //TODO\n    *\n    * @class PubSub\n    * @constructor\n    * @param {Object} params The parameters object\n    * @param {String} [params.url=\"\"] The URL of the server on which the MobilizingServer instance is running\n    * @param {Boolean} [params.autoConnect=true] Whether the connection should be automatically opened\n    */\n    constructor(params)\n    {\n        let url = getOrDefault(params, \"url\", \"\");\n        let autoConnect = getOrDefault(params, \"autoConnect\", true);\n\n        this.events = new EventEmitter({\"scope\": this});\n\n        if(autoConnect){\n            this.open(url);\n        }\n    }\n\n    /**\n    * Open the socket connection\n    * @method open\n    * @param {String} url URL of the server on which the MobilizingServer instance is running\n    */\n    open(url)\n    {        \n        if(typeof io === \"undefined\"){\n            let script = document.createElement('script');\n            script.src = url +'/socket.io/socket.io.js';\n            script.onload = () => {\n                this.open(url);\n            };\n\n            document.head.appendChild(script);\n        }\n        else{\n            this.socket = io(url);\n\n            this.socket.on('connect', () => {\n                this.socket.on('disconnect', () => {\n                    this.events.trigger(EVT_DISCONNECT);\n                });\n\n                this.events.trigger(EVT_CONNECT);\n            });\n\n            this.socket.on('error', (error) => {\n                this.events.trigger(EVT_ERROR, error);\n            });\n        }\n    }\n\n    /**\n    * Close the socket connection\n    * @method close\n    */\n    close()\n    {\n        if(this.socket)\n        {\n            this.socket.disconnect();\n            delete this.socket;\n        }\n    }\n\n    /**\n    * Publish a message to a specific channel\n    * @method publish\n    * @param {String} channel The channel on which to publish the message\n    * @param {Mixed} message The message to publish\n    */\n    publish(channel, message)\n    {\n        if(this.socket){\n            this.socket.emit('publish', {'channel': channel, 'message': message});\n        }\n    }\n\n    /**\n    * Subscribe for messages from a specific channel\n    * @method subscribe\n    * @param {String} channel The channel on which to subscribe\n    * @param {Function} callback The callback to call when a message is received on the channel\n    */\n    subscribe(channel, callback)\n    {\n        if(this.socket){\n            this.socket.emit('subscribe', {'channel': channel});\n            this.socket.on(channel, callback);\n        }\n    }\n\n    /**\n    * Unsubscribe for messages from a specific channel\n    * @method unsubscribe\n    * @param {String} channel The channel from which to unsubscribe\n    */\n    unsubscribe(channel)\n    {\n        if(this.socket){\n            this.socket.emit('unsubscribe', {'channel': channel});\n            this.socket.off(channel);\n        }\n    }\n\n    /**\n    * id accessor\n    *\n    * @property id\n    * @type String\n    */\n    getID()\n    {\n        return this.socket ? this.socket.id : null;\n    }\n}\n\n// module exports\nexport { PubSub };","import {Vector3} from '../core/Vector3';\nimport {_Math} from '../helpers/Math';\nimport {Time} from '../time/Time';\nimport {Component} from '../Component';\nimport {getOrDefault} from '../helpers/Misc';\n\nclass PhysicsEngine extends Component\n{\n    /**\n     * PhysicsEngine Class\n     *\n     * @class PhysicsEngine\n     * @constructor\n     * @param {Object} params Parameters Object\n     * @param {Number} params.iterations iterations of the physic engine when constrains are calculated\n     */\n    constructor(params)\n    {\n        super(params);\n\n        this.joints = [];\n        this.bodies = [];\n        this.iterations = getOrDefault(params, \"iterations\", 5);\n\n        this.G = 6.6742 * Math.pow(10, -11); //constante gravitationnelle\n        this.ke =  8.99 * Math.pow(10, 9); //coulomb's constant\n        this.relaxationCoeff = 1;\n    }\n\n    /**\n     * Initialization method\n     * @method setup Setup\n     */\n    setup()\n    {\n        this.context = this.getContext();\n        this._time = new Time();\n        this.context.addComponent(this._time);\n        this._time.setup();\n        this._time.on();\n    }\n\n    /*on(){\n        super.on();\n\n    }\n\n    off(){\n        super.off();\n\n    }*/\n\n    /**\n    * Description for undefined\n    * @method update\n    */\n    update()\n    {\n        if(this._active)\n        {\n            let i = 0;\n            let j = 0;\n            let body;\n            let joint;\n            let p1;\n            let p2;\n            let x;\n            let y;\n            let z;\n            let distance;\n            let dt = this._time.getDelta();//this.context.time.deltaTime;\n            if (dt == 0)\n            {\n                return;\n            }\n            if (dt > 1)\n                dt = 1;\n            //console.log(\"dt=\"+dt);\n            let force;\n            //apply forces / acc / vel / pos\n            for (let i=0; i < this.bodies.length; ++i)\n            {\n                body = this.bodies[i];\n                body.forces = new Vector3(0,0,0);\n            }\n\n\n            //springs\n            for (let j=0; j < this.joints.length; ++j)\n            {\n                joint = this.joints[j];\n\n                if(!joint.enabled)\n                {\n                    continue; //ignore this joint\n                }\n                if (joint.type === \"spring\")\n                {\n                    p1 = joint.body1.position;\n                    p2 = joint.body2.position;\n                    x = p2.x-p1.x;\n                    y = p2.y-p1.y;\n                    z = p2.z-p1.z;\n\n                    distance = Math.sqrt(x*x + y*y + z*z);\n\n                    //compute spring force\n                    force = (distance - joint.distance) * joint.k;\n                    joint.body1.forces.x += x*force;\n                    joint.body1.forces.y += y*force;\n                    joint.body1.forces.z += z*force;\n\n                    joint.body2.forces.x -= x*force;\n                    joint.body2.forces.y -= y*force;\n                    joint.body2.forces.z -= z*force;\n\n                    //damping force\n                    let sx = joint.body2.velocity.x - joint.body1.velocity.x;\n                    let sy = joint.body2.velocity.y - joint.body1.velocity.y;\n                    let sz = joint.body2.velocity.z - joint.body1.velocity.z;\n\n\n                    joint.body1.forces.x += sx*joint.damping;\n                    joint.body1.forces.y += sy*joint.damping;\n                    joint.body1.forces.z += sz*joint.damping;\n\n                    joint.body2.forces.x -= sx*joint.damping;\n                    joint.body2.forces.y -= sy*joint.damping;\n                    joint.body2.forces.z -= sz*joint.damping;\n                }\n                else if (joint.type === \"gravity\")\n                {\n                    p1 = joint.body1.position;\n                    p2 = joint.body2.position;\n                    x = p2.x - p1.x;\n                    y = p2.y - p1.y;\n                    z = p2.z - p1.z;\n\n                    distance = Math.sqrt(x*x+y*y+z*z);\n\n                    //normalize\n                    x /= distance;\n                    y /= distance;\n                    z /= distance;\n\n                    //compute gravity force\n                    let mass = joint.body1.mass+joint.body2.mass;\n                    force = this.G * mass / (distance*distance);\n                    joint.body1.forces.x += x*force;\n                    joint.body1.forces.y += y*force;\n                    joint.body1.forces.z += z*force;\n\n                    joint.body2.forces.x -= x*force;\n                    joint.body2.forces.y -= y*force;\n                    joint.body2.forces.z -= z*force;\n\n                }\n\n                else if (joint.type === \"electrostatics\")\n                {\n                    p1 = joint.body1.position;\n                    p2 = joint.body2.position;\n                    x = p2.x - p1.x;\n                    y = p2.y - p1.y;\n                    z = p2.z - p1.z;\n\n                    distance = Math.sqrt(x*x + y*y + z*z);\n\n                    //normalize\n                    x /= distance;\n                    y /= distance;\n                    z /= distance;\n\n                    //compute electrostatics force\n                    force = this.ke * joint.charge1 * joint.charge2 / (distance*distance);\n                    joint.body1.forces.x -= x*force;\n                    joint.body1.forces.y -= y*force;\n                    joint.body1.forces.z -= z*force;\n\n                    joint.body2.forces.x += x*force;\n                    joint.body2.forces.y += y*force;\n                    joint.body2.forces.z += z*force;\n\n                }\n            }\n\n            for (i=0;i<this.bodies.length;++i)\n            {\n                body = this.bodies[i];\n                let pos = body.position;\n\n                //quasi Verlet\n                if (body.speed !== undefined)\n                {\n                    body.velocity = new Vector3(body.speed.x, body.speed.y, body.speed.z);\n                    body.speed = undefined;\n                }\n                else\n                {\n                    body.velocity = new Vector3(body.position.x - body.previousposition.x,\n                                                body.position.y - body.previousposition.y,\n                                                body.position.z - body.previousposition.z);\n\n                    body.velocity.x /= dt;\n                    body.velocity.y /= dt;\n                    body.velocity.z /= dt;\n                }\n\n                body.previousposition = new Vector3(body.position.x,\n                                                    body.position.y,\n                                                    body.position.z);\n\n\n                //apply gravity (FIXME, not accurate !!!)\n                if (this.globalgravity !== undefined)\n                {\n                    body.forces.x += this.globalgravity.x * body.mass;\n                    body.forces.y += this.globalgravity.y * body.mass;\n                    body.forces.z += this.globalgravity.z * body.mass;\n                }\n\n                if (this.globalwind !== undefined)\n                {\n                    body.forces.x += this.globalwind.x;\n                    body.forces.y += this.globalwind.y;\n                    body.forces.z += this.globalwind.z;\n                }\n\n                //acc\n                let acc = new Vector3(0,0,0);\n                acc.x = body.forces.x / body.mass;\n                acc.y = body.forces.y / body.mass;\n                acc.z = body.forces.z / body.mass;\n                //console.log(\"body acc\", acc);\n                //speed\n                body.velocity.x += acc.x * dt;\n                body.velocity.y += acc.y * dt;\n                body.velocity.z += acc.z * dt;\n                //pos\n                body.position.x += body.velocity.x * dt;\n                body.position.y += body.velocity.y * dt;\n                body.position.z += body.velocity.z * dt;\n\n                //console.log(\"body position\", body.position);\n            }\n\n            //satisfy constraints\n            for (let i=0; i < this.iterations; ++i)\n            {\n                for (let j=0; j < this.joints.length; ++j)\n                {\n                    joint = this.joints[j];\n                    if (!joint.enabled)\n                    {\n                        continue; //ignore this joint\n                    }\n\n                    if (joint.type === \"stick\" || joint.type === \"string\")\n                    {\n                        p1 = joint.body1.position;\n                        p2 = joint.body2.position;\n                        x = p2.x - p1.x;\n                        y = p2.y - p1.y;\n                        z = p2.z - p1.z;\n                        distance = Math.sqrt(x*x + y*y + z*z);\n\n                        //satisfy distance constraint\n                        let err = (distance - joint.distance)/distance*1;\n                        //console.log(\"err=\" + err);\n\n                        if (joint.type === \"stick\" || (joint.type === \"string\" && distance > joint.distance))\n                        {\n                            let err1 = err/2;\n                            let err2 = err/2;\n                            if (joint.body1.fixed)\n                            {\n                                err1 = 0;\n                                err2 = err;\n                            }\n                            else if (joint.body2.fixed)\n                            {\n                                err1 = err;\n                                err2 = 0;\n                            }\n\n                            p1.x = p1.x+x * err1 * this.relaxationCoeff;\n                            p2.x = p2.x-x * err2 * this.relaxationCoeff;\n                            p1.y = p1.y+y * err1 * this.relaxationCoeff;\n                            p2.y = p2.y-y * err2 * this.relaxationCoeff;\n                            p1.z = p1.z+z * err1 * this.relaxationCoeff;\n                            p2.z = p2.z-z * err2 * this.relaxationCoeff;\n                        }     \n                    }\n                    else if (joint.type === \"fixed\")\n                    {\n                        //console.log(\"fixed = \" , joint.position);\n                        joint.body1.position = new Vector3(joint.position.x,\n                                                           joint.position.y,\n                                                           joint.position.z);\n                        joint.body1.velocity = new Vector3(0,0,0);\n                    }\n                }\n            }\n\n            //apply new positions\n            for (i=0;i<this.bodies.length;++i)\n            {\n                body = this.bodies[i];\n                if (body.object !== undefined)\n                {\n                    //console.log(\"new pos=\" , body.position);\n                    body.object.transform.setLocalPosition(body.position);\n                }\n            }\n        }\n    }\n\n    /**\n    * addBody\n    * @method addBody\n    * @param {Vector3} position\n    * @param {Number} mass\n    * @param {Mesh} object the Mesh to attach this physics body to\n    * @return {Body} the added physic body\n    */\n    addBody(position, mass, object)\n    {\n        let body = {};\n        body.position = new Vector3(position.x, position.y, position.z);\n        //console.log(\"body position : \", body.position);\n        body.previousposition = new Vector3(position.x, position.y, position.z);\n        body.mass = mass;\n        body.object = object;\n        body.velocity = new Vector3(0,0,0);\n        this.bodies.push(body);\n        return body;\n    }\n\n    /**\n    * addFixedJoint\n    * @method addFixedJoint\n    * @param {Mesh} body\n    * @param {Vector3} position\n    * @return {Body} the added joint body\n    */\n    addFixedJoint(body, position)\n    {\n        let joint = {};\n        joint.body1 = body;\n        joint.body1.fixed = true;\n        joint.type = \"fixed\";\n        joint.position = new Vector3(position.x, position.y, position.z);\n        joint.enabled = true;\n        this.joints.push(joint);\n        return joint;\n    }\n\n    /**\n    * addStickJoint\n    * @method addStickJoint\n    * @param {Mesh} body1\n    * @param {Mesh} body2\n    * @param {Number} distance\n    * @return {Body} the added joint body\n    */\n    addStickJoint(body1, body2, distance)\n    {\n        let joint = {};\n        joint.body1 = body1;\n        joint.body2 = body2;\n        joint.type = \"stick\";\n        joint.distance = distance;\n        joint.enabled = true;\n        this.joints.push(joint);\n        return joint;\n    }\n\n    /**\n    * addSpringJoint\n    * @method addSpringJoint\n    * @param {Mesh} body1\n    * @param {Mesh} body2\n    * @param {Number} distance\n    * @param {Number} k\n    * @param {Number} damping\n    * @return {Body} the added joint body\n    */\n    addSpringJoint(body1, body2, distance, k, damping)\n    {\n        let joint = {};\n        joint.body1 = body1;\n        joint.body2 = body2;\n        joint.type = \"spring\";\n        joint.distance = distance;\n        joint.k = k;\n        joint.damping = damping;\n        joint.enabled = true;\n        this.joints.push(joint);\n        return joint;\n    }\n\n    /**\n    * addStringJoint\n    * @method addStringJoint\n    * @param {Mesh} body1\n    * @param {Mesh} body2\n    * @param {Number} distance\n    * @return {Body} the added joint body\n    */\n    addStringJoint(body1, body2, distance)\n    {\n        let joint = {};\n        joint.body1 = body1;\n        joint.body2 = body2;\n        joint.type = \"string\";\n        joint.distance = distance;\n        joint.enabled = true;\n        this.joints.push(joint);\n        return joint;\n    }\n\n    /**\n    * addGravityJoint\n    * @method addGravityJoint\n    * @param {Mesh} body1\n    * @param {Mesh} body2\n    * @return {Body} the added joint body\n    */\n    addGravityJoint(body1, body2)\n    {\n        let joint = {};\n        joint.body1 = body1;\n        joint.body2 = body2;\n        joint.type = \"gravity\";\n        joint.enabled = true;\n        this.joints.push(joint);\n        return joint;\n    }\n\n    /**\n    * addElectrostaticsJoint\n    * @method addElectrostaticsJoint\n    * @param {Mesh} body1\n    * @param {Mesh} body2\n    * @param {Number} charge1\n    * @param {Number} charge2\n    * @return {Body} the added joint body\n    */\n    addElectrostaticsJoint(body1, body2, charge1, charge2)\n    {\n        let joint = {};\n        joint.body1 = body1;\n        joint.body2 = body2;\n        joint.type = \"electrostatics\";\n        joint.charge1 = charge1;\n        joint.charge2 = charge2;\n        joint.enabled = true;\n        this.joints.push(joint);\n        return joint;\n    }\n\n    /**\n    * setGlobalGravity\n    * @method setGlobalGravity\n    * @param {Vector3} vector\n    */\n    setGlobalGravity(vector)\n    {\n        this.globalgravity = vector;\n    }\n\n    /**\n    * setGlobalWind\n    * @method setGlobalWind\n    * @param {Vector3} vector\n    */\n    setGlobalWind(vector)\n    {\n        this.globalwind = vector;\n    }\n}\n\n// module exports\nexport { PhysicsEngine };\n","import {debug} from '../helpers/Debug';\n\nclass Engine3D\n{\n    /**\n     * Engine3D class contains the technical elements that bind Mobilizing.js API to a 3D rendering library. Currently, it's Three.js that is used to acheive 3D rendering. In the future, we can imagine to use an other library or a home made Engine.\n     *\n     * @class Engine3D\n     * @constructor\n     * @param {Canvas} canvas the canvas to use, if any, otherwise the Engine produce one.\n     * @param {Context} context the Mobilizing.js context to use, if any.\n     */\n    constructor(params)\n    {\n\n        //we try to use the canvas\n        //try\n        if (params.canvas)\n        {\n            debug.log(\"try to attach the Canvas...\",canvas);\n            //Mobilizing.renderer = new THREE.WebGLRenderer({canvas: document.getElementById('canvas')}); //FIXME : Ejecta\n            //this.renderer = new THREE.WebGLRenderer({canvas: document.getElementById(canvas)});\n            this.renderer = new THREE.WebGLRenderer({canvas: canvas, /*antialias: true, preserveDrawingBuffer: true*/});\n            this.engine = \"webgl\";\n\n            if(this.renderer.devicePixelRatio === undefined)\n            {\n                this.renderer.devicePixelRatio = window.devicePixelRatio;\n            }\n            this.renderer.setPixelRatio( window.devicePixelRatio ? window.devicePixelRatio : 1 ); //force retina\n            this.renderer.setSize( canvas.width/window.devicePixelRatio, canvas.height/window.devicePixelRatio);\n\n            canvas.style.width = canvas.width/window.devicePixelRatio +\"px\";\n            canvas.style.height = canvas.height/window.devicePixelRatio +\"px\";\n            this.canvas = canvas;\n            this.canvas.retinaResolutionEnabled = true;\n\n            this.windowWidth = this.canvas.clientWidth;\n            this.windowHeight = this.canvas.clientHeight;\n            debug.log(\"existing CANVAS\",this.renderer);\n        }\n        else\n        {\n            debug.log(\"retrieve Canvas failed, create a new canvas\");\n\n            //this.renderer = new THREE.WebGLRenderer({antialias: true, preserveDrawingBuffer: true, alpha:true});\n            this.renderer = new THREE.WebGLRenderer();\n\n            this.engine = \"webgl\";\n            this.renderer.setPixelRatio( window.devicePixelRatio ? window.devicePixelRatio : 1 ); //force retina\n            \n            if(this.renderer.devicePixelRatio === undefined)\n            {\n                this.renderer.devicePixelRatio = window.devicePixelRatio;\n            }\n            this.renderer.setSize( window.innerWidth, window.innerHeight);\n\n            document.body.appendChild( this.renderer.domElement );\n            this.canvas = this.renderer.domElement;\n            this.canvas.retinaResolutionEnabled = true;\n\n            this.windowWidth = window.innerWidth;\n            this.windowHeight = window.innerHeight;\n        }\n\n        debug.log(\"engine = \" + this.engine);\n        this.renderer.setClearColor(0x000000, 1.0);\n        this.renderer.autoClear = true; //false\n\n        debug.log(\"window pixel ratio = \" + window.devicePixelRatio);\n\n        /*\n        this.renderer.setPixelRatio( window.devicePixelRatio ); //force retina\n        this.renderer.setSize( window.innerWidth, window.innerHeight);*/\n    }\n\n    /**\n    * Returns the current Engine rendering canvas\n    * @method getCanvas\n    * @return {Canvas} the canvas being used.\n    */\n    getCanvas()\n    {\n        return this.canvas;\n    }\n\n}\n\n// module exports\nexport { Engine3D };","import {_Math} from '../helpers/Math';\nimport {_DOM} from '../helpers/DOM';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {singletonize} from '../helpers/Misc';\nimport {getOrDefault} from '../helpers/Misc';\nimport {Color} from \"../core/Color\";\n\nclass Renderer3D extends Component\n{\n    /**\n     * Renderer3D is a Three js based renderer.\n     * \n     *\n     * @example\n     *     //to do\n     *\n     * @class Renderer3D\n     * @constructor\n     * @extends Component\n     * @param {Object} params Config parameters\n     * @param {Context} params.context The Mobilizing context\n    */\n    constructor(params)\n    {\n        super(params);\n        this.canvas = getOrDefault(params, \"canvas\", undefined);\n        this.scenes = [];\n        this.cameras = [];\n        this.fog = undefined;\n        this.setCurrentScene(\"default\");\n        this.engine = new Mobilizing.Engine3D({canvas: this.canvas}); //3D engine creation - we pass the Canvas\n\n        //we must register the canvas when made internally by Mobilizing/Three\n        if(this.canvas)\n        {\n            this.fullscreen = false;\n            debug.log(\"got canvas from runner to context\", this.canvas);\n        }\n        else\n        {\n            this.canvas = this.engine.canvas;\n            this.fullscreen = true;\n            debug.log(\"got canvas from Engine\", this.canvas);\n        }\n\n        //==================================================================\n\n        //window management\n        window.addEventListener(\"orientationchange\", event => this.onWindowResize(event), false);\n        window.addEventListener(\"resize\", event => this.onWindowResize(event), false );\n\n        // deal with the page getting resized or scrolled\n        window.addEventListener(\"scroll\", event => this.updateCanvasPosition(event), false);\n        window.addEventListener(\"resize\", event => this.updateCanvasPosition(event), false);\n\n        this.canvasPosition = this.getCanvasPosition();\n    }\n\n    /*setup()\n    {\n    }*/\n\n    /*on(){\n        super.on();\n    }\n\n    off(){\n        super.off();\n    }*/\n\n    /**\n     * @method update\n     */\n    update()\n    {\n        this.render();\n    }\n\n    //deprecated\n    setClearColor(color, alpha)\n    {\n        this.engine.renderer.setClearColor(color,alpha);\n    }\n\n    /**\n    * Activates the rendering of projected shadows\n    * @method setEnableShadowMap\n    * @param {Boolean} state\n    */\n    setEnableShadowMap(state)\n    {\n        this.engine.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n        this.engine.renderer.shadowMapEnabled = state;\n    }\n\n    /**\n     * Tells the context to use this scene (defined by a string) or create it and switch to it.\n     * @method setCurrentScene\n     * @param {String} name\n     */\n    setCurrentScene(name)\n    {\n        this.scene = this.scenes[name];\n\n        if (this.scene === undefined)\n        {\n            this.scene = new THREE.Scene();\n            this.scenes[name] = this.scene;\n            debug.log(\"current scene is : \", this.scene);\n        }\n    }\n\n    /**\n     * Adds on object to the current scene\n     * @method addToCurrentScene\n     * @param {Object} object A Mesh or Light to add the scene\n     */\n    addToCurrentScene(object)\n    {\n        this.scene.add(object.transform.entity);\n    }\n\n    /**\n     * Remove from the current scene\n     * @method removeFromCurrentScene\n     * @param {Object} object the object to remove\n     */\n    removeFromCurrentScene(object)\n    {\n        this.scene.remove(object.transform.entity);\n    }\n\n    /**\n     * Clears this renderer : remove all cameras and scene objects\n     * \n     * @method addCamera\n     * @param {Camera} cam the camera to add\n     */\n    clear()\n    {\n        console.log(\"scene=\" , this.scene);\n        for(var obj in this.scene)\n        {\n            var o =this.scene[obj];\n            console.log(\"key \" , obj);\n            console.log(\"removing \" , o);\n            //this.removeFromCurrentScene(o);\n            this.scene.remove(o);\n            \n        }\n        this.scene.children = [];\n\n        this.cameras = [];\n    }\n\n    /**\n     * Adds a camera to the current context\n     * \n     * @method addCamera\n     * @param {Camera} cam the camera to add\n     */\n    addCamera(cam)\n    {\n        this.cameras.push(cam);\n    }\n\n    /**\n     * Removes the camera from the current context\n     * \n     * @method removeCamera\n     * @param {Camera} cam\n     */\n    removeCamera(cam)\n    {\n        this.cameras.splice( this.cameras.indexOf(cam), 1 );\n    }\n\n    /**\n     * Defines the type and color of the fog to be used for rendering the scene\n     * \n     * @method setFog\n     * @param {String} type one of \"linear\", \"exp\"\n     * @param {Color} color the fog color\n     */\n    setFog(type, color)\n    {\n        if(!color)\n        {\n            color = Color.black.clone();\n        }\n\n        switch(type)\n        {\n            case \"linear\" :\n                this.fog = new THREE.Fog(color.getHex());\n                this.fog.type = \"linear\";\n                break;\n\n            case \"exp\" :\n                this.fog = new THREE.FogExp2(color.getHex());\n                this.fog.type = \"exp\";\n                break;\n\n            default :\n                this.fog = new THREE.Fog(color.getHex());\n                this.fog.type = \"linear\";\n                break;\n                break;\n        }\n        this.scene.fog = this.fog;\n    }\n\n    /**\n     * Defines the near distance of the linear fog. Default is 1.\n     * \n     * @method setFogNear\n     * @param {Number} near\n     */\n    setFogNear(near)\n    {\n        if(this.fog.type === \"linear\")\n        {\n            this.fog.near = near;\n        }\n    }\n\n    /**\n     * Defines the far distance of the linear fog. Default is 1000.\n     * \n     * @method setFogFar\n     * @param {Number} far\n     */\n    setFogFar(far)\n    {\n        if(this.fog.type === \"linear\")\n        {\n            this.fog.far = far;\n        }\n    }\n\n    /**\n     * Defines the density of the exponential fog.  Default is 0.00025.\n     * \n     * @method setFogDensity\n     * @param {Number} density\n     */\n    setFogDensity(val)\n    {\n        if(this.fog.type === \"exp\")\n        {\n            this.fog.density = val;\n        }\n    }\n\n    /**\n     * Defines the fog color\n     * \n     * @method setFogColor\n     * @param {Color} color\n     */\n    setFogColor(color)\n    {\n        this.fog.color = color;\n    }\n\n\n    onWindowResize()\n    {\n        if(this.fullscreen)\n        {\n            this.cameras.forEach( cam => {\n\n                if(cam.type === \"perspective\"){\n\n                    var w = this.engine.renderer.domElement.width/this.engine.renderer.devicePixelRatio;\n                    var h = this.engine.renderer.domElement.height/this.engine.renderer.devicePixelRatio;\n                    cam.setAspect((w*cam.viewport.width) / (h*cam.viewport.height));\n\n                }else if(cam.type === \"ortho\"){\n\n                    cam.setOrthoPlanes(window.innerWidth/-2,\n                                       window.innerWidth/2,\n                                       window.innerHeight/2,\n                                       window.innerHeight/-2);\n                }\n            });\n            this.engine.renderer.setSize( window.innerWidth, window.innerHeight);\n        }\n    }\n\n    /**\n     * Renders all the camera in the context\n     * @method render\n     */\n    render()\n    {\n        //rendu de toutes les caméras\n        //debug.log(\"render \" + this.cameras.length + \" cams\");\n        //simple insertion index sorting\n        for (var l=0; l<this.cameras.length; ++l)\n        {\n            this.cameras[l].sort = false;\n            if (this.cameras[l].index === undefined)\n            {\n                this.cameras[l].index = 0;\n            }\n        }\n        \n        var sorted_cameras = [];\n        var min_val = 9999;\n        var min_cam = null;\n        \n        for (var i=0;i<this.cameras.length; ++i)\n        {\n            //recherche de l'élément le plus petit pas encore trié\n            min_val = 9999;\n            min_cam = null;\n            for (var j=0;j<this.cameras.length; ++j)\n            {\n                var cam_candidate = this.cameras[j];\n                //debug.log(\"evaluating cam.index=\" + cam_candidate.index);\n                if (cam_candidate.index <= min_val && !cam_candidate.sort)\n                {\n                    min_cam = cam_candidate;\n                    min_val = cam_candidate.index;\n                }\n            }\n            \n            if(min_cam)\n            {\n                min_cam.sort = true;\n                //debug.log(\"push cam with index=\" + min_val);\n                sorted_cameras.push(min_cam);\n            }\n        }\n        \n        for (var k=0; k<sorted_cameras.length; ++k)\n        {\n            //debug.log(\"render \" + k);\n            var cam = sorted_cameras[k];\n            \n            if (cam.transform.getVisible() && (cam.dirty||cam.autorender))\n            {\n                var w = this.engine.renderer.domElement.width / this.engine.renderer.devicePixelRatio;\n                var h = this.engine.renderer.domElement.height /this.engine.renderer.devicePixelRatio;\n                if (cam.type !== \"cube\")\n                {\n                    cam.setAspect((w * cam.viewport.width) / (h * cam.viewport.height));\n                }\n                var viewport_x = w*cam.viewport.x;\n                var viewport_y = h*cam.viewport.y;\n                var viewport_w = w*cam.viewport.width;\n                var viewport_h = h*cam.viewport.height;\n                this.engine.renderer.setViewport(viewport_x, viewport_y, viewport_w, viewport_h);\n                this.engine.renderer.setScissor(viewport_x, viewport_y, viewport_w, viewport_h);\n                this.engine.renderer.setScissorTest(true);\n                this.engine.renderer.autoClear = cam.autoclear;\n\n                for (var ks in this.scenes)\n                {\n                    if (this.logLevel === 1)\n                    {\n                        debug.log(\"render cam/scene \", cam, ks);\n                    }\n                    if (cam.layer === ks) //si la scène a le même nom que le layer de la caméra\n                    {\n                        if (cam.renderTexture !== undefined)\n                        {\n                            this.engine.renderer.render(this.scenes[ks], cam._camera, cam.renderTexture._engineTexture, cam.autoClear);\n                        }\n                        else if (cam.type === \"cube\")\n                        {\n                            cam._camera.updateCubeMap( this.engine.renderer, this.scenes[ks] );\n                        }\n                        else\n                        {\n                            this.engine.renderer.render(this.scenes[ks], cam._camera);\n                        }\n                        cam.dirty = false;\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n    * Returns the current canvas\n    * \n    * @method getCanvas\n    * @return {Object} the canvas\n    */\n    getCanvas()\n    {\n        return this.canvas;\n    }\n\n    /**\n    * Returns the current canvas'size as {width, height}\n    * \n    * @method getCanvasSize\n    * @return {Object} the size of the canvas as {width, height}\n    */\n    getCanvasSize()\n    {\n        return { width: this.canvas.width/window.devicePixelRatio,\n                height: this.canvas.height/window.devicePixelRatio};\n    }\n\n    /**\n    * Get the canvas position as {x, y}\n    * \n    * @method getCanvasPosition\n    * @return {Object} the position of the canvas as {x, y} \n    */\n    getCanvasPosition()\n    {\n        return _DOM.getElementPosition(this.canvas);\n    }\n\n    /**\n    * Update the canvas position in screen\n    * \n    * @method updateCanvasPosition\n    */\n    updateCanvasPosition()\n    {\n        this.canvasPosition = this.getCanvasPosition();\n    }\n}\n\n\nRenderer3D = singletonize(Renderer3D);\n\n// module exports\nexport { Renderer3D };\n","import {_Math} from '../helpers/Math';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {singletonize} from '../helpers/Misc';\n\nclass RendererAudio extends Component\n{\n    /**\n     * RendererAudio is a Web Audio API based renderer for playing sound.\n     *\n     * @example\n     *     //to do\n     *\n     * @class RendererAudio\n     * @constructor\n     * @extends Component\n     * @param {Object} params Config parameters\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this.renderer = this.getContext();\n        this.audioContext = undefined;\n\n        //web Audio API\n        if (this.params === undefined || this.params.audioEnabled)\n        {\n            if (window.AudioContext !== undefined)\n            {\n                this.audioContext = new window.AudioContext();\n            }\n            else if (window.webkitAudioContext !== undefined)\n            {\n                this.audioContext = new window.webkitAudioContext();\n            }\n\n            //hack to reset the SR\n            if (this.audioContext)\n            {\n                if (this.audioContext.sampleRate !== 44100)\n                {\n                    var buffer = this.audioContext.createBuffer(1, 1, 44100);\n                    var dummy = this.audioContext.createBufferSource();\n                    dummy.buffer = buffer;\n                    dummy.connect(this.audioContext.destination);\n                    dummy.start(0);\n                    dummy.disconnect();\n                    this.audioContext.close();\n\n                    if (window.AudioContext !== undefined)\n                    {\n                        this.audioContext = new window.AudioContext();\n                    }\n                    else if (window.webkitAudioContext !== undefined)\n                    {\n                        this.audioContext = new window.webkitAudioContext();\n                    }\n                }\n\n                this.audioOutputNode = this.audioContext.createGain();\n                this.audioOutputNode.connect(this.audioContext.destination);\n            }\n        }\n\n        this.listener = this.audioContext.listener;\n\n        if(this.listener.forwardX)\n        {\n            this.listener.forwardX.value = 0;\n            this.listener.forwardY.value = 0;\n            this.listener.forwardZ.value = -1;\n            this.listener.upX.value = 0;\n            this.listener.upY.value = 1;\n            this.listener.upZ.value = 0;\n        }\n        else\n        {\n            this.listener.setOrientation(0,0,-1,0,1,0);\n        }\n\n    }\n\n    beep(frequency)\n    {\n        let freq = (frequency) ? frequency : 440;\n        var osc = this.audioContext.createOscillator();\n        //this.audioOutputNode.gain.value = 0;\n        osc.connect(this.audioOutputNode);\n        osc.frequency.value = freq;\n        osc.start(0);\n        osc.stop(this.audioContext.currentTime + 0.3);\n    }\n\n    setListenerTransform(transform)\n    {\n        this.listener.transform = transform;\n    }\n\n    /*setup()\n    {\n    }\n\n    on()\n    {\n        super.on();\n    }\n\n    off()\n    {\n        super.off();\n    }\n    */\n    update()\n    {\n        super.update();\n\n        if(this.listener.transform)\n        {\n            var pos = this.listener.transform.getLocalPosition();\n            this.listener.setPosition(pos.x, pos.y, pos.z);\n        }\n    }\n}\n\n\nRendererAudio = singletonize(RendererAudio);\n\n// module exports\nexport { RendererAudio };","import {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\n\nclass Font\n{\n    /**\n     Font are not managed in Mobilizing.js like in a usual DOM context as we are using WebGL. To be able to use both bitmap rendered font and 3D vector rendering, we use openType.js (https://nodebox.github.io/opentype.js/ big thanks to Frederik!) to load any web compilant font and the use it in other classes (like {{#crossLink \"Label\"}}{{/crossLink}} or {{#crossLink \"Mesh\"}}{{/crossLink}})\n     @class Font\n     @constructor\n     @param {Object} params\n     @param {Mixed} params.fontFile the font file already loaded, must be loaded with response type setted to arraybuffer\n    */\n    constructor(params)\n    {\n        this._fontFile = getOrDefault(params, \"fontFile\", undefined);\n        this._font = opentype.parse(this._fontFile);\n    }\n\n    /**\n    * Return the underlying Font.js object to work with it outside of Mobilizing.Font\n    * @private\n    * @method getFont\n    * @return {Object} Font.js object\n    */\n    getFont()\n    {\n        return this._font;\n    }\n\n    /**\n    * Calculates the size (in pixels) that should take the string with this font at the given fontSize. Handy for Label creation.\n    * @method getTextSize\n    * @param {String} text the string to use for the size computing\n    * @param {Number} fontSize the text font size to use\n    * @return {Object.width, Object.height} width and height\n    */\n    getTextSize(text, fontSize)\n    {\n        let kerning, fontScale, glyphs, i, glyph, options, kerningValue;\n        let ymax = [];\n\n        if (!this._font.supported)\n        {\n            return;\n        }\n        let x = 0;\n        let y = 0;\n        fontSize = fontSize !== undefined ? fontSize : 72;\n        options = options || {};\n        kerning = options.kerning === undefined ? true : options.kerning;\n        fontScale = 1 / this._font.unitsPerEm * fontSize;\n        glyphs = this._font.stringToGlyphs(text);\n\n        for (i = 0; i < glyphs.length; i += 1)\n        {\n            glyph = glyphs[i];\n            //callback(glyph, x, y, fontSize, options);\n            ymax.push( (glyph.getMetrics().yMax - glyph.getMetrics().yMin) * fontScale);\n            if (glyph.advanceWidth)\n            {\n                x += glyph.advanceWidth * fontScale;\n            }\n            if (kerning && i < glyphs.length - 1)\n            {\n                kerningValue = this._font.getKerningValue(glyph, glyphs[i + 1]);\n                x += kerningValue * fontScale;\n            }\n        }\n        return({width: x, height: Math.max.apply(0,ymax) });\n    }\n}\n\n// module exports\nexport { Font };","import {Transform} from './Transform';\n\n/*\n * LODGroup Class\n *\n * @class LODGroup\n */\n\nclass LODGroup\n{\n\n    constructor()\n    {\n        this.transform = new Transform(this/*.light*/);\n        this.bias = 1;\n        this.factor = -0.1;\n    }\n\n    //process LOD\n    process(position)\n    {\n        var thisposition = this.transform.getWorldPosition();\n        var distance = this.getDistance(position, thisposition);\n        var lod = this.bias+distance*this.factor;\n\n    }\n\n\n    getDistance(p1,p2)\n    {\n        var d = Math.sqrt((p1.x-p2.x)*(p1.x-p2.x) + (p1.y-p2.y)*(p1.y-p2.y)+ (p1.z-p2.z)*(p1.z-p2.z));\n        return d;\n    }\n\n    applyLOD(lod)\n    {\n\n\n    }\n\n}\n\n// module exports\nexport { LODGroup };","import {getOrDefault} from '../helpers/Misc';\nimport {Font} from '../scene/Font';\nimport {Color} from '../core/Color';\n\n/**\n * StyledLetter is a class that helps to represents a letter with its style for later drawing.\n * @class StyledLetter\n * @constructor\n * @param {Object} params Parameters Object\n * @param {String} params.letter the letter's string (character)\n * @param {Number} params.size the size of the font\n * @param {Font} params.font a Mobilizing font reference\n * @param {Color} params.color a Mobilizing Color\n */\nclass StyledLetter\n{\n    constructor(params)\n    {\n        this.letter = getOrDefault(params, \"letter\", \"\");\n        this.size = getOrDefault(params, \"size\", 40);\n        this.font = getOrDefault(params, \"font\", undefined);//mobilizing font\n        this.path; //openType Path\n        this.boundingBox; //derived from path\n\n        this.color = getOrDefault(params, \"color\", Color.black.clone());\n\n        this.x = 0;\n        this.y = 0;\n        this.width = 0;\n        this.height = 0;\n\n        if(this.font)\n        {\n            this.update();\n        }\n    }\n\n    /**\n    * Updates properties according to the new settings\n    * @method update\n    */\n    update()\n    {\n        let size = this.font.getTextSize(this.letter, this.size);\n        this.width = size.width;\n        this.height = size.height;\n\n        this.path = this.font.getFont().getPath(this.letter, this.x, this.y, this.size);\n        this.path.fill = \"#\" + this.color.getHexString(); //this.color;\n        this.boundingBox = this.path.getBoundingBox();\n    }\n    /**\n    * Defines the letter's string\n    * @method setLetter\n    * @param {String} letter\n    */\n    setLetter(val)\n    {\n        this.letter = val;\n    }\n    /**\n    * Defines the letter's x coord\n    * @method setX\n    * @param {Number} x\n    */\n    setX(val)\n    {\n        this.x = val;\n    }\n    /**\n    * Defines the letter's y coord\n    * @method setY\n    * @param {Number} y\n    */\n    setY(val)\n    {\n        this.y = val;\n    }\n    /**\n    * Defines the letter's font size\n    * @method setSize\n    * @param {Number} size\n    */\n    setSize(val)\n    {\n        this.size = val;\n    }\n    /**\n    * Defines the letter's color\n    * @method setColor\n    * @param {Color} color\n    */\n    setColor(color)\n    {\n        this.color = color;\n    }\n    /**\n    * Defines the letter's font\n    * @method setFont\n    * @param {Font} font\n    */\n    setFont(font)\n    {\n        this.font = font;\n    }\n}\n\n/**\n * StyledTextElement is a simple class to organise text elements extacted from HTML text. It contains an array of StyledLetter.\n * @class StyledTextElement\n * @constructor\n * @param {Object} params Parameters Object\n * @param {String} params.text the text string (character)\n * @param {Number} params.size the size of the font\n * @param {Font} params.font a Mobilizing font reference\n * @param {Color} params.color a Mobilizing Color\n */\nclass StyledTextElement\n{\n    constructor(params)\n    {\n        this.text = getOrDefault(params, \"text\", \"\");\n        this.font = getOrDefault(params, \"font\", undefined);\n        this.size = getOrDefault(params, \"size\", 40);\n        this.color = getOrDefault(params, \"color\", Color.black.clone());\n        \n        this.path;\n        this.boundingBox;\n\n        this.line = 0;\n\n        this.x = 0;\n        this.y = 0;\n        this.width = 0;\n        this.height = 0;\n\n        this.styledLetters = [];\n\n        if(this.font)\n        {\n            this.update();\n        }\n    }\n    /**\n    * Updates properties according to the new settings (including styledLetters array properties)\n    * @method update\n    */\n    update()\n    {\n        let size = this.font.getTextSize(this.text, this.size);\n        this.width = size.width;\n        this.height = size.height;\n\n        this.path = this.font.getFont().getPath(this.text, this.x, this.y, this.size);\n        this.path.fill = \"#\" + this.color.getHexString(); //this.color;\n        this.boundingBox = this.path.getBoundingBox();\n\n        let baseWidth = 0;\n\n        for(let i=0; i<this.styledLetters.length; i++)\n        {\n            let styledLetter = this.styledLetters[i];\n            styledLetter.font = this.font;\n            if(i === 0)\n            {\n                styledLetter.setX(this.x);\n                baseWidth = styledLetter.width;\n            }\n            else\n            {\n                styledLetter.setX(this.x + baseWidth);\n                baseWidth += styledLetter.width;\n            }\n            styledLetter.setY(this.y);\n            styledLetter.setSize(this.size);\n            styledLetter.setColor(this.color);\n            styledLetter.update();\n        }\n    }\n    /**\n    * Defines the letter's font\n    * @method setFont\n    * @param {Font} font\n    */\n    setFont(font)\n    {\n        this.font = font;\n    }\n    /**\n    * Defines the letter's color\n    * @method setColor\n    * @param {Color} color\n    */\n    setColor(color)\n    {\n        this.color = color;\n    }\n    /**\n    * Defines the letter's x\n    * @method setX\n    * @param {Number} x\n    */\n    setX(val)\n    {\n        this.x = val;\n    }\n    /**\n    * Defines the letter's y\n    * @method setY\n    * @param {Number} y\n    */\n    setY(val)\n    {\n        this.y = val;\n    }\n    /**\n    * Defines the letter's font size\n    * @method setSize\n    * @param {Font} size\n    */\n    setSize(val)\n    {\n        this.size = val;\n    }\n    /**\n    * Defines the letter's path\n    * @method setPath\n    * @param {Path} openType.js object's Path\n    */\n    setPath(val)\n    {\n        this.path = val;\n    }\n    /**\n    * Defines the letter's text string\n    * @method setText\n    * @param {String} text\n    */\n    setText(val)\n    {\n        this.text = val;\n        this.styledLetters = [];\n\n        for(let i=0; i<this.text.length; i++)\n        {\n            let char = this.text.charCodeAt(i);\n            let styledLetter = new StyledLetter({letter: String.fromCharCode(char),\n                                                 font: this.font,\n                                                 size: this.size,\n                                                 color: this.color\n                                                });\n            this.styledLetters.push(styledLetter);\n        }\n    }\n}\n\nclass TextLine\n{\n    /**\n    * TextLine is a thin layer class to organise text elements extacted from HTML text in lines. It gives the possibility to easily compute the global size of the line. Used in RichText.\n    * @class TextLine\n    * @constructor\n    */\n    constructor()\n    {\n        this.styledTextElements = [];\n        this.width = 0;\n    }\n}\n\nexport { StyledLetter, StyledTextElement, TextLine };","import {Base} from '../Base';\nimport {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\nimport {Loader} from '../helpers/Loader';\nimport {Font} from '../scene/Font';\nimport {Color} from '../core/Color';\nimport {EventEmitter} from '../helpers/EventEmitter';\nimport {StyledTextElement, StyledLetter, TextLine} from '../text/TextUtils';\n\n/**\n* Triggered when the canvas has been redrawn, useful to synchronise Texture update and canvas refresh\n* @event drawn\n*/\nconst EVT_DRAWN = \"drawn\";\n\nconst TEXT_ALIGN_LEFT = \"left\";\nconst TEXT_ALIGN_RIGHT = \"right\";\nconst TEXT_ALIGN_CENTER = \"center\";\n\nclass RichText extends Base\n{\n    /**\n    * RichText class uses standard HTML Text to format text drawn with a certain style in a Canvas. Supported HTML style tags are <b>, <strong>, <i>, <em>, <br>, <p>, <font> with attributes color and size. TODO : support of face attribute in <font>. Default font are predefined.\n    * @class RichText\n    * @extends Base\n    * @constructor\n    * @param {Object} params Parameters Object\n    * @param {HTMLNode} params.htmlText the html text to draw in the canvas\n    * @param {Number} [params.width=512] width of the inner canvas\n    * @param {Number} [params.height=512] height of the inner canvas\n    * @param {Number} [params.lineHeight=1] line height for the text\n    * @param {Number} [params.margins=10] white space (margin) in pixel on all left, top, right and bottom of the canvas. Text will be drawn within these boundaries with automatic newline management. \n    * @param {Number} [params.marginLeft=10] white space (margin) in pixel on left side.\n    * @param {Number} [params.marginTop=10] white space (margin) in pixel on top side.\n    * @param {Number} [params.marginRight=10] white space (margin) in pixel on right side.\n    * @param {Number} [params.marginBottom=10] white space (margin) in pixel on bottom side.\n    * @param {Number} [params.textSize=20] size, in pixels, of the text\n    * @param {Color} [params.textColor=black] color the text default color\n    * @param {Color} [params.textAlign=\"left\"] text alignment in the canvas (margins included), can be one of \"left\", \"center\", \"right\".\n    * @param {Color} [params.backgroundColor=white] color the background color\n    * @param {Boolean} [params.drawBoundingBox=false] tell to draw the bounding boxes of every text blocs or not\n    * @param {Number} [params.boundingBoxStrokeWidth=1] the lineWidth to use for bounding boxes drawing\n    * @param {URL} params.fontURL url for the regular font file\n    * @param {URL} params.fontItalicURL url for the italic font file\n    * @param {URL} params.fontBoldURL url for the bold font file\n    * @param {URL} params.fontBoldItalicURL url for the bold-italic font file\n    * \n    */\n    constructor(params)\n    {\n        super(params);\n\n        this._width = getOrDefault(params, \"width\", 512);\n        this._height = getOrDefault(params, \"height\", 512);\n        this._backgroundColor = getOrDefault(params, \"backgroundColor\", Color.white.clone());\n        this._lineHeight = getOrDefault(params, \"lineHeight\", 1);\n        \n        this._margins = {left: 0, right:0, top:0, bottom:0};\n        let margins = getOrDefault(params, \"margins\", 10);\n        this._margins.left = getOrDefault(params, \"marginLeft\", margins);\n        this._margins.right = getOrDefault(params, \"marginRight\", margins);\n        this._margins.top = getOrDefault(params, \"marginTop\", margins);\n        this._margins.bottom = getOrDefault(params, \"marginBottom\", margins);\n        \n        this._textSize = getOrDefault(params, \"textSize\", 20);\n        this._textColor = getOrDefault(params, \"textColor\", Color.black.clone());\n        this._textAlign = getOrDefault(params, \"textAlign\", TEXT_ALIGN_LEFT);\n        this._boundingBoxStrokeWidth = getOrDefault(params, \"boundingBoxStrokeWidth\", 1);\n        this._drawBoundingBox = getOrDefault(params, \"drawBoundingBox\", false);\n\n        this._fontURL = getOrDefault(params, \"fontURL\", \"fonts/Raleway-Regular.ttf\");\n        this._fontItalicURL = getOrDefault(params, \"fontItalicURL\", \"fonts/Raleway-Regular-Italic.ttf\");\n        this._fontBoldURL = getOrDefault(params, \"fontBoldURL\", \"fonts/Raleway-Bold.ttf\");\n        this._fontBoldItalicURL = getOrDefault(params, \"fontBoldItalicURL\", \"fonts/Raleway-Bold-Italic.ttf\");\n\n        this._canvas = document.createElement(\"canvas\");\n        this._canvas.width = this._width;\n        this._canvas.height = this._height;\n        this._canvasContext = this._canvas.getContext(\"2d\");\n\n        this._canvas.events = new EventEmitter({scope:this._canvas});\n\n        /*document.body.appendChild(this._canvas);\n        this._canvas.style.position = \"absolute\";*/\n\n        this._text = getOrDefault(params, \"text\", undefined);\n\n        if(this._text)\n        {\n            this._DOMText = document.createElement(\"div\")\n            this._DOMText.innerHTML = this._text;\n            this.styledText = this.parseDOMTree(this._DOMText);\n        }\n        else\n        {\n            console.error(\"no html text provided\");\n        }\n\n        //for internal use\n        this._lines = [];\n\n        //loading font chain\n        Loader.loadArrayBuffer(this._fontURL, (data) => {\n            this._defaultFontFile = data;\n\n            Loader.loadArrayBuffer(this._fontItalicURL, (data) => {\n                this._defaultItalicFontFile = data;\n\n                Loader.loadArrayBuffer(this._fontBoldURL, (data) => {\n                    this._defaultBoldFontFile = data;\n\n                    Loader.loadArrayBuffer(this._fontBoldItalicURL, (data) => {\n                        this._defaultBoldItalicFontFile = data;\n\n                        this.setup();\n                    });\n                });\n            });\n        });\n\n    }\n\n    /**\n    * Setup bloc called after default font loading\n    * @private\n    * @method setup\n    */\n    setup()\n    {\n        this._defaultFont = new Font({fontFile: this._defaultFontFile});\n        this._defaultItalicFont = new Font({fontFile: this._defaultItalicFontFile});\n        this._defaultBoldFont = new Font({fontFile: this._defaultBoldFontFile});\n        this._defaultBoldItalicFont = new Font({fontFile: this._defaultBoldItalicFontFile});\n\n        this.render();\n    }\n\n    /**\n    * Get canvas width\n    * @method getWidth\n    * @return {Number} canvas width\n    */\n    getWidth()\n    {\n        return this._width;\n    }\n    /**\n    * Get canvas height\n    * @method getHeight\n    * @return {Number} canvas height\n    */\n    getHeight()\n    {\n        return this._height;\n    }\n\n    /**\n    * Get the canvas\n    * @method getCanvas\n    * @return {Canvas} canvas\n    */\n    getCanvas()\n    {\n        return this._canvas;\n    }\n\n    /**\n    * Stater method to process the html tree. Manage internally the array used afterward to contain all StyledTextElement.\n    * @method parseDOMTree\n    * @param {DOMNodeObject} baseNode\n    * @return {Array} the resulting StyledTextElement array\n    */\n    parseDOMTree(baseNode)\n    {\n        var styledText = [];\n\n        this.processDOMTree(baseNode, styledText);\n        //console.log(styledText);\n        return styledText;\n    }\n\n    /**\n    * Recursive process of an html tree from it's main node. This method return a linear list (in the original text strings order) of StyledTextElement in order to cumulate all the tags a piece of string is attach to and the attributes of its immediate parent tag.\n    * @method processDOMTree\n    * @param {DOMNodeObject} baseNode\n    * @param {Array} destArray the array of destination\n    */\n    processDOMTree(baseNode, destArray)\n    {\n        let i = 0;\n        let node;\n\n        //lazy <p> support : <p> has automatic margin, top and bottom, of 1 line-height, which is 2 <br> ;-)\n        //TODO : support <p> top and bottom margin ?\n        if(baseNode.tagName === \"P\")\n        {\n            if(baseNode.previousElementSibling.tagName === \"P\")\n            {\n                baseNode.innerHTML = baseNode.innerHTML + \"<br>\";\n            }\n            else\n            {\n                baseNode.innerHTML = \"<br><br>\" + baseNode.innerHTML + \"<br>\";\n            }\n        }\n\n        while(node = baseNode.childNodes[i])\n        {\n\n            let children = node.childNodes.length;\n\n            if(children >= 1){\n                this.processDOMTree(node, destArray);\n            }\n            else\n            {\n                //split the textContent\n                let words = node.textContent.split(/\\s/);\n\n                //StyledTextElement array construction loop\n                for(let w = 0; w < words.length; w++)\n                {\n                    let el = new StyledTextElement();\n                    //surchage StyledTextElement\n                    el.attributes = [];\n                    el.tags = [];\n                    el.setText(words[w]);\n\n                    //reconstruct white space, lost after split, take first place, \\n and \".\" is first as conditions\n                    if( w !== 0)\n                    {\n                        el.text = \" \" + el.text;\n                    }\n\n                    //manage attributes at parent level as it's how it's done\n                    if(node.parentNode.attributes)\n                    {\n                        for(let a=0; a<node.parentNode.attributes.length; a++)\n                        {\n                            el.attributes.push({name:node.parentNode.attributes[a].name,\n                                                value:node.parentNode.attributes[a].value});\n                        }\n                    }\n\n                    if(node.tagName){\n                        el.tags.push(node.tagName);\n                    }\n\n                    let tempNode = node;\n                    while(tempNode.parentNode)\n                    {\n                        if(tempNode.parentNode.tagName !== \"DIV\")//avoid to take the main enclosing span\n                        {\n                            el.tags.push(tempNode.parentNode.tagName);\n                        }\n                        tempNode = tempNode.parentNode;\n                    }\n                    destArray.push(el);\n                }\n            }\n            i++;\n        }\n\n        return destArray;\n    }\n\n\n    /**\n    * Render the input HTML text parsed in an array of StyledTextElement in the current canvas\n    * @method render\n    */\n    render()\n    {\n        //background color\n        if(this._backgroundColor !== Color.transparent.makeRGBAStringWithAlpha(0))\n        {\n            //console.log(this._backgroundColor, Color.transparent.makeRGBAStringWithAlpha(0));\n            this._canvasContext.fillStyle = \"#\" + this._backgroundColor.getHexString();\n            this._canvasContext.fillRect(0,0, this._width, this._height);\n        }\n        \n\n        //x position of drawing (letter pos in x)\n        var letterXOffset = this._margins.left;\n        //y position of drawing (letter pos in y, or baseline)\n        var lineYOffset = this._margins.top;\n        //number of lines in the canvas\n        var lineCount = 0;\n\n        for(let i=0; i<this.styledText.length; i++)\n        {\n            let el = this.styledText[i];\n\n            //select the font to use\n            let currentFont = this._defaultFont;\n\n            //define the font based on associated tags\n            if(el.tags.indexOf(\"B\") >= 0 || el.tags.indexOf(\"STRONG\") >= 0)\n            {\n                currentFont = this._defaultBoldFont;\n            }\n            if (el.tags.indexOf(\"I\") >= 0 || el.tags.indexOf(\"EM\") >= 0)\n            {\n                currentFont = this._defaultItalicFont;\n            }\n            if (el.tags.indexOf(\"B\") >= 0 && el.tags.indexOf(\"I\") >= 0 ||\n                el.tags.indexOf(\"STRONG\") >= 0 && el.tags.indexOf(\"EM\") >= 0)\n            {\n                currentFont = this._defaultBoldItalicFont;\n            }\n\n            let size = this._textSize;\n\n            //test for new line <br> and add a new line to lineCount\n            if(el.tags.indexOf(\"BR\") >= 0)\n            {\n                lineYOffset += size * this._lineHeight;\n                letterXOffset = this._margins.left;\n                //increment the lineNb\n                lineCount++;\n                console.log(\"lineYOffset\",lineYOffset);\n            }\n\n            let color = this._textColor;\n\n            //is it the 1st run ?  place the baseline to the margin + font size\n            if(lineYOffset === this._margins.top)\n            {\n                lineYOffset += size;\n            }\n\n            //test for new line from canvas width limit and reset offsets and add a new line to lineCount\n            let tempWidth = letterXOffset + currentFont.getTextSize(el.text, size).width;\n\n            if(tempWidth > this._width - this._margins.right)\n            {\n                lineYOffset += size * this._lineHeight;\n                letterXOffset = this._margins.left;\n                //to erase first space and avoid unused whitespace at line start\n                el.text = el.text.replace(/^\\s/, \"\");\n                //increment the lineNb\n                lineCount++;\n            }\n\n            //manage font tag attributes\n            //TODO : manage font changes!!\n            if(el.attributes)\n            {\n                for(let j=0; j<el.attributes.length; j++)\n                {\n                    if(el.attributes[j].name === \"color\")\n                    {\n                        color = new Color(el.attributes[j].value);\n                    }\n                    if(el.attributes[j].name === \"size\")\n                    {\n                        size = Number(el.attributes[j].value);\n                    }\n                }\n            }\n            //set the font to use\n            el.setFont(currentFont);\n            /*el.setPath(currentFont.getFont().getPath(el.text, letterXOffset, lineYOffset, size));*/\n            let fontTextSize = currentFont.getTextSize(el.text, size);\n\n            //store info in the object\n\n            el.line = lineCount;\n            el.setX(letterXOffset);\n\n            el.setY(lineYOffset);\n\n            el.setSize(size);\n            //el.setColor(\"#\" + color.getHexString());\n            el.setColor(color);\n            el.update();//refresh\n\n            //populate the lines object for later align computation\n            if(this._lines[lineCount])\n            {\n                let lineObj = this._lines[lineCount];\n                lineObj.styledTextElements.push(el);\n                lineObj.width += el.width;\n            }\n            else\n            {\n                let lineObj = new TextLine();\n                lineObj.styledTextElements.push(el);\n                lineObj.width += el.width;\n\n                this._lines.push(lineObj);\n            }\n\n            //update the x offset for next el\n            letterXOffset += fontTextSize.width;\n        }\n\n        //console.log(this._lines);\n\n        //text-align loop, we adjust x positions of every text bloc\n        for(let i=0; i<this._lines.length; i++)\n        {\n            let xDiff;\n            let line = this._lines[i];\n\n            //compute the x difference between current and desired align\n            switch(this._textAlign)\n            {\n                case TEXT_ALIGN_CENTER :\n                    {\n                        xDiff = (this._width/2) - (this._margins.left + line.width/2);\n                    }\n                    break;\n\n                case TEXT_ALIGN_RIGHT :\n                    {        \n                        xDiff = (this._width-this._margins.left) - (this._margins.right + line.width);\n                    }\n                    break;\n            }\n\n            if(xDiff !== undefined)\n            {\n                for(let j=0; j<line.styledTextElements.length; j++)\n                {\n                    let el = line.styledTextElements[j];\n                    el.setX(el.x + xDiff);\n                    el.update();//refresh\n                }\n            }\n\n        }\n\n        //draw loop\n        for(let i=0; i<this.styledText.length; i++)\n        {\n            let el = this.styledText[i];\n            el.path.draw(this._canvasContext);\n\n            if(this._drawBoundingBox)\n            {\n                let boundingBox = el.path.getBoundingBox();\n                this._canvasContext.beginPath();\n                this._canvasContext.moveTo(boundingBox.x1, boundingBox.y1);\n                this._canvasContext.lineTo(boundingBox.x2, boundingBox.y1);\n                this._canvasContext.lineTo(boundingBox.x2, boundingBox.y2);\n                this._canvasContext.lineTo(boundingBox.x1, boundingBox.y2);\n                this._canvasContext.lineTo(boundingBox.x1, boundingBox.y1 - this._boundingBoxStrokeWidth/2);\n                this._canvasContext.lineWidth = this._boundingBoxStrokeWidth;\n                this._canvasContext.stroke();\n            }\n        }\n\n        //emit a custom event on the canvas to refresh texture when used\n        this._canvas.events.trigger(EVT_DRAWN);\n    }\n\n}\n\n// module exports\nexport { RichText };\n","import * as THREE from 'three';\nimport {getOrDefault, getOrExec} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\nimport {StyledLetter, StyledTextElement} from \"../text/TextUtils\";\n\nclass CanvasTexture\n{\n    /**\n     * CanvasTexture Class simplifies the creation of texture from an HTML5 canvas. Any valid canvas can be used to create a texure that can then be attached to a material.\n     * Some helpers static methods are implemented to quickly creates some commons shapes (rectangles, circle).\n     * Stroke and fill colors can be changed on the fly if update methods is called afterward\n     *\n     * @class CanvasTexture\n     * @constructor\n     * @param {Object} params an object containing all the possible parameters for this class. Use it like in the following example. Possible parameters are lisited below.\n     * @example\n     *     //TODO\n     *\n     * @param {Canvas} [params.canvas = a canvas will be created internally if undefined] the canvas to use\n     * @param {Context} [params.context] the Mobilizing context to use\n     * @param {Number} [params.width = 100] width the width of the canvas\n     * @param {Number} [params.height = 100] height the height of the canvas\n     * @param {Number} [params.strokeWidth = 1] strokeWidth as an integer\n     * @param {Color} [params.strokeColor] strokeColor as a Mobilizing Color\n     * @param {Number} [params.strokeOpacity = 1] strokeOpacity as a float between 0 and 1\n     * @param {Color} [params.fillColor] fillColor as a Mobilizing Color\n     * @param {Number} [params.fillOpacity = 1] fillOpacity as a float between 0 and 1\n    */\n    constructor(params)\n    {\n        this._strokeWidth = getOrDefault(params, \"strokeWidth\", 1);\n        this._strokeColor = getOrDefault(params, \"strokeColor\", undefined);\n        this._strokeOpacity = getOrDefault(params, \"strokeOpacity\", 1);\n        this._fillColor = getOrDefault(params, \"fillColor\", undefined);\n        this._fillOpacity = getOrDefault(params, \"fillOpacity\", 1);\n\n        this._width = getOrDefault(params, \"width\", 100);\n        this._height = getOrDefault(params, \"height\", 100);\n\n        this._canvas = getOrExec(params, \"canvas\", () => {\n            let canvas = document.createElement(\"canvas\");\n            canvas.width = this._width;\n            canvas.height = this._height;\n            return canvas;\n        });\n\n        this._texture = new THREE.Texture(this._canvas);\n        this._texture.needsUpdate = true;\n        //avoid smoothing of pixels\n        this._texture.minFilter = THREE.NearestFilter;\n        this._texture.magFilter = THREE.NearestFilter;\n        this._texture.generateMipmaps = false;\n\n        this._canvasContext = this._canvas.getContext(\"2d\");\n\n        this.update();\n    }\n\n    /**\n    * Get this texture base canvas\n    * @method getCanvas\n    * @return canvas {Canvas}\n    */\n    getCanvas()\n    {\n        return this._canvas;\n    }\n\n    /**\n    * Get this texture base canvas context, to directly daw on it\n    * @method getCanvasContext\n    * @return canvasContext {CanvasContext}\n    */\n    getCanvasContext()\n    {\n        return this._canvasContext;\n    }\n\n    /**\n    * Fills the canvas with the given color\n    * @method fillWithColor\n    * @param {Color} color Mobilizing Color to use\n    */\n    fillWithColor(color)\n    {\n        this.setFillColor(color);\n        this.update();\n        this._canvasContext.fillRect(0,0, this._width, this._height);\n        this._texture.needsUpdate = true;\n    }\n\n    /**\n    * resizeCanvas resizes and refresh the canvasContext interally\n    * @method resizeCanvas\n    * @param {Number} width\n    * @param {Number} height\n    */\n    resizeCanvas(width, height)\n    {\n        this._canvas.width = width;\n        this._canvas.height = height;\n        this._canvasContext = this._canvas.getContext(\"2d\");\n    }\n\n    /**\n    * Get the canvas's width\n    * @method getWidth\n    * @return width {Number}\n    */\n    getWidth()\n    {\n        return this._width;\n    }\n\n    /**\n    * Get the canvas's height\n    * @method getHeight\n    * @return height {Number}\n    */\n    getHeight()\n    {\n        return this._height;\n    }\n\n    /**\n    * @method setStrokeColor\n    * @param {Color} c new stroke width\n    */\n    setStrokeColor(c)\n    {\n        this._strokeColor = c;\n    }\n\n    /**\n    * @method setFillColor\n    * @param {Color} c new stroke width\n    */\n    setFillColor(c)\n    {\n        this._fillColor = c;\n    }\n\n    /**\n    * @method setStrokeWidth\n    * @param {Number} w new stroke width\n    */\n    setStrokeWidth(w)\n    {\n        this._strokeWidth = w;\n    }\n\n    /**\n    * Updates the current canvas so that it reflects graphically all the changes done (colors, strokeWidth, etc.)\n    * Should be called after the changes has been given.\n    * @method update\n    */\n    update()\n    {\n        var tempStrokeColor, tempFillColor;\n\n        if(this._strokeColor)\n        {\n            tempStrokeColor = this.toRGBAColorString(this._strokeColor, this._strokeOpacity);\n        }\n        else\n        {\n            tempStrokeColor = \"rgba(0,0,0,0)\";\n        }\n        if(this._fillColor)\n        {\n            tempFillColor = this.toRGBAColorString(this._fillColor, this._fillOpacity);\n        }\n        else\n        {\n            tempFillColor = \"rgba(0,0,0,0)\";\n        }\n\n        debug.log(\"this._strokeColor\",this._strokeColor,\"this._fillColor\",this._fillColor);\n        debug.log(\"tempStrokeColor\",tempStrokeColor,\"tempFillColor\",tempFillColor);\n\n        this._canvasContext.strokeStyle = tempStrokeColor;\n        this._canvasContext.fillStyle = tempFillColor;\n        this._canvasContext.lineWidth = this._strokeWidth;\n\n        this._canvasContext.clearRect(0,0,this._width, this._height);\n        this._canvasContext.fill();\n        this._canvasContext.stroke();\n\n        this._texture.needsUpdate = true;\n    }\n\n    /**\n    * Draw an Mobilizing StyledText or StyledLetter in the canvas object and updates it.\n    * \n    * @method drawStyledText\n    * @param {StyledText || StyledLetter} text\n    */\n    drawStyledText(text)\n    {\n        text.path.draw(this._canvasContext);\n        this._texture.needsUpdate = true;\n    }\n\n    /**\n    * Draw an Image in the canvas object and updates it.\n    * \n    * @method drawImage\n    * @param {Image} image\n    * @param {Number} x x coordinate to start drawing (from upper-left corner)\n    * @param {Number} y y coordinate to start drawing (from upper-left corner)\n    * @param {Number} [width=canvas.width] the destination width to draw to\n    * @param {Number} [height=canvas.height]  the destination height to draw to\n    */\n    drawImage(image, x, y, width, height)\n    {\n        this._canvasContext.drawImage(image,\n                                      (x) ? x : 0,\n                                      (y) ? y : 0,\n                                      (width) ? width : this._width,\n                                      (height) ? height : this._height);\n\n        this._texture.needsUpdate = true;\n    }\n\n    /**\n    * toRGBAColorString makes a css rgba color from a Mobilizing Color and an alpha value (0:1)\n    * @private\n    * @method toRGBAColorString\n    * @param {Color} color\n    * @param {Number} alpha\n    */\n    toRGBAColorString(color,alpha)\n    {\n        var c = \"rgba(\"+Math.floor(color.r*255)+\",\"+Math.floor(color.g*255)+\",\"+Math.floor(color.b*255)+\",\"+ alpha +\")\";\n        return c;\n    }\n\n    /**\n    * CreateRect prepares a canvas and a path to draw a rectangle\n    * @static\n    * @method CreateRect\n    * @param {Object} params object of paramaters\n    * @param {Number} params.width\n    * @param {Number} params.height\n    * @param {Number} params.strokeWidth\n    * @param {Color} params.strokeColor\n    * @param {Color} params.fillColor\n    */\n    static CreateRect(params)\n    {\n        let width = getOrDefault(params, \"width\", 100);\n        let height = getOrDefault(params, \"height\", 100);\n        let strokeWidth = getOrDefault(params, \"strokeWidth\", 1);\n        let strokeColor = getOrDefault(params, \"strokeColor\", 0);\n        let fillColor = getOrDefault(params, \"fillColor\", 0);\n        let fillOpacity = getOrDefault(params, \"fillOpacity\", 1);\n        let strokeOpacity = getOrDefault(params, \"strokeOpacity\", 1);\n\n        let canvas = document.createElement(\"canvas\");\n        canvas.width = width; canvas.height = height;\n        let ctx = canvas.getContext(\"2d\");\n        ctx.lineWidth = strokeWidth;\n        ctx.beginPath();\n        ctx.lineTo(0,0);\n        ctx.lineTo(width,0);\n        ctx.lineTo(width,height);\n        ctx.lineTo(0,height);\n        ctx.lineTo(0,0);\n        ctx.closePath();\n\n        ctx.fill();\n        ctx.stroke();\n\n        //reset params\n        params = {};\n\n        params.canvas = canvas;\n        params.width = width;\n        params.height = height;\n        params.strokeWidth = strokeWidth;\n        params.strokeColor = strokeColor;\n        params.fillColor = fillColor;\n        params.fillOpacity = fillOpacity;\n        params.strokeOpacity = strokeOpacity;\n\n        let obj = new CanvasTexture(params);\n\n        return obj;\n    }\n\n    /**\n    * CreateCircle prepares a canvas and a path to draw a circle\n    * @static\n    * @method CreateCircle\n    * @param {Object} params object of paramaters\n    * @param {Number} params.radius\n    * @param {Number} params.strokeWidth\n    * @param {Color} params.strokeColor\n    * @param {Color} params.fillColor\n    */\n    static CreateCircle(params)\n    {\n        var radius = getOrDefault(params, \"radius\", 100);\n        var strokeWidth = getOrDefault(params, \"strokeWidth\", 1);\n        var strokeColor = getOrDefault(params, \"strokeColor\", 0);\n        var fillColor = getOrDefault(params, \"fillColor\", 0);\n        var fillOpacity = getOrDefault(params, \"fillOpacity\", 1);\n        var strokeOpacity = getOrDefault(params, \"strokeOpacity\", 1);\n\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = radius+strokeWidth; canvas.height = radius+strokeWidth;\n        var ctx = canvas.getContext(\"2d\");\n        ctx.strokeStyle = strokeColor ? strokeColor.getHexString() : undefined;\n        ctx.fillStyle = fillColor ? fillColor.getHexString() : undefined;\n        ctx.lineWidth = strokeWidth;\n        //ctx.rect(0,0,canvas.width,canvas.height);\n        ctx.beginPath();\n        ctx.arc(radius/2 + strokeWidth/2, radius/2 + strokeWidth/2, radius/2, 0, 2 * Math.PI, false);\n        ctx.closePath();\n\n        ctx.fill();\n        ctx.stroke();\n\n        document.body.appendChild(canvas);\n\n        //reset params\n        params = {};\n\n        params.canvas = canvas;\n        params.width = radius;\n        params.height = radius;\n        params.strokeWidth = strokeWidth;\n        params.strokeColor = strokeColor;\n        params.fillColor = fillColor;\n        params.fillOpacity = fillOpacity;\n        params.strokeOpacity = strokeOpacity;\n\n        var obj = new CanvasTexture(params);\n\n        return obj;\n    }\n\n}\n\n// module exports\nexport { CanvasTexture };","import {debug} from '../helpers/Debug';\n\nclass DOMNodeTexture\n{\n    /*\n     * DOMNodeTexture Class gives an easy way to inject HTML node into Mobilizing.js thanks to domvas.js, a small library that \"paint\" the content of an HTML element tree to a canvas. Mus be mapped to a Mesh via a Matirial texture field.\n     * Be warned that this class will give a result ONLY in FireFox and Chrome as Safari's security is too high for the painted canvas to be used as a WebGL Texture (security error is raised and can't be avoided)\n     *\n     * @class DOMNodeTexture\n     * @constructor\n     * @param {DOM Node} node the HTML node to be rasterized\n     */\n    constructor(node)\n    {\n        //this.context = context;\n\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = 512;\n        this.canvas.height = 512;\n\n        var ctx = this.canvas.getContext(\"2d\");\n        ctx.fillStyle = \"rgba(0,0,255,255)\";\n        ctx.lineTo(0,0);\n        ctx.lineTo(this.canvas.width,0);\n        ctx.lineTo(this.canvas.width,this.canvas.height);\n        ctx.lineTo(0,this.canvas.height);\n        ctx.lineTo(0,0);\n        ctx.closePath();\n        ctx.fill();\n        ctx.stroke();\n\n        document.body.appendChild(this.canvas);\n\n        var img = new Image();\n        img.src = this.canvas.toDataURL(\"image/png\");\n        //img.crossOrigin = 'use-credentials';\n\n        var imgEl = document.createElement(\"img\");\n        imgEl.src = img.src;\n        document.body.appendChild(imgEl);\n\n        this.texture = new THREE.Texture(img);\n        this.texture.needsUpdate = true;\n        //add to the document so that css can be computed\n        document.body.appendChild(node);\n\n        //dom to image\n        var self = this;\n\n        domvas.toImage(node, function(){\n\n            ctx.drawImage(this, 0, 0);\n\n            img.src = self.canvas.toDataURL(\"image/png\");\n            imgEl.src = img.src;\n\n            //console.log(self, self.texture);\n            self.update();\n\n        });\n\n        //no need to keep the node in the document\n        //document.body.removeChild(node);\n    }\n\n    /*\n    * Updates the texture accroding to the HTML element.\n    * @private\n    * @method update\n    */\n    update(){\n        var img = new Image();\n        img.src = this.canvas.toDataURL();\n        this.texture.image = img;\n        this.texture.needsUpdate = true;\n    }\n\n    /*\n    * Helper static fonction to add an existing css style to an HTML element on the fly. You can define classes in a css sheet and  attribute them to any HTML Node with this method.\n    * @static\n    * @method addCSSToNode\n    * @param {DOM Node} el the HTML element to apply the CSS class to\n    * @param {String} cssName the CSS class name without the starting \".\"\n    */\n    static addCSSToNode(el, cssName){\n\n        var cssRules = document.styleSheets[0].cssRules;\n\n        if(cssRules){\n            for(var i=0; i<cssRules.length; i++){\n\n                var selector = cssRules[i].selectorText;\n\n                if(selector){\n                    if(selector.indexOf(cssName) > 0){\n                        //apply css\n                        el.classList.add(cssName);\n                        //debug.info(\"css\",cssName,\"to\",el);\n                        return;\n                    }\n                }else{\n                    //debug.info(\"no selectorText in this css\",cssRules[i]);\n                }\n            }\n        }\n        console.error(\"no css class of this name found. Remove the . if any in your argument\");\n    }\n\n}\n\n// module exports\nexport { DOMNodeTexture };","import {Texture} from './Texture';\nimport {debug} from '../helpers/Debug';\n\n/**\n * The ImageSequenceTexture represents a special kind of 2D Texture that is built from a sequence of pictures that you can play at a given rate and with a given play mode.\n *\n * @class ImageSequenceTexture\n */\n\nclass ImageSequenceTexture\n{\n    //var currentTime     = 0;\n    //var playing        = false;\n\n    /**\n    @method constructor\n    @param {Object} context The Mobilizing Context.\n    */\n    constructor(context)\n    {\n        this.currentTime    = 0;\n        this.playing        = false;\n        this.frameRate      = 10;\n        this.context        = context;\n        this.textures       = [];\n        //\n        this.sequenceMode   = 'FORWARD';\n        this.direction      = 1;\n        this.lapsToDo       = -1;\n        this.frameCount     = 0;\n        this.laps           = 0;\n        this.currentFrame   = 0;\n\n    }\n\n    /**\n    Load an image sequence from a wild card URL (the * sign will be replaced by an index starting from min and ending at max).\n\n    @method load\n    @param {String} urlbase wild card base URL. This can be a relative or absolute URL, and can be local or online, depending on your Browser cross domain policies.\n    @param {Integer} min starting index.\n    @param {Integer} max ending index.\n    */\n    load(urlbase, min, max)\n    {\n        for (var i=min;i<=max;++i)\n        {\n            var t = new Texture({context:this.context});\n            var file = urlbase.replace(\"*\", \"\"+i+\"\");\n            t.loadFromFile(file, true);\n            this.textures.push(t);\n        }\n        this.frameCount = this.textures.count;\n        this.enterFrame = 0;\n        this.currentFrame = 0;\n        this.outFrame = max;\n    }\n\n    /**\n    Set the starting frame of the current loaded sequence.\n    @method setEnterFrame\n    @param {Integer} frame starting frame.\n    */\n    setEnterFrame(frame)\n    {\n        if(frame >=0 && frame < this.frameCount){\n            this.enterFrame = frame;\n            this.currentFrame = this.enterFrame;\n        }else{\n            this.enterFrame = 0;\n            this.currentFrame = 0;\n            debug.log(\"ERROR enterFrame %i is out of sequence bounds - back to 0\",frame);\n        }\n    }\n\n    /**\n    Set the ending frame of the current loaded sequence.\n    @method setOutFrame\n    @param {Integer} frame ending frame.\n    */\n    setOutFrame(frame)\n    {\n        if(frame >=this.enterFrame && frame < this.frameCount)\n        {\n            this.outFrame = frame;\n        }\n        else\n        {\n            this.outFrame = this.frameCount-1;\n            debug.log(\"ERROR outFrame %i is out of sequence bounds - back to frameCount\",frame);\n        }\n    }\n\n    /**\n    Set the sequence playing mode.\n    @method setMode\n    @param {String} mode playing mode : \"FORWARD\", BACKWARD\", \"PINGPONG\", \"RANDOM\".\n    */\n    setMode(mode)\n    {\n        this.sequenceMode = mode;\n    }\n\n    /**\n    update the Image sequence. You have to call this once per frame for the Image sequence Texture to update and run its own logic.\n    @method update\n    */\n    update()\n    {\n        if (!this.playing)\n        {\n            return;\n        }\n        this.currentTime += this.context.Time.deltaTime;\n\n        if (this.currentTime > 1/this.frameRate)\n        {\n            this.currentTime -= 1/this.frameRate;\n            //this.currentFrame = Math.floor(this.currentTime*this.frameRate) % this.textures.length;\n            if(this.sequenceMode === 'FORWARD')\n            {\n                if(this.laps >= 0 && this.laps < this.lapsToDo)\n                {\n                    this.currentFrame++;\n                    this.currentFrame %= this.outFrame+1;\n\n                    if(this.currentFrame === 0)\n                    {\n                        this.currentFrame = this.enterFrame;\n                    }\n\n                    if(this.currentFrame === this.outFrame)\n                    {\n                        this.laps++;\n                    }\n                }\n                else if(this.lapsToDo < 0)\n                {\n                    this.currentFrame++;\n                    this.currentFrame %= this.outFrame+1;\n                    if(this.currentFrame === 0)\n                    {\n                        this.currentFrame = this.enterFrame;\n                    }\n                }\n                if(this.lapsToDo === this.laps)\n                {\n                    this.stop();\n                }\n                debug.log(\"currentFrame = \" + this.currentFrame);\n            }\n            else if(this.sequenceMode === 'BACKWARD')\n            {\n                if(this.laps >= 0 && this.laps < this.lapsToDo)\n                {\n                    this.currentFrame--;\n\n                    if(this.currentFrame < this.enterFrame)\n                    {\n                        this.currentFrame = this.outFrame;\n                    }\n                    if(this.currentFrame === this.enterFrame)\n                    {\n                        this.laps++;\n                    }\n\n                }\n                else if(this.lapsToDo < 0)\n                {\n                    this.currentFrame--;\n\n                    if(this.currentFrame < this.enterFrame)\n                    {\n                        this.currentFrame = this.outFrame;\n                    }\n                }\n\n                if(this.lapsToDo === this.laps)\n                {\n                    this.stop();\n                }\n                debug.log(\"currentFrame = \" + this.currentFrame);\n            }\n            else if(this.sequenceMode === 'PINGPONG')\n            {\n\n                if(this.laps >= 0 && this.laps < this.lapsToDo)\n                {\n                    this.currentFrame += this.direction;\n\n                    //protection against border over\n                    if(this.currentFrame < 0)\n                    {\n                        this.currentFrame = 0;\n                    }\n                    if(this.currentFrame > this.outFrame)\n                    {\n                        this.currentFrame = this.outFrame;\n                    }\n\n                    if(this.currentFrame >= this.outFrame)\n                    {\n                        this.direction = -this.direction;\n                        this.laps++;\n                    }\n                    if(this.currentFrame <= this.enterFrame)\n                    {\n                        this.direction = -this.direction;\n                        this.laps++;\n                    }\n                }\n                else if(this.lapsToDo < 0)\n                {\n                    this.currentFrame += this.direction;\n                    if(this.currentFrame >= this.outFrame)\n                    {\n                        this.direction = -this.direction;\n                    }\n                    if(this.currentFrame <= this.enterFrame)\n                    {\n                        this.direction = -this.direction;\n                    }\n                }\n\n                if(this.lapsToDo === this.laps)\n                {\n                    this.stop();\n                }\n                debug.log(\"currentFrame = \" + this.currentFrame);\n            }\n            else if(this.sequenceMode === 'RANDOM')\n            {\n                this.currentFrame = Math.floor(Math.random()*(this.outFrame-this.enterFrame)+this.enterFrame);\n                debug.log(\"currentFrame = \" + this.currentFrame);\n            }\n        }\n    }\n\n    /**\n    Get the current Image Sequence frame Texture.\n    @method getCurrentTexture\n    @return {Texture} the texture\n    */\n    getCurrentTexture()\n    {\n        return this.textures[this.currentFrame];\n    }\n\n    /**\n    play the Image Sequence.\n    @method play\n    */\n    play()\n    {\n        this.playing = true;\n    }\n\n    /**\n    pause the Image Sequence.\n    @method pause\n    */\n    pause()\n    {\n        this.playing = false;\n    }\n\n    /**\n    stop the Image Sequence. The image frame is resetted.\n    @method stop\n    */\n    stop()\n    {\n        this.currentTime    = 0;\n        this.currentFrame   = 0;\n        this.playing        = false;\n        this.laps           = 0;\n    }\n\n    /**\n    Loop the image sequence for a given number of iterations (once play() is called).\n    @method loop\n    @param {Number} count : -1 means infinity.\n    */\n    loop(count)\n    {\n        this.lapsToDo = count;\n    }\n\n\n}\n\n// module exports\nexport { ImageSequenceTexture };","import * as THREE from 'three';\nimport {getOrDefault} from \"../helpers/Misc\";\n\nclass RenderTexture\n{\n    /**\n     * RenderTexture are 3D camera rendered bitmap pictures loaded in the graphic card memory so they can be mapped on a geometry surface. Usually, texture are mapped through a Material. Keep in mind that WebGL, as an implementation of OpenGL, shares the same kind of limitations : textures sources should be power of 2 (even if here, Three.js is doing the job of resizing for you if they're not).\n     *\n     * @class RenderTexture\n     * @constructor\n     * @param {Object} params the parameters object\n     * @param {Number} params.width the width of this texture\n     * @param {Number} params.height the height of this texture\n     */\n    constructor(params)\n    {\n        this._width = getOrDefault(params, \"width\", 512);\n        this._height = getOrDefault(params, \"height\", 512);\n        this._engineTexture = new THREE.WebGLRenderTarget(this._width,\n                                                          this._height,\n                                                          {minFilter: THREE.LinearFilter,\n                                                           magFilter: THREE.NearestFilter,\n                                                           format: THREE.RGBFormat}\n                                                         );\n        this._texture = this._engineTexture.texture;\n    }   \n\n    getTexture()\n    {\n        return this._engineTexture.texture;\n    }\n}\n\n// module exports\nexport { RenderTexture };","import {getOrDefault} from '../helpers/Misc';\nimport {Device} from '../helpers/Device';\nimport {CanvasTexture} from './CanvasTexture';\nimport {debug} from '../helpers/Debug';\n\nclass VideoTexture\n{\n    /**\n     * VideoTexture Class give the possibility to use a movie file directly as a texture. Therefore, this class contains some movie media fonctions to manage time (play, pause, stop, etc). The texture must be mapped on an Mesh via a Material (setTexture()).\n     *\n     * @class VideoTexture\n     * @constructor\n     * @param {Object} params params The parameters object\n     * @param {Video} params.video the html5 video object to use for this VideoTexture\n     * @param {Number} [params.fps = 30] the fps to use for this video playback, used only with iOS devices. NB : this parameter will not change the playback speed of the video, it will only affect it's picture update frequency.\n     * @param {Boolean} [params.loop = false] whether the video should loop after playback end\n     * @param {Boolean} [params.autoPlay = false] whether the video should play at construction\n     * \n     * @example\n     *    //TODO\n     */\n    constructor(params)\n    {\n        this._video = getOrDefault(params, \"video\", undefined);\n        this._loop = getOrDefault(params, \"loop\", false);\n        this._autoPlay = getOrDefault(params, \"autoPlay\", false);\n        this._fps = getOrDefault(params, \"fps\", 30);\n\n        //special treatment for iOS as we can't access the video without an automatic fullscreen\n        this._isIOS = (Device.getOS() === \"iOS\");\n\n        this._isPlaying = false;\n        this._bufferedPourcent = {start:0,end:0};\n\n        //iOS specifics, we must create a canvas to render in or we'll go fullscreen\n        if(this._isIOS)\n        {\n            this._autoPlay = false;//no autoplay on iOS\n            this._videoCanvasTexture = new CanvasTexture({width:this._video.videoWidth,\n                                                          height:this._video.videoHeight});\n        }\n        //to have some events to work with\n        this._video.addEventListener(\"progress\", this.onLoadProgess.bind(this));\n        this._video.addEventListener(\"ended\", this.onVideoEnded.bind(this));\n\n        if(!this._isIOS)\n        {\n            this._texture = new THREE.Texture( this._video );\n            this._texture.generateMipmaps = false;\n            this._texture.minFilter = THREE.NearestFilter;\n            this._texture.magFilter = THREE.NearestFilter;\n        }\n        else\n        {\n            this._texture = this._videoCanvasTexture._texture;\n        }\n\n        if(this._autoPlay && !this._isIOS)\n        {\n            this.play();\n        };\n    }\n\n    /**\n    * Defines a \"load progress\" behavior. User can access the result of the progress through the bufferedPourcent property (videoTexture.bufferedPourcent) which is an object constructed like this : this._bufferedPourcent = {start:<Number>, end: <Number>}. FIXME : should map to the orginal list produced by HTML5 TimeRange object\n    * @private\n    * @method onVideoSrcLoaded\n    * @param {Event} e\n    */\n    onLoadProgess(e)\n    {\n        var timeRange = this.getBuffered();\n        debug.log(\"progress\",timeRange,this.getDuration());\n\n        if(timeRange)\n        {\n            if(timeRange.length >= 1)\n            {\n                this._bufferedPourcent = {start:this.getBuffered().start(0) * 100 / this.getDuration(),\n                                          end:this.getBuffered().end(0)* 100 / this.getDuration()};\n            }\n        }\n    }\n\n    /**\n    * Ended event to manage loop playback\n    * @private\n    * @method onVideoEnded\n    * @param {Event} e\n    */\n    onVideoEnded(e)\n    {\n        if(this._loop)\n        {\n            this.play();\n        }\n        else\n        {\n            this.stop();\n        }\n    }\n\n    /**\n    * Set Loop on or off for this video\n    * @method setLoop\n    * @param {Boolean} val\n    */\n    setLoop(val)\n    {\n        this._loop = val;\n    }\n\n    /**\n    * updates the video texture, should be done everytime an update is desired (i.e. every frame)\n    * @method update\n    */\n    update()\n    {\n        //if ( this._video.readyState === this._video.HAVE_ENOUGH_DATA || this._video.readyState === this._video.HAVE_METADATA )\n        if (this._video.readyState >= this._video.HAVE_FUTURE_DATA)\n        {\n            if(this._isIOS && this._isPlaying){\n\n                var time = Date.now();\n                var elapsed = (time - this.lastTime) / 1000;\n\n                if(elapsed >= (1 / this._fps) )\n                {\n\n                    this._video.currentTime = this._video.currentTime + elapsed;\n                    this.lastTime = time;\n\n                    this._videoCanvasTexture.drawImage(this._video);\n                    // Resync audio and video if they drift more than 300ms apart\n                    /* if(this.audio && Math.abs(this.audio.currentTime - this._video.currentTime) > 0.3){\n                        this.audio.currentTime = this._video.currentTime;\n                    }*/\n                }\n            }\n\n            if (!this._isIOS && this._texture)\n            {\n                this._texture.needsUpdate = true;\n            }\n        }\n    }\n\n    /**\n    * Play the video\n    * @method play\n    */\n    play()\n    {\n        if(!this._isIOS)\n        {\n            this._video.play();\n        }\n        else\n        {\n            this.lastTime = Date.now();\n        }\n        this._isPlaying = true;\n    }\n\n    /**\n    * Pause the video\n    * @method pause\n    */\n    pause()\n    {\n        this._video.pause();\n        this._isPlaying = false;\n    }\n\n    /**\n    * Stop the video\n    * @method stop\n    */\n    stop()\n    {\n        this._video.pause();\n        this._video.currentTime = 0;\n        this._isPlaying = false;\n    }\n\n    /**\n    * Get playing state\n    * @method getIsPlaying\n    * @return {Boolean} playing state\n    */\n    getIsPlaying()\n    {\n        return this._isPlaying;\n    }\n\n    /**\n    * Gets the current time of this video\n    * @method getCurrentTime\n    * @return {Number} the current time of this video in seconds\n    */\n    getCurrentTime()\n    {\n        return this._video.currentTime;\n    }\n    /**\n    * Gets the current buffered part of this video\n    * @method getBuffered\n    * @return {Object} the current buffered part as a TimeRange Object {length:Number, start:Number, end:Number}\n    */\n    getBuffered()\n    {\n        return this._video.buffered;\n    }\n\n    /**\n    * Set the current time of this video\n    * @method setCurrentTime\n    * @param {Number} t the current time (in second) to\n    */\n    setCurrentTime(t)\n    {\n        if(this._video.currentTime < this._video.duration){\n            this._video.currentTime = t;\n        }else{\n            this._video.currentTime = this._video.duration;\n        }\n    }\n\n    /**\n    * Get the duration of the video file in seconds\n    * @method getDuration\n    * @return {Number} duration\n    */\n    getDuration()\n    {\n        return this._video.duration;\n    }\n\n    /**\n    * Set the playback rate of the video. See https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/playbackRate for more details\n    * @method setPlaybackRate\n    * @param {Number} r the playback rate\n    */\n    setPlaybackRate(r)\n    {\n        this._video.playbackRate = r;\n    }\n\n    /**\n    * Get the current playback rate\n    * @method getPlaybackRate\n    * @return {Number} the playback rate\n    */\n    getPlaybackRate()\n    {\n        return this._video.playbackRate;\n    }\n\n    /**\n    * Get the current video width\n    * @method getWidth\n    * @return {Number} the video width\n    */\n    getWidth()\n    {\n        return this._video.videoWidth;\n    }\n\n    /**\n    * Get the current video height\n    * @method getHeight\n    * @return {Number} the video height\n    */\n    getHeight()\n    {\n        return this._video.videoHeight;\n    }\n}\n\n// module exports\nexport { VideoTexture };","import {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\n\nclass Timer extends Component\n{\n    /**\n    *A timer is a time manager that gives the possibily to schedule a function every <i>n</i> ms.\n    *\n    *@class Timer\n    *@constructor\n    *@param {Object} params Config parameters\n    *@param {Number} params.interval the number of millisecond to wait before the next timer's fire\n    *@param {Function} params.callback the function to fires every time the timer's interval is passed. Can be an anonymous fonction or not.\n    *@example\n    *    var myTimer = new Timer({interval: 200, callback: function(){\n    *                    //your code here\n    *                } });\n    *    myTimer.start();\n    */\n    constructor(params)\n    {\n        super(params);\n\n        debug.log(\"constructor post super\");\n        \n        this.interval = getOrDefault(params, \"interval\", 100);//milliseconds\n        this.callback = getOrDefault(params, \"callback\", null);//this is a function\n    }\n\n    /**\n    * Setup the timer with the current time\n    * \n    * @method setup\n    */\n    setup(){\n        this.startTime = new Date().getTime();\n        this.currentTime = new Date().getTime();\n    }\n\n    /**\n    * Activate the component\n    *\n    * @method on\n    */\n    /*on(){\n        super.on();\n        \n    }*/\n\n    /**\n    * Deactivate the component\n    *\n    * @method off\n    */\n    off(){\n        super.off();\n\n        this.stop();\n    }\n    \n    /**\n    * Starts the timer\n    * \n    * @method start\n    */\n    start(){\n        if(this._active){\n            this.startTime = new Date().getTime();\n            this.currentTime = new Date().getTime();\n        }else{\n            debug.info(\"component is off\");\n        }\n    }\n    \n    /**\n    * Starts the timer\n    * \n    * @method stop\n    */\n    stop(){\n        this.startTime = 0;\n        this.currentTime = 0;\n    }\n    /**\n    * Updates the timer's state\n    * \n    * @method update\n    */\n    update(){\n\n        if(this._active){\n\n            this.currentTime = new Date().getTime();\n            var tempInterval = this.currentTime - this.startTime;\n\n            if(tempInterval >= this.interval){\n                this.callback();\n                this.reset();\n            }\n        }\n        \n    }\n\n    /**\n    * Resets the timer\n    * @method reset\n    */\n    reset(){\n        this.startTime = new Date().getTime();\n        this.currentTime = new Date().getTime();\n    }\n}\n\n/*window.requestAnimationFrame = window.requestAnimationFrame\n                            || window.mozRequestAnimationFrame\n                            || window.webkRequestAnimationFrame\n                            || window.msRequestAnimationFrame;*/\n\n\n// module exports\nexport { Timer };","import {_Math} from '../helpers/Math';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {getOrDefault} from '../helpers/Misc';\n\nclass NTP extends Component\n{\n    /*\n    * The NTP class provides methods to control time synchronization related operations.\n    * \n    * @example\n    *    //TODO\n    *\n    * @class NTP\n    * @constructor\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this._startTime = getOrDefault(params, \"startTime\",0);\n        this._timeScale = getOrDefault(params, \"scale\",1);\n        this._smoothingFactor = getOrDefault(params, \"smoothingFactor\", 0.9);\n        this._NTPEnabled = getOrDefault(params, \"NtpEnabled\", false);\n\n        this._currentTime = 0;\n        this._deltaTime = 0;\n        this._timeOffsetSmooth = 0;\n        this._lastTime = new Date().getTime();\n\n        this._offset = 0;\n    }\n\n    /**\n    * Setup for this time instance\n    * \n    * @method setup\n    */\n    setup()\n    {\n        this._lastTime = new Date().getTime();\n\n        this._offset = this._lastTime - this._startTime;\n\n        if (this._NTPEnabled)\n        {\n            var socket = new WebSocket('ws://ntp.surexposition.mobi:8000/');\n            ntp_websockets.init(socket);//how to import this vendor ?\n            //debug.log(\"WebSocket init\");\n            setInterval(function(){\n                this._offset = ntp_websockets.offset();\n            }, 1000);\n        }\n    }\n\n\n    start()\n    {\n        this._startTime = new Date().getTime();\n    }\n\n    pause()\n    {\n\n    }\n\n    reset()\n    {\n        this._startTime = 0;\n    }\n\n\n    /**\n    * updates this time instance\n    * \n    * @method update\n    */\n    update()\n    {\n        if(this.getStatus())//the component must be on, else we \"stop\" the time\n        {\n            let currentTime = new Date().getTime();\n            this._deltaTime = (currentTime - this._currentTime)/1000;\n            this._currentTime = currentTime;\n        }\n    }\n\n    /**\n    * Set the current timeScale, useful to slower time down\n    * \n    * @method setTimeScale\n    * @param {Number} scale\n    */\n    setTimeScale(scale)\n    {\n        this._timeScale = scale;\n    }\n\n    /**\n    * Get the current timeScale\n    * \n    * @method getTimeScale\n    * @return {Number} scale\n    */\n    getTimeScale()\n    {\n        return this._timeScale;\n    }\n\n    /**\n    * Get the current timeDelta (difference of time between 2 frames) at the current timeScale\n    * \n    * @method getDelta\n    * @return {Number} the current timeDelta at the current timeScale\n    */\n    getDelta()\n    {\n        return this._deltaTime * this._timeScale;\n    }\n\n    /**\n    * Gets the current Time object's time\n    * \n    * @method getTime\n    * @return {Number} the current time\n    */\n    getTime()\n    {\n        return (this._currentTime + this._offset) * this._timeScale;\n    }\n\n    /**\n    * Gets a smoothed time, useful to avoid hard transitions when time passed faster than the computing time.\n    * \n    * @method getTimeSmooth\n    * @return {Number} the current time smoothed with an offset\n    */\n    getTimeSmooth()\n    {\n        this._timeOffsetSmooth = this._timeOffsetSmooth * this._startTime + this._offset * (1-this._startTime);\n        return (this._currentTime + this._timeOffsetSmooth) * this._timeScale;\n    }\n\n    /**\n    * Gets the current Time object underlying Date Object time\n    * \n    * @method getDateTime\n    * @return {Number} the current Date Object raw getTime() result\n    */\n    getDateTime()\n    {\n        return new Date().getTime();\n    }\n\n    /**\n    * Resync the current Time object with the given ntp server\n    * \n    * @method resync\n    */\n    resync()\n    {\n        if (this._NTPEnabled)\n        {\n            ntp_websockets.resync();\n        }\n    }\n}\n\n// module exports\nexport { NTP };\n","import {Component} from '../Component';\nimport {getOrDefault, getOrExec} from '../helpers/Misc';\nimport {Pointer} from \"../helpers/Pointer\";\nimport {Mouse} from \"../input/Mouse\";\n\nconst EVT_PRESS = 'press';\nconst EVT_RELEASE = 'release';\n\nclass Clickable extends Component\n{\n    /**\n    * Makes a Mesh clickable\n    *\n    * @class Clickable\n    * @constructor\n    * @param {Object} params parameters object\n    * @param {Pointer} params.pointer\n    * @param {Camera} params.camera\n    * @param {onPress} params.onPress\n    * @param {onRelease} params.onRelease\n    * @param {onEnter} params.onEnter\n    * @param {onLeave} params.onLeave\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this.pointer = getOrDefault(params, \"pointer\", undefined);\n        this.onPress = getOrDefault(params, \"onPress\", function(){});\n        this.onRelease = getOrDefault(params, \"onRelease\", function(){});\n        this.onEnter = getOrDefault(params, \"onEnter\", function(){});\n        this.onLeave = getOrDefault(params, \"onLeave\", function(){});\n\n        this.camera = params.camera;\n        this.target = getOrDefault(params, \"target\", undefined);\n\n        this.picked = false;\n        this.hovered = false;\n    }\n\n    /**\n    * Setup for this clickable instance\n    * \n    * @method setup\n    */\n    setup()\n    {\n        super.setup();\n\n        let context = this.getContext();\n\n        if(!this.pointer)\n        {\n            let mouse = new Mouse();\n            context.addComponent(mouse);\n            mouse.setup();\n            mouse.on();\n\n            this.pointer = new Pointer();\n            this.pointer.add(mouse);\n            context.addComponent(this.pointer);\n            this.pointer.setup();\n            this.pointer.on();\n            //console.log(mouse,context);\n        }\n\n        this.pointer.events.on(\"on\", event => {\n\n            let pick = this.target.transform.pick(this.camera, event.x, event.y);\n\n            if(pick)\n            {\n                this.picked = true;\n                this.onPress();\n            }\n            else\n            {\n                this.picked = false;\n            }\n        });\n\n        this.pointer.events.on(\"off\", event => {\n\n            let pick = this.target.transform.pick(this.camera, event.x, event.y);\n\n            if(this.picked === true)\n            {\n                this.onRelease();\n            }\n\n        });\n\n        this.pointer.events.on(\"moved\",event => {\n\n            let pick = this.target.transform.pick(this.camera, event.x, event.y);\n\n            if(pick)\n            {\n                this.picked = true;\n                if(!this.hovered)\n                {\n                    this.onEnter();\n                    this.hovered = true;\n                }\n            }\n            else\n            {\n                if(this.picked) //avoid useless recall\n                {\n                    this.onLeave();\n                    this.hovered = false;\n                    this.picked = false;\n                }\n            }\n        });\n    }\n\n}\n\n// module exports\nexport { Clickable };\n","import {getOrDefault} from '../helpers/Misc';\nimport {Mesh} from '../shape/Mesh';\nimport {Color} from '../core/Color';\nimport {EventEmitter} from '../helpers/EventEmitter';\nimport {Vector3} from '../core/Vector3';\nimport {Vector2} from '../core/Vector2';\nimport {Matrix4} from '../core/Matrix4';\nimport {debug} from '../helpers/Debug';\nimport {Pointer} from '../helpers/Pointer';\nimport {Component} from '../Component';\nimport {Clickable} from './Clickable';\nimport {_Math} from '../helpers/Math';\nimport {RichText} from \"../text/RichText\";\nimport {Texture} from \"../texture/Texture\";\n\nclass Button extends Component\n{\n    /**\n     * A Button is a special kind of 3D object that is clickable and that you can use to build Graphical User Interfaces (GUI).\n     *\n     * @class Button\n     * @constructor\n     * @param {Object} params parameters object.\n     * @param {Camera} params.camera the camera used for picking.\n     * @param {String} params.text text to render (can be empty).\n     * @param {Object} params.font font to use.\n     * @param {Number} params.width width in pixels.\n     * @param {Number} params.height height in pixels.\n     * @param {Number} params.cutOff the size of the cutOff\n     * @param {Color} params.strokeColor\n     * @param {Color} params.fillColor\n     * @param {Color} params.pressFillColor\n     * @param {Color} params.hoverFillColor\n     * @param {Function} [params.onPress]\n     * @param {Function} [params.onRelease]\n     * @param {Function} [params.onEnter]\n     * @param {Function} [params.onLeave]\n     * @param {URL} [params.fontURL] url for the regular font file\n     * @param {URL} [params.fontItalicURL] url for the italic font file\n     * @param {URL} [params.fontBoldURL] url for the bold font file\n     * @param {URL} [params.fontBoldItalicURL] url for the bold-italic font file\n     * @example\n     *     //TODO\n     */\n    constructor(params)\n    {\n        super(params);\n\n        this.camera = params.camera;// requiered\n        this.pointer = getOrDefault(params, \"pointer\", undefined);\n        this.mesh = getOrDefault(params, \"mesh\", undefined);\n        this.width = getOrDefault(params, \"width\", 3);\n        this.height = getOrDefault(params, \"height\", 1);\n        this.radius = getOrDefault(params, \"radius\", undefined);\n        this.sideCount = getOrDefault(params, \"sideCount\", 6);\n\n        this.cutOff = getOrDefault(params, \"cutOff\", this.height / 3);\n        this.strokeWidth = getOrDefault(params, \"strokeWidth\", 0.1);\n\n        this.strokeColor = getOrDefault(params, \"strokeColor\", Color.mobilizing.clone());\n        this.fillColor = getOrDefault(params, \"fillColor\", Color.white.clone());\n        this.pressFillColor = getOrDefault(params, \"pressFillColor\", Color.mobilizing.clone());\n        this.hoverFillColor = getOrDefault(params, \"hoverFillColor\", Color.mobilizingAlternate.clone());\n\n        this.onPress = getOrDefault(params, \"onPress\", function(){});\n        this.onRelease = getOrDefault(params, \"onRelease\", function(){});\n        this.onEnter = getOrDefault(params, \"onEnter\", function(){});\n        this.onLeave = getOrDefault(params, \"onLeave\", function(){});\n\n        this._fontURL = getOrDefault(params, \"fontURL\", \"fonts/Raleway-Regular.ttf\");\n        this._fontItalicURL = getOrDefault(params, \"fontItalicURL\", \"fonts/Raleway-Regular-Italic.ttf\");\n        this._fontBoldURL = getOrDefault(params, \"fontBoldURL\", \"fonts/Raleway-Bold.ttf\");\n        this._fontBoldItalicURL = getOrDefault(params, \"fontBoldItalicURL\", \"fonts/Raleway-Bold-Italic.ttf\");\n\n        this.text = getOrDefault(params, \"text\", undefined);\n        this.textSize = getOrDefault(params, \"textSize\", 40);\n        //main node\n        this.root = new Mesh({primitive: \"node\"});\n\n        this.transform = this.root.transform;\n\n        //create the texture from text\n        if(this.text)\n        {\n            //FIXME -> quand on a un radius pour le poly faire une texture carré\n            let canvasWidth;\n            if(this.width < 100)\n            {\n                canvasWidth = 512;\n            }\n            else\n            {\n                canvasWidth = this.width;\n            }\n\n            let canvasHeight;\n            if(this.height < 100)\n            {\n                canvasHeight = canvasWidth / (this.width / this.height);\n            }\n            else\n            {\n                canvasHeight = this.height;\n            }\n\n            if(this.radius)\n            {\n                let twoSquareThree = 2 / Math.sqrt(3);\n                canvasHeight = canvasWidth * twoSquareThree;\n            }\n\n            //label normal state\n            let richText = new Mobilizing.RichText({width: canvasWidth,\n                                                    height: canvasHeight,\n                                                    text: this.text,\n                                                    marginTop:canvasHeight/2 - this.textSize/2,\n                                                    backgroundColor: Color.transparent.makeRGBAStringWithAlpha(0),\n                                                    textColor: Color.mobilizing.clone(),\n                                                    textAlign: \"center\",\n                                                    textSize: this.textSize,\n                                                    fontURL: this._fontURL,\n                                                    fontItalicURL: this._fontItalicURL,\n                                                    fontBoldURL: this._fontBoldURL,\n                                                    fontBoldItalicURL: this._fontBoldItalicURL});\n\n            //label pressed state\n            let pressRichText = new Mobilizing.RichText({width: canvasWidth,\n                                                         height: canvasHeight,\n                                                         text: this.text,\n                                                         marginTop:canvasHeight/2 - this.textSize/2,\n                                                         backgroundColor: Color.transparent.makeRGBAStringWithAlpha(0),\n                                                         textColor: Color.white.clone(),\n                                                         textAlign: \"center\",\n                                                         textSize: this.textSize,\n                                                         fontURL: this._fontURL,\n                                                         fontItalicURL: this._fontItalicURL,\n                                                         fontBoldURL: this._fontBoldURL,\n                                                         fontBoldItalicURL: this._fontBoldItalicURL});\n\n            this.textTexture = new Texture({canvas: richText.getCanvas()});\n            this.pressTextTexture = new Texture({canvas: pressRichText.getCanvas()});\n            /*document.body.appendChild(richText.getCanvas());\n            richText.getCanvas().style.position = \"absolute\";\n            richText.getCanvas().style.top = \"0px\";\n            richText.getCanvas().style.left = \"0px\";*/\n        }\n        //construct the default mesh & stroke\n        if(!this.mesh)\n        {\n            this.generateDefaultMesh();\n        }\n\n        this.root.transform.addChild(this.mesh.transform);\n    }\n\n    setup()\n    {\n        super.setup();\n        let context = this.getContext();\n\n        this.clickable = new Clickable({camera: this.camera,\n                                        target: this.mesh,\n                                        pointer: this.pointer,\n                                        onPress: () =>\n                                        {\n                                            if(this._active)\n                                            {\n                                                this.mesh.material.setColor(this.pressFillColor);\n                                                if(this.pressTextTexture)\n                                                {\n                                                    this.texturedMesh.material.setTexture(this.pressTextTexture);\n                                                }\n                                                this.onPress();\n                                            }\n                                        },\n\n                                        onRelease: () =>\n                                        {\n                                            if(this._active)\n                                            {\n                                                this.mesh.material.setColor(this.hoverFillColor);\n                                                if(this.textTexture)\n                                                {\n                                                    this.texturedMesh.material.setTexture(this.textTexture);\n                                                }\n                                                this.onRelease();\n                                            }\n                                        },\n\n                                        onEnter: () =>\n                                        {\n                                            if(this._active)\n                                            {\n                                                this.mesh.material.setColor(this.hoverFillColor);\n                                                this.onEnter();\n                                            }\n                                        },\n\n                                        onLeave: () =>\n                                        {\n                                            if(this._active)\n                                            {\n                                                this.mesh.material.setColor(this.fillColor);\n                                                if(this.textTexture)\n                                                {\n                                                    this.texturedMesh.material.setTexture(this.textTexture);\n                                                }\n                                                this.onLeave();\n                                            }\n                                        }\n                                       });\n        context.addComponent(this.clickable);\n        this.clickable.setup();\n        this.on();\n    }\n\n    /**\n    * Activate the button\n    * @method on\n    */\n    on()\n    {\n        super.on();\n        this.mesh.material.setOpacity(1);\n        this.strokeMesh.material.setOpacity(1);\n        if(this.text)\n        {\n            this.texturedMesh.material.setOpacity(1);\n        }\n    }\n    /**\n    * deactivate the button, set its opacity to 30 %\n    * @method off\n    */\n    off()\n    {\n        super.off();\n        this.mesh.material.setOpacity(.3);\n        this.strokeMesh.material.setOpacity(.3);\n        if(this.text)\n        {\n            this.texturedMesh.material.setOpacity(.3);\n        }\n    }\n\n    /**\n    * Generate the vertices and meshes for the default button. Called internally only\n    * @private\n    * @method generateDefaultMesh\n    */\n    generateDefaultMesh()\n    {\n        //vertices\n        let w = this.width/2;\n        let h = this.height/2;\n        //this.cutOff = h/2;\n        //let cutOffXOffset = 0;\n\n        this.vertex = [];\n\n        //manage special case of squared size : will be an hexagon!\n        if(this.radius)\n        {\n\n            let parts = this.sideCount;\n            let radius = this.radius;\n\n            for(let i=0; i<parts; i++){\n                //arc(a, b, c, d, start, stop, mode)\n                this.vertex.push(\n                    new Vector2( Math.cos(_Math.degToRad(360/parts/2) + (Math.PI*2/parts) * i) * radius,\n                                Math.sin(_Math.degToRad(360/parts/2) + (Math.PI*2/parts) * i) * radius)\n                )\n            }\n        }\n        else\n        {\n            this.vertex.push(new Vector2(-w + this.cutOff, h));\n            this.vertex.push(new Vector2( w - this.cutOff, h));\n            this.vertex.push(new Vector2( w, h - this.cutOff));\n            this.vertex.push(new Vector2( w, -h + this.cutOff));\n            this.vertex.push(new Vector2( w - this.cutOff, -h));\n            this.vertex.push(new Vector2(-w + this.cutOff, -h));\n            this.vertex.push(new Vector2(-w, -h + this.cutOff));\n            this.vertex.push(new Vector2(-w, h - this.cutOff));\n        }\n\n        //console.log(this.vertex);\n\n        this.topLeftIndex = 0;\n        this.topRightIndex = 1;\n        this.bottomRightIndex = 4;\n        this.bottomLeftIndex = 5;\n\n        this.mesh = new Mesh({primitive: \"custom\"});\n        this.mesh.generateFillMesh(this.vertex);\n        this.mesh.material.setTransparent(true);\n\n        if(this.text)\n        {\n            this.texturedMesh = new Mesh({primitive: \"custom\"});\n            this.texturedMesh.generateFillMesh(this.vertex);\n            this.texturedMesh.material.setTransparent(true);\n            this.texturedMesh.material.setTexture(this.textTexture);\n            this.root.transform.addChild(this.texturedMesh.transform);\n        }\n\n        this.strokeMesh = Mesh.generateStrokeMesh(this.mesh, this.strokeWidth);\n        this.strokeMesh.material.setColor(this.strokeColor);\n        this.strokeMesh.material.setTransparent(true);\n\n        this.root.transform.addChild(this.strokeMesh.transform);\n    }\n\n    /**\n    * Adapt a corner of the shape, for grouping buttons together\n    * @method adaptCorner\n    * @param {String} mode cutOff, straight\n    * @param {String} corner topLeft, topRight, bottomRight,bottomLeft\n    */\n    adaptCorner(mode, corner)\n    {\n        if(this.width !== this.height)\n        {\n            switch(corner)\n            {\n                case \"topLeft\" :\n\n                    var vertex = this.mesh._geometry.vertices[this.topLeftIndex];\n                    if(mode === \"straight\")\n                    {\n                        vertex.x = -this.width/2;\n                    }\n                    else if(mode === \"cutOff\")\n                    {\n                        vertex.x = -this.width/2 + this.cutOff;\n                    }\n                    this.mesh.updateMesh();\n                    this.regenerateStrokeGeometry(this.mesh);\n\n                    break;\n\n                case \"topRight\" :\n\n                    var vertex = this.mesh._geometry.vertices[this.topRightIndex];\n                    if(mode === \"straight\")\n                    {\n                        vertex.x = this.width/2;\n                    }\n                    else if(mode === \"cutOff\")\n                    {\n                        vertex.x = this.width/2 - this.cutOff;\n                    }\n                    this.mesh.updateMesh();\n                    this.regenerateStrokeGeometry(this.mesh);\n\n                    break;\n\n                case \"bottomRight\" :\n\n                    var vertex = this.mesh._geometry.vertices[this.bottomRightIndex];\n                    if(mode === \"straight\")\n                    {\n                        vertex.x = this.width/2;\n                    }\n                    else if(mode === \"cutOff\")\n                    {\n                        vertex.x = this.width/2 - this.cutOff;\n                    }\n                    this.mesh.updateMesh();\n                    this.regenerateStrokeGeometry(this.mesh);\n\n                    break;\n\n                case \"bottomLeft\" :\n\n                    var vertex = this.mesh._geometry.vertices[this.bottomLeftIndex];\n                    if(mode === \"straight\")\n                    {\n                        vertex.x = -this.width/2;\n                    }\n                    else if(mode === \"cutOff\")\n                    {\n                        vertex.x = -this.width/2 + this.cutOff;\n                    }\n                    this.mesh.updateMesh();\n                    this.regenerateStrokeGeometry(this.mesh);\n\n                    break;\n            }\n            this.mesh.generateFlatUVs();\n        }\n    }\n\n    /**\n    * regenerate the geometry of the mesh for further update\n    * @method regenerateStrokeGeometry\n    * @private\n    * @param {Mesh} the mesh to regenerate the stroke for \n    */\n    regenerateStrokeGeometry(mesh)\n    {\n        this.strokeMesh.updateStroke(mesh, this.strokeWidth);\n    }\n\n    /**\n    * Can be used to simulate a pressed event when necessary (i.e. when a keyboard event should modify the button state).\n    *\n    * @method fakePress\n    */\n    fakePress()\n    {\n        this.fakePressed = true;\n    }\n\n    /*update()\n    {\n\n    }*/\n\n}\n\n// module exports\nexport { Button };","import {getOrDefault} from '../helpers/Misc';\nimport {Mesh} from '../shape/Mesh';\nimport {Color} from '../core/Color';\nimport {EventEmitter} from '../helpers/EventEmitter';\nimport {Vector3} from '../core/Vector3';\nimport {debug} from '../helpers/Debug';\nimport {Component} from '../Component';\nimport {_Math} from '../helpers/Math';\nimport {Button} from './Button';\n\nclass ButtonGroup extends Component\n{\n    /**\n     * ButtonGroup organize an array of Buttons with different layout patterns. Make it easier to build menu.\n     *\n     * @class ButtonGroup\n     * @constructor\n     * @param {Object} params Parameters object.\n     * @param {Number} params.row for grid based layout, the maximum nb of rows\n     * @param {Number} params.columns for grid based layout, the maximum nb of columns\n     * @param {String} params.mode layout mode. One of grid, honeycomb\n     * @param {Array} params.buttons The list of buttons to layout.\n     * \n     * @example\n     *     //TODO\n     */\n    constructor(params)\n    {\n        /*\n         * index d'élement => position\n         * plusieurs implémentations de positionement\n         * - grille simple à plusieurs sens\n         * - fleur / spirale\n         * - clavier\n         * - custom\n         */\n        super(params);\n\n        let rows = getOrDefault(params, \"rows\", 3);\n        let columns = getOrDefault(params, \"columns\", 2);\n        let mode = getOrDefault(params, \"mode\", \"grid\");\n        let offsetType = getOrDefault(params, \"offsetType\", \"even\");\n\n        this.buttons = getOrDefault(params, \"buttons\", []);\n        this.orderedIndices = [];\n\n        this.width = 0;\n        this.height = 0;\n\n        this.root = new Mesh({'primitive': \"node\"});\n        this.transform = this.root.transform;\n\n        if(this.buttons.length > 0)\n        {\n            //add objects to this group root\n            for(let i=0; i < this.buttons.length; i++)\n            {\n                this.root.transform.addChild(this.buttons[i].transform);\n            }\n\n            this.organize(mode, columns, offsetType);\n        }\n    }\n\n    /*setup()\n    {\n        super.setup();\n        let context = this.getContext();\n    }*/\n\n    /*add(button)\n    {\n        this.buttons.push(button);\n        button.setName(this.buttons.length-1);\n    }*/\n\n    /**\n    * Generic organize method to switch between various layout modes\n    * @private\n    * @method organize\n    * @param {String} mode grid, HoneyComb (for HoneyComb layout)\n    */\n    organize(mode, columns, offsetType)\n    {\n        /*let mode = getOrDefault(params, \"mode\", \"grid\");\n        let rows = getOrDefault(params, \"rows\", 2);\n        let columns = getOrDefault(params, \"columns\", 3);*/\n\n        console.log(mode, columns, offsetType);\n\n        switch(mode)\n        {\n            case \"grid\":\n                let indices = this.organizeGrid(columns);\n                this.positionGrid(indices);\n                break;\n        }\n        switch(mode)\n        {\n            case \"honeycomb\": // bee honeycomb!\n                let indices = this.organizeGrid(columns);\n                this.positionHoneyComb(indices, offsetType);\n                break;\n        }\n    }\n\n    /**\n    * Organize the buttons to place in the grid. Each button is associated to an index.\n    * @private\n    * @method organizeGrid\n    * @param {Number} columns \n    * @return {Array} indices List of objects like this: {index:i,position: new Vector3(), isTop: false, isBottom: false, isLeft: false, isRight: false}, that will help to compute positions and Mesh deformations\n    */\n    organizeGrid(columns)\n    {\n        let tempIndices = [];\n\n        for(let i=0; i < this.buttons.length; i++)\n        {\n            if(i === 0 || i % columns === 0)\n            {\n                tempIndices[tempIndices.length] = [];\n            }\n            tempIndices[tempIndices.length-1].push({index:i,\n                                                    position: new Vector3(),\n                                                    isTop: false,\n                                                    isBottom: false,\n                                                    isLeft: false,\n                                                    isRight: false});\n        }\n        return tempIndices;\n    }\n    /**\n    * Compute position and set position flags for each button\n    * @private\n    * @method positionGrid\n    * @param {Array} indices given from organizeGrid\n    */\n    positionGrid(indices)\n    {\n        let index = 0;\n\n        for(let i=0; i < indices.length; i++) //line nb\n        {\n            let line = indices[i];\n\n            for(let j=0; j < line.length; j++) // column nb\n            {\n                let bt = this.buttons[line[j].index];\n                line[j].position.x = j * (bt.width + bt.strokeWidth);\n                line[j].position.y = i * -(bt.height + bt.strokeWidth);\n\n                //manage placement by strings\n                if(i === 0)\n                {\n                    line[j].isTop = true;\n                }\n                if(i === indices.length-1)\n                {\n                    line[j].isBottom = true;\n                }\n                if(j === 0)\n                {\n                    line[j].isLeft = true;\n                }\n                if(j === line.length-1)\n                {\n                    line[j].isRight = true;\n\n                    //for corner with no vertical neighbor but a line under\n                    if(index + line.length > this.buttons.length-1)\n                    {\n                        line[j].isBottom = true;\n                    }\n                }\n                this.orderedIndices.push(line[j]);\n                index++;\n            }\n        }\n\n        //console.log(this.orderedIndices);\n        this.renderGrid();\n    }\n\n    renderGrid()\n    {\n        for(let i=0; i < this.orderedIndices.length; i++)\n        {\n            let order = this.orderedIndices[i];\n            let bt = this.buttons[i];\n\n            bt.transform.setLocalPosition( order.position );\n\n            //one line only\n            if(order.isTop && order.isLeft && order.isBottom && !order.isRight){\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n            }\n            if(order.isTop && !order.isLeft && order.isBottom && !order.isRight){\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n            if(order.isTop && !order.isLeft && order.isBottom && order.isRight){\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n            //several lines\n            //middle\n            if(order.isTop && !order.isLeft && !order.isBottom && !order.isRight){\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n            //top\n            if(order.isTop && order.isLeft && !order.isBottom && !order.isRight){\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n\n            if(order.isTop && !order.isLeft && !order.isBottom && order.isRight){\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n            }\n            //other middle\n            if(!order.isTop && !order.isBottom){\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n            //bottom\n            if(!order.isTop && order.isLeft && order.isBottom && order.isRight){\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"topRight\");\n            }\n            if(!order.isTop && order.isLeft && order.isBottom && !order.isRight){\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n            }\n            if(!order.isTop && !order.isLeft && order.isBottom && order.isRight){\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n            if(!order.isTop && !order.isLeft && order.isBottom && !order.isRight){\n                bt.adaptCorner(\"straight\", \"topRight\");\n                bt.adaptCorner(\"straight\", \"bottomRight\");\n                bt.adaptCorner(\"straight\", \"topLeft\");\n                bt.adaptCorner(\"straight\", \"bottomLeft\");\n            }\n        }\n        this.computeSize();\n    }\n\n    positionHoneyComb(indices, offsetType)\n    {\n        let index = 0;\n\n        for(let i=0; i < indices.length; i++) //line nb\n        {\n            let line = indices[i];\n\n            for(let j=0; j < line.length; j++) // column nb\n            {\n                let bt = this.buttons[line[j].index];\n\n                /*let halfWidthSquared = Math.pow(bt.mesh.getBoundingBox().getSize().x / 2, 2);\n                let twoSquareThree = 2 / Math.sqrt(3);\n                let polyHeight = bt.mesh.getBoundingBox().getSize().x * twoSquareThree;\n                let interval = Math.sqrt( Math.pow( polyHeight * Math.sin(Math.PI/6), 2) - halfWidthSquared) + polyHeight * Math.sin(Math.PI/6);*/\n\n                let interval = bt.mesh.getBoundingBox().getSize().y * 3/4;\n\n                line[j].position.x = j * (bt.mesh.getBoundingBox().getSize().x + bt.strokeWidth);\n                line[j].position.y = i * -(interval + bt.strokeWidth);\n\n                if(i % 2 === 1)\n                {\n                    if(offsetType === \"odd\")\n                    {\n                        line[j].position.x -= (bt.mesh.getBoundingBox().getSize().x + bt.strokeWidth)/2;\n                    }\n                    else\n                    {\n                        line[j].position.x += (bt.mesh.getBoundingBox().getSize().x + bt.strokeWidth)/2;   \n                    }\n                }\n                this.orderedIndices.push(line[j]);\n                index++;\n            }\n        }\n        this.renderHoneyComb();\n    }\n\n    renderHoneyComb()\n    {\n        for(let i=0; i < this.orderedIndices.length; i++)\n        {\n            let order = this.orderedIndices[i];\n            let bt = this.buttons[i];\n\n            bt.transform.setLocalPosition( order.position );\n        }\n        this.computeSize();\n    }\n    \n    computeSize()\n    {\n        let bbox = this.buttons[0].mesh.getBoundingBox();\n        bbox.expandByObject(this.root.transform.entity);\n        console.log(bbox);\n        this.width = bbox.getSize().x;\n        this.height = bbox.getSize().y;\n        console.log(this.width, this.height);\n    }\n\n    //TODO : flower menu with cube coordinates (http://www.redblobgames.com/grids/hexagons)\n\n}\n\n// module exports\nexport { ButtonGroup };","import {Base} from '../Base';\nimport {getOrDefault} from '../helpers/Misc';\nimport {debug} from '../helpers/Debug';\nimport {_Math} from '../helpers/Math';\nimport {Loader} from '../helpers/Loader';\nimport {Font} from '../scene/Font';\nimport {Color} from '../core/Color';\nimport {EventEmitter} from '../helpers/EventEmitter';\nimport {StyledTextElement, StyledLetter, TextLine} from '../text/TextUtils';\n\n/**\n* Triggered when the canvas has been redrawn, useful to synchronise Texture update and canvas refresh\n* @event drawn\n*/\nconst EVT_DRAWN = \"drawn\";\n\nclass TextField extends Base\n{\n    /**\n    * TextField.\n    *\n    * @class TextField\n    * @constructor\n    * @param {Object} params Config parameters\n    * @param {String} params.text the String to display\n    * @param {Font} params.font font Mobilizing.Font object\n    * @param {Number} [params.fontSize = 20] fontSize font size\n    * @param {Number} [params.lineMaxCharCount = 40] lineMaxCharCount the maximum number of characters a line should count\n    * @param {Color} [params.color = Color.white] color the text color\n    * @param {Color} params.backgroundColor backgroundColor backgroundColor of the text\n    * @param {Number} [params.width = 300] width of the label\n    * @param {Number} [params.height = 100] height of the label\n    * \n    * @example\n    *    //TODO\n    */\n    constructor(params)\n    {\n        super(params);\n\n        this.setName( getOrDefault(params, \"name\", undefined) );\n        this._ready = false;\n\n        this._styledLetters = [];\n        this._maxCharCount = getOrDefault(params, \"maxCharCount\", 1000);\n        this._maxLineCount = getOrDefault(params, \"maxLineCount\", 1);\n        this._size = getOrDefault(params, \"size\", 20);\n        this._color = getOrDefault(params, \"color\", Color.gray);\n        this._backgroundColor = getOrDefault(params, \"backgroundColor\", Color.white);\n        this._lineHeight = getOrDefault(params, \"lineHeight\", 1);\n\n        this._margins = getOrDefault(params, \"margins\", 10);\n\n        this._width = getOrDefault(params, \"width\", 300);\n        this._height = getOrDefault(params, \"height\", 100);// to compute from font ?\n\n        //this.mesh = new Mesh({primitive: \"plane\", width: 1, height:1, material:this.material});\n        this._fontURL = getOrDefault(params, \"fontURL\", \"fonts/Raleway-Regular.ttf\");\n        this._fontItalicURL = getOrDefault(params, \"fontItalicURL\", \"fonts/Raleway-Regular-Italic.ttf\");\n        this._fontBoldURL = getOrDefault(params, \"fontBoldURL\", \"fonts/Raleway-Bold.ttf\");\n        this._fontBoldItalicURL = getOrDefault(params, \"fontBoldItalicURL\", \"fonts/Raleway-Bold-Italic.ttf\");\n\n        this._font = getOrDefault(params, \"font\", undefined);\n        //to easily switch fonts in rendering process\n        this._currentFont = this._font;\n\n        this._cursorColor = getOrDefault(params, \"cursorColor\", this._color);\n        this._cursorWidth = getOrDefault(params, \"cursorWidth\", 2);\n        this._blinkTime = getOrDefault(params, \"blinkTime\", 300);\n        this._blinkState = false;\n        setInterval( this.onBlink.bind(this), this._blinkTime);\n\n        this._cursorIndex = -1;//to get the position of the cursor from the letters!\n        this._cursorX = 0;\n        this._cursorY = 0;\n\n        this._canvas = document.createElement(\"canvas\");\n        this._canvas.width = this._width;\n        this._canvas.height = this._height;\n        this._canvasContext = this._canvas.getContext(\"2d\");\n\n        this._canvas.events = new EventEmitter({scope:this._canvas});\n\n        //        document.body.appendChild(this._canvas);\n        //        this._canvas.style.position = \"absolute\";\n\n        //loading font chain\n        Loader.loadArrayBuffer(this._fontURL, (data) => {\n            this._defaultFontFile = data;\n\n            Loader.loadArrayBuffer(this._fontItalicURL, (data) => {\n                this._defaultItalicFontFile = data;\n\n                Loader.loadArrayBuffer(this._fontBoldURL, (data) => {\n                    this._defaultBoldFontFile = data;\n\n                    Loader.loadArrayBuffer(this._fontBoldItalicURL, (data) => {\n                        this._defaultBoldItalicFontFile = data;\n\n                        this.setup();\n                    });\n                });\n            });\n        });\n    }\n\n    /**\n    * Setup bloc called after default font loading\n    * @private\n    * @method setup\n    */\n    setup()\n    {\n        this._defaultFont = new Font({fontFile: this._defaultFontFile});\n        this._defaultItalicFont = new Font({fontFile: this._defaultItalicFontFile});\n        this._defaultBoldFont = new Font({fontFile: this._defaultBoldFontFile});\n        this._defaultBoldItalicFont = new Font({fontFile: this._defaultBoldItalicFontFile});\n\n        this._currentFont = this._defaultFont;\n\n        this.render();\n    }\n\n    /**\n    * Set the font.\n    * @method setFont\n    * @param {Font} font Mobilizing font to use for the next letter\n    */\n    setFont(font)\n    {\n        this._currentFont = font;\n    }\n    /**\n    * Set the size of the next letter\n    * @method setSize\n    * @param {Number} size the new size of the font\n    */\n    setSize(val)\n    {\n        this._size = val;\n    }\n    /**\n    * Set the color of the next letter\n    * @method setColor\n    * @param {Color} color the new Mobilizing Color\n    */\n    setColor(val)\n    {\n        this._color = val;\n    }\n\n    /**\n    * add a letter to the field content. Styles (font, color, etc) should be defined before calling this method.\n    * @method setText\n    * @param {String} letter the letter to add\n    */\n    addLetter(val)\n    {\n        let char = val.charCodeAt(0);\n        let letter = String.fromCharCode(char);\n        //manage new line feed\n        if(val === \"\\n\")\n        {\n            letter = val;\n        }\n        \n        let styledLetter = new StyledLetter({letter: letter,\n                                             font: this._currentFont,\n                                             size: this._size,\n                                             color: this._color\n                                            });\n        this._styledLetters.splice(this._cursorIndex+1, 0, styledLetter);\n\n        this.moveCursorForward();\n\n        this.render();\n    }\n\n    /**\n    * Delete the letter currently before the cursor (or under selection when implemented)\n    * @method delete\n    */\n    delete()\n    {\n        if(this._cursorIndex >= 0)\n        {\n            this._styledLetters.splice(this._cursorIndex, 1);\n            //console.log(\"delete\",this._cursorIndex,this._styledLetters);\n            this.moveCursorBack();\n        }\n    }\n\n    /**\n    * Cursor blink callback\n    * @method onBlink\n    * @private\n    */\n    onBlink()\n    {\n        this._blinkState = !this._blinkState;\n        //console.log(\"blink\",this._blinkState);\n        this.render();\n    }\n\n    /**\n    * Moves the cursor to the next letter\n    * @method moveCursorForward\n    */\n    moveCursorForward()\n    {\n        this._cursorIndex++;\n        if(this._cursorIndex > this._styledLetters.length-1)\n        {\n            this._cursorIndex = this._styledLetters.length-1;\n        }\n        if(this._styledLetters.length === 0)\n        {\n            this._cursorIndex = -1;\n        }\n        this.render();\n        //console.log(\"++this._cursorIndex\",this._cursorIndex);\n    }\n\n    /**\n    * Moves the cursor to the pevious letter\n    * @method moveCursorBack\n    */\n    moveCursorBack()\n    {\n        this._cursorIndex--;\n        if(this._cursorIndex < -1)\n        {\n            this._cursorIndex = -1;\n        }\n        this.render();\n        //console.log(\"--this._cursorIndex\",this._cursorIndex);\n    }\n    /**\n    * Moves the cursor to the given index of the letter\n    * @method moveCursorTo\n    * @param {Number} index\n    */\n    moveCursorTo(index)\n    {\n        if(index >= -1 && index < this._styledLetters.length){\n            this._cursorIndex = index;\n            this.render();\n        }\n    }\n    /**\n    * Pick the letter situated under the given x,y coordinates\n    * @method pickLetter\n    * @param {Number} x\n    * @param {Number} y\n    */\n    pickLetter(x,y)\n    {\n        for(let i=0; i<this._styledLetters.length; i++)\n        {\n            let el = this._styledLetters[i];\n            let bbox = el.path.getBoundingBox();\n            let rect = [{x:bbox.x1, y:bbox.y1}, {x:bbox.x2, y:bbox.y1},\n                        {x:bbox.x2, y:bbox.y2}, {x:bbox.x1, y:bbox.y2}];\n\n            if(_Math.pointIsInside(x,y, rect))\n            {\n                return {index:i, letter:this._styledLetters[i]};\n            };\n        }\n    }\n\n    /**\n    * Renders the canvas\n    * @method render\n    */\n    render()\n    {\n        //background color\n        this._canvasContext.fillStyle = \"#\" + this._backgroundColor.getHexString();\n        this._canvasContext.fillRect(0,0, this._width, this._height);\n\n        //x position of drawing (letter pos in x)\n        var letterXOffset = this._margins;\n        //y position of drawing (letter pos in y, or baseline)\n        var lineYOffset = this._margins;\n\n        for(let i=0; i<this._styledLetters.length; i++)\n        {\n            if(i < this._maxCharCount)\n            {\n                let el = this._styledLetters[i];\n\n                //is it the 1st run ?  place the baseline to the margin + font size\n                if(lineYOffset === this._margins)\n                {\n                    lineYOffset += el.size;\n                }\n\n                //test for new line from canvas width limit and reset offsets and add a new line to lineCount\n                let tempWidth = letterXOffset + el.width;\n\n                if(tempWidth > this._width - this._margins)\n                {\n                    lineYOffset += el.size;\n                    letterXOffset = this._margins;\n                }\n                //test for new line feed\n                if(el.letter === \"\\n\")\n                {\n                    lineYOffset += el.size;\n                    letterXOffset = this._margins;\n                }\n\n                el.setX(letterXOffset);\n                el.setY(lineYOffset);\n                el.update();//refresh\n                el.path.draw(this._canvasContext);\n\n                //update the x offset for next el\n                letterXOffset += el.width;\n            }\n        }\n\n        //draw the cursor\n        if(this._blinkState)\n        {\n            let el = this._styledLetters[this._cursorIndex];\n\n            if(el)\n            {\n                let boundingBox = el.path.getBoundingBox();\n\n                this._canvasContext.beginPath();\n\n                //console.log(el);\n\n                if(el.height < 1)//manage blank space\n                {\n                    this._canvasContext.moveTo(el.x + el.width, el.y);\n                    this._canvasContext.lineTo(el.x + el.width, el.y);\n                    this._canvasContext.lineTo(el.x + el.width, el.y - this._size);\n                }\n                else //use path boundingBox\n                {\n                    this._canvasContext.moveTo(boundingBox.x2, boundingBox.y1);\n                    this._canvasContext.lineTo(boundingBox.x2, boundingBox.y1);\n                    this._canvasContext.lineTo(boundingBox.x2, boundingBox.y2);\n                }\n            }\n            else //we don't have a letter, it's the start of the text\n            {\n                this._canvasContext.beginPath();\n                this._canvasContext.moveTo(this._margins, this._margins);\n                this._canvasContext.lineTo(this._margins, this._margins);\n                this._canvasContext.lineTo(this._margins, this._margins + this._size);\n            }\n\n            this._canvasContext.lineWidth = this._cursorWidth;\n            this._canvasContext.strokeStyle = \"#\" + this._cursorColor.getHex();\n            this._canvasContext.stroke();\n        }\n\n        //emit a custom event on the canvas to refresh texture when used\n        this._canvas.events.trigger(EVT_DRAWN);\n    }\n\n    /**\n    * Get canvas width\n    * @method getWidth\n    * @return {Number} canvas width\n    */\n    getWidth()\n    {\n        return this._width;\n    }\n    /**\n    * Get canvas height\n    * @method getHeight\n    * @return {Number} canvas height\n    */\n    getHeight()\n    {\n        return this._height;\n    }\n\n    /**\n    * Get the canvas\n    * @method getCanvas\n    * @return {Canvas} canvas\n    */\n    getCanvas()\n    {\n        return this._canvas;\n    }\n}\n\n// module exports\nexport { TextField };","import * as THREE from 'three';\n\nimport {_DOM} from '../helpers/DOM';\nimport {Component} from '../Component';\nimport {ComponentProxy} from '../ComponentProxy';\nimport {Context} from '../Context';\nimport {debug} from '../helpers/Debug';\n\nclass EasyContext extends Context\n{\n    /*\n    * @class EasyContext\n    * @param {Object} scriptinstance the user's script instance that should be used by this context\n    * @constructor\n    */\n    constructor(params)\n    {\n        super(params); \n    }\n\n    /*\n    * Initiate the context by instanciating objects needed for the Mobilizing lib to work well! That is :\n    *\n    *     static Time Object\n    *     Scenes array (context.scenes)\n    *     Cameras array (context.cameras)\n    *     Engine object\n    *     device object (context.device)\n    *     Canvas for rendering (context.canvas)\n    *     Input object (context.input)\n    *\n    * @method init\n    * @param {Canvas} canvas The canvas to use as a rendering surface\n    * @param {JSON object} params inputDisabled to disable input\n    */\n    init(params)\n    {\n        if (params === undefined)\n            params = {};\n        super.init(params);\n        params.context = this;\n        this.audio      = this.addComponent(new Mobilizing.RendererAudio(params));\n        this.renderer   = this.addComponent(new Mobilizing.Renderer3D(params));\n        this.physics    = this.addComponent(new Mobilizing.PhysicsEngine(params));\n        this.time       = this.addComponent(new Mobilizing.Time(params));\n        this.touch      = this.addComponent(new Mobilizing.input.Touch({context:this}));\n    }\n    \n    /*\n    * Update all the context object that needs it (Time, Animation, Input)\n    * @method update\n    * @param {Canvas} canvas\n    */\n    update(canvas)\n    {\n        super.update(canvas);\n    }\n\n    getMainRenderer()\n    {\n        return this.renderer;\n    }\n\n    \n    getRenderingSurface()\n    {\n        return this.canvas;\n    }\n\n    getTouchSurface()\n    {\n        return this.canvas;\n    }\n    \n    /*\n    * Tells the context to use this scene (defined by a string) or create it and switch to it.\n    * @method setCurrentScene\n    * @param {String} name\n    */\n    setCurrentScene(name)\n    {\n        this.renderer.setCurrentScene(name);\n    }\n\n    /*\n    * Adds on object to the current scene\n    * @method addToCurrentScene\n    * @param {Object} object A Mesh or Light to add the ce scène\n    */\n    addToCurrentScene(object)\n    {\n        this.renderer.addToCurrentScene(object);\n    }\n\n\n    /*\n    * Remove from the current scene\n    * @method removeFromCurrentScene\n    * @param {Object} object the object to remove\n    */\n    removeFromCurrentScene(object)\n    {\n\n        this.renderer.removeFromCurrentScene(object);\n    }\n\n    clear()\n    {\n        this.renderer.clear();\n    }\n\n    /*\n    * Adds a camera to the current context\n    * @method addCamera\n    * @param {Camera} cam the camera to add\n    */\n    addCamera(cam)\n    {\n        this.renderer.addCamera(cam);\n    }\n\n    /*\n    * Removes the camera from the current context\n    * @method removeCamera\n    * @param {Camera} cam\n    */\n    removeCamera(cam)\n    {\n        this.renderer.removeCamera(cam);\n    }\n\n    /*\n    * Returns the current canvas'size as {width, height}\n    * @method getCanvasSize\n    * @return {Object} the size of the canvas as {width, height}\n    */\n    getCanvasSize(){\n        return { width: this.canvas.width/window.devicePixelRatio,\n                height: this.canvas.height/window.devicePixelRatio};\n    }\n\n    \n    \n    //move to RendererAudio\n    beep(frequency)\n    {\n        this.audio.beep(frequency);\n    }\n\n\n    // Helper function to get an element's exact position\n    getCanvasPosition(){\n        return _DOM.getElementPosition(this.canvas);\n    }\n\n    updateCanvasPosition() {\n        this.canvasPosition = this.getCanvasPosition();\n    }\n\n\n    \n    \n\n    /*\n     * Creates a Mobilizing Cube\n     * @method createCube\n     * @return {Object} a Mobilizing cube\n    */\n    createCube()\n    {\n        //var cube = new Mobilizing.Cube(...arguments);\n        var cube = new Mobilizing.Mesh({primitive:\"box\"});\n        this.addToCurrentScene(cube);\n        return cube;\n    }\n\n    /*\n     * Creates a Mobilizing sphere\n     * @method createSphere\n     * @return {Object} a Mobilizing sphere\n     */\n    createSphere()\n    {\n        //var sphere = new Mobilizing.Sphere(...arguments);\n        var sphere = new Mobilizing.Mesh({primitive:\"sphere\"});\n        //var sphere = Mobilizing.Mesh.CreateSphere(1,100,100);\n        this.addToCurrentScene(sphere);\n        return sphere;\n    }\n\n\n    /*\n     * Creates a Mobilizing Plane\n     * @method createPlane\n     * @return {Object} a Mobilizing Plane\n     */\n    createPlane(width, height)\n    {\n        //var plane = Mobilizing.Mesh.CreatePlane(width, height);\n        var plane = new Mobilizing.Mesh({primitive:\"plane\"});\n        this.addToCurrentScene(plane);\n        return plane;\n    }\n\n    /*\n     * Creates a Mobilizing Light\n     * @method createLight\n     * @return {Object} a Mobilizing light\n     */\n    createLight()\n    {\n        var light = new Mobilizing.Light(...arguments);\n        this.addToCurrentScene(light);\n        return light;\n    }\n\n    /*\n     * Creates a Mobilizing label\n     * @method createLabel\n     * @return {Object} a Mobilizing label\n     */\n    createLabel(params)\n    {\n        params.context = this;\n        var label = new Mobilizing.Label(params);\n        this.addToCurrentScene(label);\n        return label;\n    }\n\n    /*\n     * Creates a Mobilizing label\n     * @method createLabel\n     * @return {Object} a Mobilizing label\n     */\n    createMesh(params)\n    {\n        params.context = this;\n        var mesh = new Mobilizing.Mesh(params);\n        this.addToCurrentScene(mesh);\n        return mesh;\n    }\n\n    /*\n     * Creates a Mobilizing Camera\n     * @method createCamera\n     * @return {Object} a Mobilizing camera\n     */\n    createCamera()\n    {\n        var cam = new Mobilizing.Camera(...arguments);\n        this.addCamera(cam);\n        this.addToCurrentScene(cam);\n        return cam;\n    }\n\n\n    /*\n     * Creates a Mobilizing Camera\n     * @method createCameraX\n     * @param {Object} params A multi purpose parametrization object\n     * @return {Object} a Mobilizing camera\n     */\n    createCameraX(params)\n    {\n        //DEPRECATED\n        var cam = new Mobilizing.Camera(params.type);\n        this.addCamera(cam);\n        this.addToCurrentScene(cam);\n\n        if (params.fov !== undefined)\n        {\n            cam.setFOV(params.fov);\n        }\n        if (params.position !== undefined)\n        {\n            cam.transform.setLocalPosition(params.position);\n        }\n        if (params.layer !== undefined)\n        {\n            cam.layer = params.layer;\n        }\n\n        return cam;\n    }\n\n\n\n\n    /*\n     * Creates a Text Label\n     * @method createTextLabel\n     * @return {Object} a Mobilizing Label\n     */\n    createTextLabel(text, font, fontSize, width, height, color, backgroundColor, texture, hasBackground)\n    {\n        var labelTest = new Mobilizing.Label(text, font, width, height);\n        labelTest.style.fontSize    = fontSize;\n        labelTest.style.color       = color;\n        if (backgroundColor !== undefined)\n        {\n            labelTest.style.hasBackground = true;\n            labelTest.style.backgroundColor = backgroundColor;\n        }\n        else\n        {\n            labelTest.style.hasBackground = false;\n        }\n        //labelTest.style.textAlign = align;//\"center|end|left|right|start\"\n        labelTest.style.textAlign = \"center\";//\"center|end|left|right|start\"\n        if (texture !== undefined)\n        {\n            labelTest.material.texture = texture;\n            labelTest.transform.setLocalScale(width,height,1);\n        }\n        else\n        {\n            labelTest.render();\n        }\n\n        this.addToCurrentScene(labelTest);\n        return labelTest;\n    }\n\n\n    /*\n     * Creates a Mobilizing Video Quad\n     * @method createVideoQuad\n     * @return {Object} a Mobilizing Video Quad\n     */\n    createVideoQuad(url)\n    {\n        var quad = new Mobilizing.Mesh({primitive:\"plane\"});\n\n        quad.vt = new Mobilizing.VideoTexture();\n        quad.vt.loadFromFile(url);\n        quad.material.setTexture(quad.vt);\n        this.addToCurrentScene(quad);\n        return quad;\n    }\n\n    /*\n     * Loads a Mobilizing Font\n     * @method loadFont\n     * @return {Object} a Mobilizing Font\n     */\n    loadFont(url)\n    {\n        var font = new Mobilizing.Font(url, this);\n        return font;\n    }\n\n\n    loadObj3dModel (model_url, texture_url)\n    {\n        //load model from OBJ file\n        var model = new Mobilizing.Mesh();\n        model.material = new Mobilizing.Material({type:\"lambert\"});\n        model.updateMaterial();\n        model.loadFromFile(model_url, this.onObjLoaded.bind(this));\n        //load texture\n        var tex = new Mobilizing.Texture({context:this});\n        tex.loadFromFile(texture_url);\n        //apply texture to model\n        model.material.setTexture(tex);\n        //mob.addToCurrentScene(model); //doing this before the completed loading may result in an no rendering, we have to do that in the callback given to loadFromFile()\n        //console.log(\"added to current scene\");\n        return model;\n    }\n\n    onObjLoaded (model)\n    {\n        //we add the just loaded model to the 3D scene\n        this.addToCurrentScene(model);\n    }\n\n\n    /*\n     * Creates a Mobilizing Audio source\n     * @method createAudioSource\n     * @return {Object} a Mobilizing Audio source\n     */\n    createAudioSource(url)\n    {\n        var source  = new Mobilizing.AudioSource(this);\n        source.set3D(false);\n        var sound   = new Mobilizing.AudioBuffer(this);\n        sound.loadFromURL(url, this.onBufferLoaded.bind(this));\n        return source;\n    }\n\n    onBufferLoaded (source, buffer)\n    {\n        //source.setBuffer(sound);\n        //source.play();\n    }\n\n\n    /*\n     * Creates a Mobilizing Texture\n     * @method createTexture\n     * @return {Object} a Mobilizing texture\n     */\n    createTexture()\n    {\n        var texture = new Mobilizing.Texture({context:this});\n        return texture;\n    }\n\n    /*\n     * Creates a Mobilizing Texture\n     * @method createTextureFromCubeCamera\n     * @return {Object} a Mobilizing texture\n     */\n    createTextureFromCubeCamera(camera)\n    {\n        var texture = new Mobilizing.Texture({context:this});\n        texture.cube = camera._camera.renderTarget; //FIXME\n        texture.cube.minFilter = THREE.LinearMipMapLinearFilter;\n        return texture;\n    }\n\n\n    /*\n     * Loads a Mobilizing Texture\n     * @method loadFont\n     * @return {Object} a Mobilizing Texture\n     */\n    loadTexture(url, asynchro)\n    {\n        var texture = new Mobilizing.Texture({context:this});\n        texture.loadFromFile(url, asynchro);\n        return texture;\n    }\n\n\n    /*\n     * Creates a Mobilizing Button\n     * @method createTextButton\n     * @return {Object} a Mobilizing Button\n     */\n    createTextButton(text, width, height, font, fontSize, position, scale)\n    {\n        var button = Mobilizing.Button.CreateButton(undefined, text, font, fontSize, position, width, height, undefined, undefined,this);\n        button.transform.setLocalScale(scale);\n        this.addToCurrentScene(button);\n        return button;\n    }\n}\n\n// module exports\nexport { EasyContext };\n","export var version = \"<@VERSION@>\";\nexport var revision = \"<@REVISION@>\";\n\nexport * from './Mobilizing/audio/AudioBuffer';\nexport * from './Mobilizing/audio/AudioSource';\n\nexport * from './Mobilizing/core/Color';\nexport * from './Mobilizing/core/Euler';\nexport * from './Mobilizing/core/Matrix3';\nexport * from './Mobilizing/core/Matrix4';\nexport * from './Mobilizing/core/Quaternion';\nexport * from './Mobilizing/core/Rect';\nexport * from './Mobilizing/core/Vector2';\nexport * from './Mobilizing/core/Vector3';\n\nexport * from './Mobilizing/helpers/Animation';\nexport * from './Mobilizing/helpers/Csg';\nexport * from './Mobilizing/helpers/Debug';\nexport * from './Mobilizing/helpers/Device';\nexport * from './Mobilizing/helpers/BatteryStatus';\n\nimport {Keyboard} from './Mobilizing/input/Keyboard';\nimport {Mouse} from './Mobilizing/input/Mouse';\nimport {Touch} from './Mobilizing/input/Touch';\nimport {Motion} from './Mobilizing/input/Motion';\nimport {Orientation} from './Mobilizing/input/Orientation';\nimport {GPS} from './Mobilizing/input/GPS';\nexport var input = {\n    'Keyboard': Keyboard,\n    'Mouse': Mouse,\n    'Touch': Touch,\n    'Motion': Motion,\n    'Orientation': Orientation,\n    'GPS': GPS\n};\n\nexport {GPSUtils} from './Mobilizing/input/GPS';\n\nexport {_Math as math} from './Mobilizing/helpers/Math';\nexport * from './Mobilizing/helpers/MeshFX';\nexport * from './Mobilizing/helpers/Midi';\nexport * from './Mobilizing/helpers/Profiler';\nexport * from './Mobilizing/helpers/Runner';\nexport * from './Mobilizing/helpers/Loader';\nexport * from './Mobilizing/helpers/Pointer';\nexport * from './Mobilizing/helpers/DOM';\n\nexport {getOrDefault} from './Mobilizing/helpers/Misc';\n\nimport {Ajax} from './Mobilizing/net/Ajax';\nimport {PubSub} from './Mobilizing/net/PubSub';\nexport var net = {\n    'Ajax': Ajax,\n    'PubSub': PubSub\n};\n\nexport * from './Mobilizing/physics/PhysicsEngine';\n\nexport * from './Mobilizing/renderer/Engine3D';\nexport * from './Mobilizing/renderer/Renderer3D';\nexport * from './Mobilizing/renderer/RendererAudio';\n\nexport * from './Mobilizing/scene/Camera';\nexport * from './Mobilizing/scene/Font';\nexport * from './Mobilizing/scene/Light';\nexport * from './Mobilizing/scene/LODGroup';\nexport * from './Mobilizing/scene/Material';\nexport * from './Mobilizing/scene/Transform';\n\nexport * from './Mobilizing/shape/Label';\nexport * from './Mobilizing/shape/Mesh';\n\nexport * from './Mobilizing/text/TextUtils';\nexport * from './Mobilizing/text/RichText';\n\nexport * from './Mobilizing/texture/CanvasTexture';\nexport * from './Mobilizing/texture/DOMNodeTexture';\nexport * from './Mobilizing/texture/ImageSequenceTexture';\nexport * from './Mobilizing/texture/RenderTexture';\nexport * from './Mobilizing/texture/Texture';\nexport * from './Mobilizing/texture/VideoTexture';\n\nexport * from './Mobilizing/time/Time';\nexport * from './Mobilizing/time/Timer';\nexport * from './Mobilizing/time/NTP';\n\nexport * from './Mobilizing/ui/Button';\nexport * from './Mobilizing/ui/ButtonGroup';\nexport * from './Mobilizing/ui/Clickable';\nexport * from './Mobilizing/ui/TextField';\n\nexport * from './Mobilizing/Context';   \nexport * from './Mobilizing/context/EasyContext';\n"],"names":["getOrDefault","object","key","defaultValue","undefined","getOrExec","fn","args","getOrCreate","cls","singletonize","def","instance","AudioBuffer","params","renderer","arrayBuffer","decodedCallback","audioContext","decodeAudioData","buffer","bind","Base","_context","_name","_id","Date","now","Math","floor","random","context","name","EventEmitter","_scope","listeners","type","callback","push","Array","i","len","length","splice","data","forEach","listener","call","Component","_active","_setupDone","events","_nexts","component","AudioSource","panner","createPanner","panningModel","distanceModel","refDistance","maxDistance","rolloffFactor","coneInnerAngle","coneOuterAngle","coneOuterGain","is3D","loop","val","enabled","transform","pos","getLocalPosition","setPosition","x","y","z","play","stop","source","createBufferSource","connect","destination","playing","start","Color","r","g","b","a","string","color","THREE","green","blue","red","white","darkGray","gray","lightGray","black","cyan","magenta","yellow","lightRed","lightGreen","lightBlue","mobilizing","mobilizingDark","mobilizingLight","mobilizingAlternate","transparent","makeRGBAStringWithAlpha","Euler","Matrix3","Matrix4","Quaternion","Rect","width","height","array","Vector2","memX","memY","one","zero","Vector3","_Math","from","to","value","low1","high1","low2","high2","degreeToRadiansFactor","PI","radianToDegreesFactor","x1","y1","x2","y2","sqrt","dest","amount","min","max","points","j","oddNodes","line1","line2","a1","b1","c1","a2","b2","c2","t","_debugEnabled","window","location","search","Debug","label","doLog","log","apply","console","arguments","warn","info","error","debug","Time","_startTime","getTime","_timeScale","_currentTime","_deltaTime","reset","getStatus","lastTime","scale","EVT_START","EVT_UPDATE","EVT_RESTART","EVT_STOP","EVT_RESUME","EVT_FINISH","Animation","_target","target","_from","_to","_duration","duration","_easing","Easing","linear","_repeat","_yoyo","_delay","_time","_timesPlayed","_direction","onStart","onUpdate","onRestart","onStop","onResume","onFinish","on","getContext","addComponent","setup","_isPlaying","prop","trigger","update","time","getAbsoluteDelta","map","animation","pow","abs","easeInQuad","easeOutQuad","easeInCubic","easeOutCubic","easeInQuart","easeOutQuart","easeInQuint","easeOutQuint","sin","easeOutBounce","easeInBounce","Material","texture","_material","MeshBasicMaterial","wireframe","ShaderMaterial","fragmentShader","vertexShader","uniforms","shader","ShaderLib","UniformsUtils","clone","replace","MeshLambertMaterial","shading","FlatShading","MeshPhongMaterial","SmoothShading","LineBasicMaterial","SpriteMaterial","side","DoubleSide","_texture","cube","envMap","trans","op","opacity","sided","FrontSide","alphaTest","bool","depthWrite","depthTest","linewidth","shininess","emissive","needsUpdate","specular","blending","dispose","Camera","fov","cubeResolution","near","far","position","canvasSize","getCanvasSize","_camera","PerspectiveCamera","innerWidth","innerHeight","OrthographicCamera","CubeCamera","Transform","setLocalPosition","viewport","layer","verticalshift","horizontalshift","autorender","autoclear","autoupdatematrix","dirty","renderTexture","updateProjectionMatrix","clearColor","vec","lookAt","ratio","aspect","w","h","setViewOffset","left","right","top","bottom","zoom","children","cam","newPos","tan","degToRad","c","d","e","m","projectionMatrix","set","setAspect","getAspect","setZoom","getZoom","setFarPlane","setNearPlane","getNearPlane","Light","light","PointLight","distance","DirectionalLight","normalize","AmbientLight","SpotLight","Object3D","intensity","angle","arg1","arg2","arg3","updateMatrixWorld","penumbra","castShadow","shadow","mapSize","camera","Texture","_image","_canvas","fromImage","fromCanvas","image","canvas","magFilter","minFilter","setNeedsUpdate","u","v","repeat","wrapS","wrapT","offset","premultiplyAlpha","mapping","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","Label","setName","font","material","_text","_lineMaxCharCount","style","Style","_width","_height","fontSize","textAlign","mesh","Mesh","primitive","backgroundColor","hasBackground","setLocalScale","needsComputeTextSize","precLine","_textSize","setTexture","render","backgroundTexture","shadowColor","shadowBlur","document","createElement","retinaResolutionEnabled","fillStyle","backgroundColorAlpha","drawImage","fillRect","clearRect","finaltext","l","word","ll","first","SpaceLeft","strings","split","path","lastLine","nbLines","k","s","getTextSize","textHorizontalMargin","textVerticalAlign","textVerticalMargin","cursorx","cursory","getFont","getPath","fill","getHexString","draw","text","align","labelTest","obj","mobObject","entity","vector","q","quaternion","temp","matrixAutoUpdate","mat","multiplyMatrices","matrix","applyMatrix","updateMatrix","rotation","radToDeg","setLocalEulerAngles","arg","getLocalEulerAngles","tempVec","setFromMatrixPosition","matrixWorld","targetList","nx","ny","raycaster","Raycaster","ray","setFromCamera","intersects","intersectObjects","point","uv","widthHalf","heightHalf","project","child","add","indexOf","remove","index","renderOrder","visible","_geometry","constructPlane","constructQuad","constructBox","constructCube","constructSphere","constructCircle","constructCylinder","constructIcosahedron","constructOctahedron","constructText","constructNode","constructLine","constructSprite","constructArc","constructCustom","dynamic","point1","point2","vertices","segments","widthSegments","heightSegments","attachMaterial","point3","point4","rectShape","moveTo","lineTo","size","depthSegments","depth","radius","phiStart","phiLength","thetaStart","thetaLength","radiusTop","radiusBottom","radiusSegments","openEnded","detail","threeFont","center","startAngle","endAngle","uvScale","createArc","shape","closePath","geometry","constructMesh","generateFlatUVs","uvs","bounds","getBoundingBox","faces","face","setUVs","inflateValue","generateStrokeShape","setVertices","updateMesh","boundingBox","computeBoundingBox","bbox","setFromObject","boundingSphere","computeBoundingSphere","getBoundingSphere","end","dir","subVectors","crossVectors","p1","p2","p3","p4","uv1","uv2","uv3","uv4","pushQuad","setColor","setWireframe","innerpoints","outerpoints","interval","starta","enda","cos","createDiscSector","pushTriangle","pushUV","verticesNeedUpdate","i1","i2","i3","elementsNeedUpdate","faceVertexUvs","uvsNeedUpdate","n1","n2","n3","faceVertexNormals","normalsNeedUpdate","v1","v2","v3","v4","computeFaceNormals","computeVertexNormals","erase","colors","vertexColors","colorsNeedUpdate","makeTranslation","makeScale","makeRotationX","makeRotationY","makeRotationZ","tempMesh","tempTransform","getLocalScale","setLocalRotation","getLocalRotation","updateMaterial","receiveShadow","innerGeom","outterGeom","tempOutterGeom","rot","geometryIsCW","pt0","pt1","pt2","v01","v12","rotate90CCW","rotate90CW","d01","multiplyScalar","d12","ptx0","ptx10","ptx12","ptx2","newPoint","intersectionPoint","outterPath","innerPath","holes","dot","strokeMesh","strokeColor","sizeX","sizeY","sizeZ","curveSegments","typeface","hsegments","vsegments","EdgesMesh","_params","threshold","Csg","mobMesh1","mobMesh2","csgMesh1","ThreeBSP","csgMesh2","newBSP","subtract","BSPGeom","toGeometry","newMobMesh","union","intersect","MOBILE","DESKTOP","OS_REGEX","Map","_STATICS","Device","os","osVersion","regex","test","navigator","userAgent","exec","appVersion","browser","appName","version","majorVersion","versionOffset","ix","substring","nameOffset","lastIndexOf","toLowerCase","toUpperCase","parseInt","isNaN","parseFloat","parseOSData","parseBrowserData","cordova","screen","getScreenWidth","getScreenHeight","EVT_CHARGING_CHANGED","EVT_LEVEL_CHANGED","EVT_CHARGING_TIME_CHANGED","EVT_DISCHARGING_TIME_CHANGED","BatteryStatus","_manager","_batteryAvailable","getBattery","then","onBatteryManager","manager","removeEventListener","onChargingChange","event","onChargingTimeChange","onLevelChange","onDischargingTimeChange","addEventListener","charging","chargingTime","dischargingTime","level","EVT_KEY_DOWN","EVT_KEY_PRESS","EVT_KEY_UP","Keyboard","onKeyDown","onKeyPress","onKeyUp","_isPressed","_keyDownCode","String","fromCharCode","keyCode","preventDefault","_DOM","el","tagName","xScroll","scrollLeft","documentElement","yScroll","scrollTop","offsetLeft","clientLeft","offsetTop","clientTop","offsetParent","EVT_MOUSE_UPDATE","EVT_MOUSE_MOVE","EVT_MOUSE_OVER","EVT_MOUSE_OUT","EVT_MOUSE_PRESS","EVT_MOUSE_DRAG","EVT_MOUSE_RELEASE","EVT_MOUSE_CLICK","EVT_MOUSE_DBLCLICK","EVT_MOUSE_WHEEL","Mouse","_x","_y","_pX","_pY","_dragStartX","_dragStartY","_wheelDeltaX","_wheelDeltaY","_wheelDeltaZ","_pressed","_wheelActivated","_resetWheel","onMouseMove","onMouseOver","onMouseOut","onMouseDown","onMouseUp","onClick","onDblClick","onWheel","getPX","getPY","getX","getY","Window","getElementPosition","clientX","clientY","isPressed","button","deltaX","deltaY","deltaZ","getDeltaX","getDeltaY","getDragOffsetX","getDragOffsetY","getType","WheelEvent","getWheelDeltaX","getWheelDeltaY","getWheelDeltaZ","TouchObject","pX","pY","id","xDelta","yDelta","startX","startY","offsetX","offsetY","EVT_TOUCH_START","EVT_TOUCH_END","EVT_TOUCH_MOVED","EVT_TAP_CHANGED","EVT_PRESSED_CHANGED","Touch","count","pressed","touches","taps","tapsMaxInterval","oldTapTime","pinchTouches","pinchStart","pinch","pinchActive","touchState","touchDown","touchUp","onTouchStart","onTouchEnd","onTouchMove","setPX","setPY","newTouch","changedTouches","touch","identifier","pageX","pageY","setX","setY","up","down","myTouch","touchNb","dist","EVT_ACC","EVT_ACC_GRAVITY","EVT_ACC_GRAVITY_VECTOR","EVT_ROTATION_RATE","Motion","param","_accAvailable","DeviceMotionEvent","rotationRate","acc","userAcc","smoothedAcc","accel","kFilteringFactor","gravityVector","onDeviceMotion","reverse","getOS","acceleration","computeUserAcc","accelerationIncludingGravity","computeGravityVector","alpha","beta","gamma","atan2","factor","EVT_DEVICE_ORIENTATION","EVT_COMPASS_CALIBRATION","Orientation","compassAvailable","DeviceOrientationEvent","compass","deviceRotationMatrix","deviceHeading","deviceAttitude","deviceBank","onDeviceOrientation","onCompassCalibration","screenOrientation","finalQuaternion","deviceEuler","screenTransform","worldTransform","minusHalfAngle","setFromEuler","multiply","createGyroQuaternion","orientation","webkitCompassHeading","heading","_z","cX","cY","cZ","sX","sY","sZ","m11","m12","m13","m21","m22","m23","m31","m32","m33","asin","computeRotationMatrix","updateDeviceRotationMatrix","EVT_LOC_UPDATED","EVT_LOC_ERROR","GPS","_enableHighAccuracy","_maximumAge","_timeout","_GPSAvailable","_location","_watchID","positionOptions","geolocation","watchPosition","updateLocationCallBack","updateLocationErrorCallBack","clearWatch","longitude","coords","latitude","altitude","accuracy","altitudeAccuracy","speed","timestamp","code","worldSize","GPSUtils","longitute","lngX","latY","mapCoord","mapWidth","mapHeight","leftLong","bottomLat","rightLong","topLat","topRight","getPixelsCoordsFromOSMLngLat","topLeft","bottomRight","bottomLeft","absCoord","lng","lat","atan","exp","MeshFX","getVertices","noise","Midi","midioutname","out","midiinname","in","onMidiIn","requestMIDIAccess","onMIDIInit","onMIDIReject","midi","midiAccess","hookUpMIDI","onstatechange","err","inputs","values","input","next","done","midiname","onmidimessage","onMIDIMessage","outputs","output","midioutput","message","channel","data1","data2","cc","ccMessage","send","note","vel","NoteOn","NoteOff","Aftertouch","ControlChange","ProgramChange","Profiler","timers","current_frame","last_time","initialize","dt","frame","logTimers","str","EVT_READYSTATE_CHANGE","EVT_PROGRESS","EVT_LOAD","EVT_SUCCESS","EVT_ERROR","Ajax","url","method","headers","async","autoSend","withCredentials","timeout","responseType","onReadyStateChange","onProgress","onLoad","onSuccess","onError","_xhr","XMLHttpRequest","url_params","encodeURIComponent","join","setResponseType","setRequestHeader","setWithCredentials","setTimeout","open","getReadyState","OPENED","LOADING","DONE","status","success","header","abort","statusText","readyState","response","responseText","JSON","parse","getResponseText","OBJ","loader","callBack","loadText","parseOBJ","model","lines","toString","words","line","setEmissiveColor","Mobilizing","setSpecularColor","loadTexture","attachTexture","p","normals","resultmtl","parseMTL","pushVertex","vUV","vN","index1","index2","index3","pushFace","pushNormal","index4","computeNormals","EVT_REQUEST_START","EVT_REQUEST_LOAD","EVT_REQUEST_ERROR","EVT_COMPLETE","STATUS_PENDING","STATUS_LOADING","STATUS_COMPLETE","LoadRequest","_consumeCallback","consume","_value","_error","Loader","onComplete","_status","_requests","_complete","request","doComplete","processData","ajax","getResponse","setValue","getStatusText","setError","load","Object","assign","img","Image","src","video","autoplay","result","loadImage","Cache","isLoading","addCallback","isCached","get","addKey","addValue","script","head","appendChild","files","callbacks","file","getKey","keys","ComponentProxy","targetScript","preLoad","Context","_components","chainedCall","chained","getChainedComponents","setContext","Runner","run","init","startLoop","consumeAll","stats","begin","onFrameBegin","onFrameEnd","TOUCH_TYPE","MOUSE_TYPE","PointerObject","state","_deltaX","_deltaY","_state","_type","_component","EVT_ON","EVT_OFF","EVT_MOVED","Pointer","components","pointers","lastActivePointer","setType","pointerKey","pointer","getState","delete","setDeltaX","getComponent","setDeltaY","touchComponent","setComponent","setState","mouseComponent","getID","EVT_CONNECT","EVT_DISCONNECT","PubSub","autoConnect","io","onload","socket","disconnect","emit","off","PhysicsEngine","joints","bodies","iterations","G","ke","relaxationCoeff","body","joint","getDelta","force","forces","body1","body2","sx","velocity","sy","sz","damping","mass","charge1","charge2","previousposition","globalgravity","globalwind","err1","err2","fixed","Engine3D","WebGLRenderer","engine","devicePixelRatio","setPixelRatio","setSize","windowWidth","clientWidth","windowHeight","clientHeight","domElement","setClearColor","autoClear","Renderer3D","scenes","cameras","fog","setCurrentScene","fullscreen","onWindowResize","updateCanvasPosition","canvasPosition","getCanvasPosition","shadowMap","PCFSoftShadowMap","shadowMapEnabled","scene","Scene","o","Fog","getHex","FogExp2","density","setOrthoPlanes","sort","sorted_cameras","min_val","min_cam","cam_candidate","getVisible","viewport_x","viewport_y","viewport_w","viewport_h","setViewport","setScissor","setScissorTest","ks","logLevel","_engineTexture","updateCubeMap","RendererAudio","audioEnabled","AudioContext","webkitAudioContext","sampleRate","createBuffer","dummy","close","audioOutputNode","createGain","forwardX","forwardY","forwardZ","upX","upY","upZ","setOrientation","frequency","freq","osc","createOscillator","currentTime","Font","_fontFile","_font","opentype","kerning","fontScale","glyphs","glyph","options","kerningValue","ymax","supported","unitsPerEm","stringToGlyphs","getMetrics","yMax","yMin","advanceWidth","getKerningValue","LODGroup","bias","thisposition","getWorldPosition","getDistance","lod","StyledLetter","letter","StyledTextElement","styledLetters","baseWidth","styledLetter","char","charCodeAt","TextLine","styledTextElements","EVT_DRAWN","TEXT_ALIGN_LEFT","TEXT_ALIGN_RIGHT","TEXT_ALIGN_CENTER","RichText","_backgroundColor","_lineHeight","_margins","margins","_textColor","_textAlign","_boundingBoxStrokeWidth","_drawBoundingBox","_fontURL","_fontItalicURL","_fontBoldURL","_fontBoldItalicURL","_canvasContext","scope","_DOMText","innerHTML","styledText","parseDOMTree","_lines","loadArrayBuffer","_defaultFontFile","_defaultItalicFontFile","_defaultBoldFontFile","_defaultBoldItalicFontFile","_defaultFont","fontFile","_defaultItalicFont","_defaultBoldFont","_defaultBoldItalicFont","baseNode","processDOMTree","destArray","node","previousElementSibling","childNodes","textContent","attributes","tags","setText","parentNode","tempNode","letterXOffset","lineYOffset","lineCount","currentFont","tempWidth","Number","setFont","fontTextSize","lineObj","xDiff","beginPath","lineWidth","stroke","CanvasTexture","_strokeWidth","_strokeColor","_strokeOpacity","_fillColor","_fillOpacity","generateMipmaps","setFillColor","tempStrokeColor","tempFillColor","toRGBAColorString","strokeStyle","strokeWidth","fillColor","fillOpacity","strokeOpacity","ctx","arc","DOMNodeTexture","toDataURL","imgEl","self","toImage","cssName","cssRules","styleSheets","selector","selectorText","classList","ImageSequenceTexture","frameRate","textures","sequenceMode","direction","lapsToDo","frameCount","laps","currentFrame","urlbase","loadFromFile","enterFrame","outFrame","mode","deltaTime","RenderTexture","VideoTexture","_video","_loop","_autoPlay","_fps","_isIOS","_bufferedPourcent","_videoCanvasTexture","videoWidth","videoHeight","onLoadProgess","onVideoEnded","NearestFilter","timeRange","getBuffered","getDuration","HAVE_FUTURE_DATA","elapsed","pause","buffered","playbackRate","Timer","startTime","tempInterval","NTP","_smoothingFactor","_NTPEnabled","_timeOffsetSmooth","_lastTime","_offset","WebSocket","ntp_websockets","resync","Clickable","onPress","onRelease","onEnter","onLeave","picked","hovered","mouse","pick","Button","sideCount","cutOff","pressFillColor","hoverFillColor","textSize","root","canvasWidth","canvasHeight","twoSquareThree","richText","pressRichText","textTexture","getCanvas","pressTextTexture","generateDefaultMesh","addChild","clickable","texturedMesh","setOpacity","vertex","parts","topLeftIndex","topRightIndex","bottomRightIndex","bottomLeftIndex","generateFillMesh","setTransparent","generateStrokeMesh","corner","regenerateStrokeGeometry","updateStroke","fakePressed","ButtonGroup","rows","columns","offsetType","buttons","orderedIndices","organize","indices","organizeGrid","positionGrid","positionHoneyComb","tempIndices","bt","isTop","isBottom","isLeft","isRight","renderGrid","order","adaptCorner","computeSize","getSize","renderHoneyComb","expandByObject","TextField","_ready","_styledLetters","_maxCharCount","_maxLineCount","_size","_color","_currentFont","_cursorColor","_cursorWidth","_blinkTime","_blinkState","onBlink","_cursorIndex","_cursorX","_cursorY","moveCursorForward","moveCursorBack","rect","pointIsInside","EasyContext","audio","physics","addToCurrentScene","removeFromCurrentScene","clear","addCamera","removeCamera","beep","sphere","plane","setFOV","quad","vt","model_url","texture_url","onObjLoaded","tex","set3D","sound","loadFromURL","onBufferLoaded","renderTarget","asynchro","CreateButton","revision","net"],"mappings":"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"}